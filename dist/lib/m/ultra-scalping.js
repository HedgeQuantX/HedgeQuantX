const _0x3da12b=_0x58c7;(function(_0xbdf1ef,_0x474ebe){const _0x57b7f=_0x58c7,_0x4b4117=_0xbdf1ef();while(!![]){try{const _0x5396a0=parseInt(_0x57b7f(0x109))/0x1*(-parseInt(_0x57b7f(0x12f))/0x2)+parseInt(_0x57b7f(0xcd))/0x3+parseInt(_0x57b7f(0xd6))/0x4*(parseInt(_0x57b7f(0xdf))/0x5)+-parseInt(_0x57b7f(0x11f))/0x6*(-parseInt(_0x57b7f(0xd4))/0x7)+parseInt(_0x57b7f(0xee))/0x8+-parseInt(_0x57b7f(0x114))/0x9+-parseInt(_0x57b7f(0x125))/0xa;if(_0x5396a0===_0x474ebe)break;else _0x4b4117['push'](_0x4b4117['shift']());}catch(_0x2ac42c){_0x4b4117['push'](_0x4b4117['shift']());}}}(_0x5566,0xa52a0));const EventEmitter=require(_0x3da12b(0xfb)),{v4:uuidv4}=require(_0x3da12b(0xf7)),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};class HQXUltraScalping extends EventEmitter{constructor(_0x5a9aff={}){const _0x2653c1=_0x3da12b;super(),this['tickSize']=_0x5a9aff['tickSize']||0.25,this['tickValue']=_0x5a9aff['tickValue']||0x5,this['zscoreEntryThreshold']=1.5,this['zscoreExitThreshold']=0.5,this['vpinWindow']=0x32,this['vpinToxicThreshold']=0.7,this[_0x2653c1(0x104)]=0.01,this[_0x2653c1(0x121)]=0.1,this['volatilityLookback']=0x64,this['ofiLookback']=0x14,this[_0x2653c1(0xfa)]=0x8,this[_0x2653c1(0xeb)]=0x10,this['breakevenTicks']=0x4,this[_0x2653c1(0xc8)]=0.5,this['minConfidence']=0.55,this[_0x2653c1(0xe5)]={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this[_0x2653c1(0x130)]=new Map(),this[_0x2653c1(0x126)]=new Map(),this['volumeBuffer']=new Map(),this[_0x2653c1(0xdb)]=new Map(),this['atrHistory']=new Map(),this[_0x2653c1(0xf9)]=[],this['winStreak']=0x0,this[_0x2653c1(0xc4)]=0x0,this[_0x2653c1(0xf3)]=0x0,this[_0x2653c1(0xe8)]=0x7530,this['minHoldTimeMs']=0x2710,this[_0x2653c1(0xf0)]={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}[_0x3da12b(0xc5)](_0x5c2963,_0x2a4315=0.25,_0x7dedf5=0x5){const _0xd5d034=_0x3da12b;this['tickSize']=_0x2a4315,this['tickValue']=_0x7dedf5,this[_0xd5d034(0x130)][_0xd5d034(0x108)](_0x5c2963,[]),this[_0xd5d034(0x126)]['set'](_0x5c2963,[]),this['volumeBuffer'][_0xd5d034(0x108)](_0x5c2963,[]),this['atrHistory'][_0xd5d034(0x108)](_0x5c2963,[]),this[_0xd5d034(0xdb)]['set'](_0x5c2963,{'estimate':0x0,'errorCovariance':0x1}),this[_0xd5d034(0xea)]('log',{'type':'info','message':'[HQX-UltraScalping]\x20Initialized\x20for\x20'+_0x5c2963+':\x20tick='+_0x2a4315+',\x20value='+_0x7dedf5}),this['emit'](_0xd5d034(0x128),{'type':'info','message':_0xd5d034(0x10f)});}[_0x3da12b(0xdc)](_0x3b4bbc){const _0x24ec74=_0x3da12b,{contractId:_0x40e85b,price:_0x2c5607,volume:_0xca50f2,side:_0x51e21a,timestamp:_0xfe5f31}=_0x3b4bbc,_0x3e212c={'timestamp':_0xfe5f31||Date[_0x24ec74(0x106)](),'open':_0x2c5607,'high':_0x2c5607,'low':_0x2c5607,'close':_0x2c5607,'volume':_0xca50f2||0x1};return this[_0x24ec74(0xcf)](_0x40e85b,_0x3e212c);}['onTick'](_0x101470){return this['processTick'](_0x101470);}[_0x3da12b(0xca)](_0x14c28a){const _0xb61fb2=_0x3da12b;return this[_0xb61fb2(0xdc)]({'contractId':_0x14c28a['contractId']||_0x14c28a[_0xb61fb2(0x10b)],'price':_0x14c28a['price'],'volume':_0x14c28a[_0xb61fb2(0xe2)]||_0x14c28a[_0xb61fb2(0xe9)]||0x1,'side':_0x14c28a['side'],'timestamp':_0x14c28a[_0xb61fb2(0x131)]||Date[_0xb61fb2(0x106)]()});}[_0x3da12b(0xcf)](_0x5a24f5,_0x8abd51){const _0x58f840=_0x3da12b;let _0x135c50=this[_0x58f840(0x130)][_0x58f840(0x110)](_0x5a24f5);!_0x135c50&&(this['initialize'](_0x5a24f5),_0x135c50=this[_0x58f840(0x130)][_0x58f840(0x110)](_0x5a24f5));_0x135c50['push'](_0x8abd51);if(_0x135c50[_0x58f840(0xcb)]>0x1f4)_0x135c50[_0x58f840(0x112)]();const _0xadbc5f=this['priceBuffer']['get'](_0x5a24f5);_0xadbc5f[_0x58f840(0xf1)](_0x8abd51[_0x58f840(0xfc)]);if(_0xadbc5f['length']>0xc8)_0xadbc5f[_0x58f840(0x112)]();const _0x3c5e0c=this[_0x58f840(0xd8)]['get'](_0x5a24f5),_0x37a714=_0x8abd51['high']-_0x8abd51['low'];let _0x240058=_0x8abd51['volume']*0.5,_0x30f27c=_0x8abd51[_0x58f840(0xe9)]*0.5;if(_0x37a714>0x0){const _0x1a90f0=(_0x8abd51['close']-_0x8abd51['low'])/_0x37a714;_0x240058=_0x8abd51[_0x58f840(0xe9)]*_0x1a90f0,_0x30f27c=_0x8abd51['volume']*(0x1-_0x1a90f0);}_0x3c5e0c[_0x58f840(0xf1)]({'buy':_0x240058,'sell':_0x30f27c});if(_0x3c5e0c[_0x58f840(0xcb)]>0x64)_0x3c5e0c[_0x58f840(0x112)]();if(_0x135c50['length']<0x32)return null;const _0x220d55=this[_0x58f840(0xed)](_0xadbc5f),_0x1b244a=this['_computeVPIN'](_0x3c5e0c),_0x54cdd9=this['_computeKyleLambda'](_0x135c50),_0x3257d8=this['_applyKalmanFilter'](_0x5a24f5,_0x8abd51['close']),{regime:_0x834b25,params:_0x591b23}=this['_detectVolatilityRegime'](_0x5a24f5,_0x135c50),_0xc0890a=this[_0x58f840(0xd1)](_0x135c50);return this['_generateSignal'](_0x5a24f5,_0x8abd51['close'],_0x220d55,_0x1b244a,_0x54cdd9,_0x3257d8,_0x834b25,_0x591b23,_0xc0890a,_0x135c50);}[_0x3da12b(0xed)](_0x15f4e7,_0x573fed=0x32){const _0x54153d=_0x3da12b;if(_0x15f4e7['length']<_0x573fed)return 0x0;const _0x1c20ca=_0x15f4e7[_0x54153d(0xfd)](-_0x573fed),_0x196d3e=_0x1c20ca[_0x54153d(0x11e)]((_0x2ebf0c,_0x2f4e69)=>_0x2ebf0c+_0x2f4e69,0x0)/_0x573fed,_0x5a60c0=_0x1c20ca['reduce']((_0x5df1d0,_0x4f65a1)=>_0x5df1d0+Math['pow'](_0x4f65a1-_0x196d3e,0x2),0x0)/_0x573fed,_0x175ed2=Math['sqrt'](_0x5a60c0);if(_0x175ed2<0.0001)return 0x0;const _0x2b7f0d=_0x15f4e7[_0x15f4e7['length']-0x1];return(_0x2b7f0d-_0x196d3e)/_0x175ed2;}['_computeVPIN'](_0x20eb56){const _0x5b53b5=_0x3da12b;if(_0x20eb56['length']<this[_0x5b53b5(0xd3)])return 0.5;const _0x5bcb11=_0x20eb56['slice'](-this['vpinWindow']);let _0x1baf33=0x0,_0x1fcbbf=0x0;for(const _0x22d925 of _0x5bcb11){_0x1baf33+=_0x22d925['buy'],_0x1fcbbf+=_0x22d925['sell'];}const _0x2e26cb=_0x1baf33+_0x1fcbbf;if(_0x2e26cb<0x1)return 0.5;return Math[_0x5b53b5(0x102)](_0x1baf33-_0x1fcbbf)/_0x2e26cb;}[_0x3da12b(0xef)](_0x101a50){const _0x5bcfc8=_0x3da12b;if(_0x101a50['length']<0x14)return 0x0;const _0x54370e=_0x101a50['slice'](-0x14),_0x2c4866=[],_0x329552=[];for(let _0x462446=0x1;_0x462446<_0x54370e[_0x5bcfc8(0xcb)];_0x462446++){_0x2c4866[_0x5bcfc8(0xf1)](_0x54370e[_0x462446][_0x5bcfc8(0xfc)]-_0x54370e[_0x462446-0x1][_0x5bcfc8(0xfc)]),_0x329552['push'](_0x54370e[_0x462446][_0x5bcfc8(0xe9)]);}const _0x86c99e=_0x2c4866[_0x5bcfc8(0x11e)]((_0x4026f9,_0x12c57f)=>_0x4026f9+_0x12c57f,0x0)/_0x2c4866['length'],_0x4e5cff=_0x329552['reduce']((_0x1e91c8,_0x47f7b6)=>_0x1e91c8+_0x47f7b6,0x0)/_0x329552['length'];let _0x3305ec=0x0,_0x293b7c=0x0;for(let _0x15d038=0x0;_0x15d038<_0x2c4866[_0x5bcfc8(0xcb)];_0x15d038++){_0x3305ec+=(_0x2c4866[_0x15d038]-_0x86c99e)*(_0x329552[_0x15d038]-_0x4e5cff),_0x293b7c+=Math[_0x5bcfc8(0xfe)](_0x329552[_0x15d038]-_0x4e5cff,0x2);}_0x3305ec/=_0x2c4866['length'],_0x293b7c/=_0x2c4866[_0x5bcfc8(0xcb)];if(_0x293b7c<0.0001)return 0x0;return Math[_0x5bcfc8(0x102)](_0x3305ec/_0x293b7c);}[_0x3da12b(0x123)](_0x20a79b,_0x599046){const _0x17bbb2=_0x3da12b;let _0x55c5dc=this['kalmanStates'][_0x17bbb2(0x110)](_0x20a79b);if(!_0x55c5dc)return _0x55c5dc={'estimate':_0x599046,'errorCovariance':0x1},this['kalmanStates'][_0x17bbb2(0x108)](_0x20a79b,_0x55c5dc),_0x599046;const _0x44e1c0=_0x55c5dc[_0x17bbb2(0x115)],_0x4563f6=_0x55c5dc[_0x17bbb2(0xf4)]+this[_0x17bbb2(0x104)],_0x5e912c=_0x4563f6/(_0x4563f6+this['kalmanMeasurementNoise']),_0x5ad057=_0x44e1c0+_0x5e912c*(_0x599046-_0x44e1c0),_0x5ae60d=(0x1-_0x5e912c)*_0x4563f6;return _0x55c5dc['estimate']=_0x5ad057,_0x55c5dc[_0x17bbb2(0xf4)]=_0x5ae60d,_0x5ad057;}[_0x3da12b(0x116)](_0x4a6bfc,_0x371812){const _0x418e81=_0x3da12b,_0x1641a2=this['_calculateATR'](_0x371812),_0x10bee3=_0x1641a2/this['tickSize'];let _0x50c8f2=this[_0x418e81(0x111)]['get'](_0x4a6bfc);!_0x50c8f2&&(_0x50c8f2=[],this['atrHistory'][_0x418e81(0x108)](_0x4a6bfc,_0x50c8f2));_0x50c8f2['push'](_0x1641a2);if(_0x50c8f2['length']>0x1f4)_0x50c8f2['shift']();let _0x1d0a21=0.5;_0x50c8f2['length']>=0x14&&(_0x1d0a21=_0x50c8f2[_0x418e81(0x12c)](_0x33cf51=>_0x33cf51<=_0x1641a2)[_0x418e81(0xcb)]/_0x50c8f2[_0x418e81(0xcb)]);let _0x3bc301,_0x5587cf;if(_0x1d0a21<0.25)_0x3bc301='low',_0x5587cf={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x1d0a21<0.75?(_0x3bc301='normal',_0x5587cf={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0x3bc301=_0x418e81(0x11d),_0x5587cf={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0x3bc301,'params':_0x5587cf};}['_calculateATR'](_0x4148ce,_0x1080a3=0xe){const _0x341874=_0x3da12b;if(_0x4148ce['length']<_0x1080a3+0x1)return 2.5;const _0x3ce9aa=[];for(let _0x3dd4f3=_0x4148ce['length']-_0x1080a3;_0x3dd4f3<_0x4148ce['length'];_0x3dd4f3++){const _0x166e67=_0x4148ce[_0x3dd4f3],_0x350e18=_0x4148ce[_0x3dd4f3-0x1]['close'],_0x15ad7f=Math[_0x341874(0x12a)](_0x166e67['high']-_0x166e67['low'],Math['abs'](_0x166e67['high']-_0x350e18),Math['abs'](_0x166e67[_0x341874(0xf8)]-_0x350e18));_0x3ce9aa['push'](_0x15ad7f);}return _0x3ce9aa[_0x341874(0x11e)]((_0xdadf67,_0x379d30)=>_0xdadf67+_0x379d30,0x0)/_0x3ce9aa['length'];}['_computeOrderFlowImbalance'](_0x485966){const _0x492ff1=_0x3da12b;if(_0x485966[_0x492ff1(0xcb)]<this['ofiLookback'])return 0x0;const _0x157890=_0x485966['slice'](-this[_0x492ff1(0x10a)]);let _0x193294=0x0,_0x12598f=0x0;for(const _0x5785ed of _0x157890){const _0x23c618=_0x5785ed['high']-_0x5785ed['low'];if(_0x23c618>0x0){const _0x5286d5=(_0x5785ed['close']-_0x5785ed[_0x492ff1(0xf8)])/_0x23c618;_0x193294+=_0x5286d5*_0x5785ed[_0x492ff1(0xe9)],_0x12598f+=(0x1-_0x5286d5)*_0x5785ed[_0x492ff1(0xe9)];}}const _0x194b47=_0x193294+_0x12598f;if(_0x194b47<0x1)return 0x0;return(_0x193294-_0x12598f)/_0x194b47;}[_0x3da12b(0x11c)](_0x362db6,_0x8d5f50,_0x5adacf,_0x5d16f9,_0x520006,_0x438c9b,_0x3c2af0,_0x397fd1,_0x232da3,_0x7674ea){const _0x1973a5=_0x3da12b,_0x5203b2=Math['abs'](_0x5adacf);if(_0x5203b2<_0x397fd1[_0x1973a5(0x122)])return null;if(_0x5d16f9>this['vpinToxicThreshold'])return null;let _0x6e0c76;if(_0x5adacf<-_0x397fd1['zscoreThreshold'])_0x6e0c76=_0x1973a5(0xd0);else{if(_0x5adacf>_0x397fd1['zscoreThreshold'])_0x6e0c76=_0x1973a5(0xce);else return null;}const _0xd25623=_0x6e0c76==='long'&&_0x232da3>0.1||_0x6e0c76==='short'&&_0x232da3<-0.1,_0x532fe0=_0x8d5f50-_0x438c9b,_0x4bdc55=_0x6e0c76==='long'&&_0x532fe0<0x0||_0x6e0c76===_0x1973a5(0xce)&&_0x532fe0>0x0,_0x49a590={'zscore':Math['min'](0x1,_0x5203b2/0x4),'vpin':0x1-_0x5d16f9,'kyleLambda':_0x520006>0.001?0.5:0.8,'kalman':_0x4bdc55?0.8:0.4,'volatility':_0x3c2af0===_0x1973a5(0xd2)?0.8:_0x3c2af0==='low'?0.7:0.6,'ofi':_0xd25623?0.9:0.5,'composite':0x0};_0x49a590[_0x1973a5(0xf2)]=_0x49a590[_0x1973a5(0xe1)]*this[_0x1973a5(0xe5)]['zscore']+_0x49a590['vpin']*this[_0x1973a5(0xe5)]['vpin']+_0x49a590['kyleLambda']*this['weights'][_0x1973a5(0x124)]+_0x49a590['kalman']*this[_0x1973a5(0xe5)]['kalman']+_0x49a590['volatility']*this['weights']['volatility']+_0x49a590[_0x1973a5(0x12d)]*this[_0x1973a5(0xe5)]['ofi'];const _0x574d0f=Math[_0x1973a5(0x129)](0x1,_0x49a590[_0x1973a5(0xf2)]+_0x397fd1['confidenceBonus']);if(_0x574d0f<this['minConfidence'])return null;if(Date['now']()-this['lastSignalTime']<this[_0x1973a5(0xe8)])return null;const _0x4e7291=Math[_0x1973a5(0x11b)](this[_0x1973a5(0xfa)]*_0x397fd1[_0x1973a5(0x100)]),_0x2116b1=Math[_0x1973a5(0x11b)](this['baseTargetTicks']*_0x397fd1['targetMultiplier']),_0xf92e7d=Math['max'](0x6,Math[_0x1973a5(0x129)](0xc,_0x4e7291)),_0x463630=Math[_0x1973a5(0x12a)](_0xf92e7d*1.5,Math['min'](0x18,_0x2116b1));let _0x2fe4e7,_0x417457,_0x105bb0,_0x6d52b2;_0x6e0c76===_0x1973a5(0xd0)?(_0x2fe4e7=_0x8d5f50-_0xf92e7d*this['tickSize'],_0x417457=_0x8d5f50+_0x463630*this[_0x1973a5(0x118)],_0x105bb0=_0x8d5f50+this['breakevenTicks']*this[_0x1973a5(0x118)],_0x6d52b2=_0x8d5f50+_0x463630*this['profitLockPct']*this[_0x1973a5(0x118)]):(_0x2fe4e7=_0x8d5f50+_0xf92e7d*this[_0x1973a5(0x118)],_0x417457=_0x8d5f50-_0x463630*this[_0x1973a5(0x118)],_0x105bb0=_0x8d5f50-this[_0x1973a5(0x10e)]*this[_0x1973a5(0x118)],_0x6d52b2=_0x8d5f50-_0x463630*this['profitLockPct']*this['tickSize']);const _0x28ef7c=_0x463630/_0xf92e7d,_0x19650d=Math['round'](_0x463630*0.5),_0x2337a4=Math[_0x1973a5(0x11b)](_0xf92e7d*0.4);let _0x4b10f9=SignalStrength['MODERATE'];if(_0x574d0f>=0.85)_0x4b10f9=SignalStrength['VERY_STRONG'];else{if(_0x574d0f>=0.75)_0x4b10f9=SignalStrength['STRONG'];else{if(_0x574d0f<0.6)_0x4b10f9=SignalStrength[_0x1973a5(0x103)];}}const _0x512316=0.5+(_0x574d0f-0.5)*0.4,_0x347e8f=_0x512316*Math['abs'](_0x417457-_0x8d5f50)-(0x1-_0x512316)*Math[_0x1973a5(0x102)](_0x8d5f50-_0x2fe4e7);this['lastSignalTime']=Date[_0x1973a5(0x106)](),this[_0x1973a5(0xf0)][_0x1973a5(0xcc)]++;const _0x1f5186={'id':uuidv4(),'timestamp':Date['now'](),'symbol':_0x362db6['split']('.')[0x0]||_0x362db6,'contractId':_0x362db6,'side':_0x6e0c76==='long'?OrderSide[_0x1973a5(0x107)]:OrderSide[_0x1973a5(0x12e)],'direction':_0x6e0c76,'strategy':_0x1973a5(0x120),'strength':_0x4b10f9,'edge':_0x347e8f,'confidence':_0x574d0f,'entry':_0x8d5f50,'entryPrice':_0x8d5f50,'stopLoss':_0x2fe4e7,'takeProfit':_0x417457,'riskReward':_0x28ef7c,'stopTicks':_0xf92e7d,'targetTicks':_0x463630,'trailTriggerTicks':_0x19650d,'trailDistanceTicks':_0x2337a4,'beBreakeven':_0x105bb0,'profitLockLevel':_0x6d52b2,'zScore':_0x5adacf,'zScoreExit':this['zscoreExitThreshold'],'vpinValue':_0x5d16f9,'kyleLambda':_0x520006,'kalmanEstimate':_0x438c9b,'volatilityRegime':_0x3c2af0,'ofiValue':_0x232da3,'models':_0x49a590,'orderFlowConfirmed':_0xd25623,'kalmanConfirmed':_0x4bdc55,'expires':Date[_0x1973a5(0x106)]()+0xea60};return this['emit'](_0x1973a5(0xec),{'side':_0x6e0c76===_0x1973a5(0xd0)?'buy':'sell','action':_0x1973a5(0xc9),'reason':'Z='+_0x5adacf['toFixed'](0x2)+',\x20VPIN='+(_0x5d16f9*0x64)['toFixed'](0x0)+'%,\x20OFI='+(_0x232da3*0x64)[_0x1973a5(0x10d)](0x0)+_0x1973a5(0xf5)+(_0x574d0f*0x64)[_0x1973a5(0x10d)](0x0)+'%',..._0x1f5186}),this['emit'](_0x1973a5(0x128),{'type':_0x1973a5(0x105),'message':'[HQX]\x20SIGNAL:\x20'+_0x6e0c76['toUpperCase']()+_0x1973a5(0xd5)+_0x8d5f50['toFixed'](0x2)+'\x20|\x20Z:'+_0x5adacf['toFixed'](0x2)+_0x1973a5(0x117)+(_0x5d16f9*0x64)[_0x1973a5(0x10d)](0x0)+_0x1973a5(0x127)+(_0x232da3*0x64)['toFixed'](0x0)+'%\x20Kyle:'+_0x520006['toFixed'](0x5)+'\x20Regime:'+_0x3c2af0+'\x20|\x20Conf:'+(_0x574d0f*0x64)['toFixed'](0x0)+'%'}),_0x1f5186;}['shouldExitByZScore'](_0x296a56){const _0x34aca4=_0x3da12b,_0x19a780=this['priceBuffer']['get'](_0x296a56);if(!_0x19a780||_0x19a780['length']<0x32)return![];const _0x28f18a=this['_computeZScore'](_0x19a780);return Math[_0x34aca4(0x102)](_0x28f18a)<this[_0x34aca4(0x113)];}[_0x3da12b(0xde)](_0x1e367e){const _0x1b844d=_0x3da12b,_0x537343=this[_0x1b844d(0x126)][_0x1b844d(0x110)](_0x1e367e),_0x40e92c=this['volumeBuffer'][_0x1b844d(0x110)](_0x1e367e),_0x124814=this[_0x1b844d(0x130)]['get'](_0x1e367e);if(!_0x537343||!_0x40e92c||!_0x124814||_0x124814['length']<0x32)return null;const _0x1700ab=this[_0x1b844d(0xed)](_0x537343),_0x4f7b7f=this['_computeVPIN'](_0x40e92c),_0xd4a247=this[_0x1b844d(0xef)](_0x124814),_0x4259a6=this[_0x1b844d(0xd1)](_0x124814);return{'zscore':Math['min'](0x1,Math[_0x1b844d(0x102)](_0x1700ab)/0x4),'vpin':0x1-_0x4f7b7f,'kyleLambda':_0xd4a247>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math[_0x1b844d(0x102)](_0x4259a6)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x1700ab,'vpin':_0x4f7b7f,'kyleLambda':_0xd4a247,'ofi':_0x4259a6}};}[_0x3da12b(0xc7)](_0x384545,_0x45eca4){const _0x31752b=_0x3da12b,_0xad502b=this[_0x31752b(0x130)][_0x31752b(0x110)](_0x384545)||[];if(_0xad502b[_0x31752b(0xcb)]<0x32)return{'ready':![],'message':_0x31752b(0xdd)+_0xad502b['length']+_0x31752b(0x119)};const _0x2c5617=this['priceBuffer'][_0x31752b(0x110)](_0x384545)||[],_0x24db6c=this[_0x31752b(0xd8)][_0x31752b(0x110)](_0x384545)||[],_0x345465=this['_computeZScore'](_0x2c5617),_0x2ef726=this[_0x31752b(0xe7)](_0x24db6c),_0x3bc367=this[_0x31752b(0xd1)](_0xad502b),_0x479828=this[_0x31752b(0xef)](_0xad502b),{regime:_0x2fbf4f,params:_0x284475}=this['_detectVolatilityRegime'](_0x384545,_0xad502b);return{'ready':!![],'zScore':_0x345465,'vpin':_0x2ef726,'ofi':_0x3bc367,'kyleLambda':_0x479828,'regime':_0x2fbf4f,'stopTicks':Math[_0x31752b(0x11b)](this[_0x31752b(0xfa)]*_0x284475['stopMultiplier']),'targetTicks':Math['round'](this[_0x31752b(0xeb)]*_0x284475['targetMultiplier']),'threshold':_0x284475[_0x31752b(0x122)],'barsProcessed':_0xad502b['length'],'models':_0x31752b(0xd9)};}['recordTradeResult'](_0x1311d9){const _0x21a2e1=_0x3da12b;this[_0x21a2e1(0xf9)]['push']({'netPnl':_0x1311d9,'timestamp':Date['now']()});if(this[_0x21a2e1(0xf9)]['length']>0x64)this[_0x21a2e1(0xf9)]['shift']();_0x1311d9>0x0?(this[_0x21a2e1(0xda)]++,this[_0x21a2e1(0xc4)]=0x0,this['stats'][_0x21a2e1(0xe4)]++):(this[_0x21a2e1(0xc4)]++,this[_0x21a2e1(0xda)]=0x0,this[_0x21a2e1(0xf0)][_0x21a2e1(0x10c)]++),this['stats']['trades']++,this[_0x21a2e1(0xf0)]['pnl']+=_0x1311d9,this[_0x21a2e1(0xea)](_0x21a2e1(0x128),{'type':'debug','message':_0x21a2e1(0xd7)+(_0x1311d9>0x0?'WIN':'LOSS')+'\x20$'+_0x1311d9[_0x21a2e1(0x10d)](0x2)+_0x21a2e1(0x11a)+(_0x1311d9>0x0?this['winStreak']:-this[_0x21a2e1(0xc4)])});}[_0x3da12b(0xe3)](_0x2f82b8){return this['barHistory']['get'](_0x2f82b8)||[];}[_0x3da12b(0x101)](){const _0x25eaad=_0x3da12b;return this[_0x25eaad(0xf0)];}[_0x3da12b(0xe6)](_0xdd980e){const _0x43cd06=_0x3da12b;this[_0x43cd06(0x130)]['set'](_0xdd980e,[]),this[_0x43cd06(0x126)][_0x43cd06(0x108)](_0xdd980e,[]),this[_0x43cd06(0xd8)][_0x43cd06(0x108)](_0xdd980e,[]),this['atrHistory']['set'](_0xdd980e,[]),this[_0x43cd06(0xdb)][_0x43cd06(0x108)](_0xdd980e,{'estimate':0x0,'errorCovariance':0x1}),this[_0x43cd06(0xea)](_0x43cd06(0x128),{'type':'info','message':'[HQX-UltraScalping]\x20Reset\x20state\x20for\x20'+_0xdd980e});}}class UltraScalpingStrategy extends EventEmitter{constructor(_0x5e8184={}){const _0x45d715=_0x3da12b;super(),this['config']=_0x5e8184,this['strategy']=new HQXUltraScalping(_0x5e8184),this[_0x45d715(0xff)]['on'](_0x45d715(0xec),_0x4cebff=>this['emit']('signal',_0x4cebff)),this[_0x45d715(0xff)]['on']('log',_0x4e40c8=>this[_0x45d715(0xea)]('log',_0x4e40c8));}[_0x3da12b(0xdc)](_0x2967ce){const _0x21dba7=_0x3da12b;return this[_0x21dba7(0xff)]['processTick'](_0x2967ce);}['onTick'](_0xe6dc4c){const _0x275f48=_0x3da12b;return this[_0x275f48(0xff)]['onTick'](_0xe6dc4c);}[_0x3da12b(0xca)](_0x4929de){const _0x20cba1=_0x3da12b;return this[_0x20cba1(0xff)][_0x20cba1(0xca)](_0x4929de);}['processBar'](_0x31566d,_0x33938c){const _0x31b415=_0x3da12b;return this[_0x31b415(0xff)][_0x31b415(0xcf)](_0x31566d,_0x33938c);}['initialize'](_0x39baf2,_0x56fd90,_0x9264ab){const _0x11acc2=_0x3da12b;return this[_0x11acc2(0xff)][_0x11acc2(0xc5)](_0x39baf2,_0x56fd90,_0x9264ab);}['getAnalysisState'](_0x5e099e,_0x18d65a){const _0x2f7ff8=_0x3da12b;return this[_0x2f7ff8(0xff)][_0x2f7ff8(0xc7)](_0x5e099e,_0x18d65a);}['recordTradeResult'](_0x4aa3dd){const _0x5b4404=_0x3da12b;return this[_0x5b4404(0xff)][_0x5b4404(0xe0)](_0x4aa3dd);}[_0x3da12b(0xe6)](_0x306e62){const _0x393299=_0x3da12b;return this['strategy'][_0x393299(0xe6)](_0x306e62);}[_0x3da12b(0x101)](){const _0x31bd5e=_0x3da12b;return this[_0x31bd5e(0xff)][_0x31bd5e(0x101)]();}['getBarHistory'](_0x435b6a){return this['strategy']['getBarHistory'](_0x435b6a);}[_0x3da12b(0xde)](_0x23f498){return this['strategy']['getModelValues'](_0x23f498);}['shouldExitByZScore'](_0x875cff){const _0x43cc5c=_0x3da12b;return this[_0x43cc5c(0xff)][_0x43cc5c(0xc6)](_0x875cff);}[_0x3da12b(0xf6)](_0x55b6d0){return null;}}function _0x58c7(_0x5a0252,_0x2ab212){_0x5a0252=_0x5a0252-0xc4;const _0x556667=_0x5566();let _0x58c76c=_0x556667[_0x5a0252];return _0x58c76c;}function _0x5566(){const _0x20771a=['profitLockPct','open','onTrade','length','signals','2238696lGImgI','short','processBar','long','_computeOrderFlowImbalance','normal','vpinWindow','349601wOjQWr','\x20@\x20','18332YBVOaj','[HQX]\x20Trade\x20result:\x20','volumeBuffer','6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)','winStreak','kalmanStates','processTick','Collecting\x20data...\x20','getModelValues','1075VhKXQd','recordTradeResult','zscore','size','getBarHistory','wins','weights','reset','_computeVPIN','cooldownMs','volume','emit','baseTargetTicks','signal','_computeZScore','5560880tVMTVj','_computeKyleLambda','stats','push','composite','lastSignalTime','errorCovariance','%,\x20cf=','generateSignal','uuid','low','recentTrades','baseStopTicks','events','close','slice','pow','strategy','stopMultiplier','getStats','abs','WEAK','kalmanProcessNoise','info','now','BID','set','677EriKCE','ofiLookback','symbol','losses','toFixed','breakevenTicks','[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)','get','atrHistory','shift','zscoreExitThreshold','3631959exDCIv','estimate','_detectVolatilityRegime','\x20VPIN:','tickSize','/50\x20bars',',\x20streak:\x20','round','_generateSignal','high','reduce','60QFUEhj','HQX_ULTRA_SCALPING_6MODELS','kalmanMeasurementNoise','zscoreThreshold','_applyKalmanFilter','kyleLambda','16009800Zxfxtb','priceBuffer','%\x20OFI:','log','min','max','exports','filter','ofi','ASK','724PCJxav','barHistory','timestamp','lossStreak','initialize','shouldExitByZScore','getAnalysisState'];_0x5566=function(){return _0x20771a;};return _0x5566();}module[_0x3da12b(0x12b)]={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};