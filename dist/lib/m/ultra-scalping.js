const _0x275bdf=_0x3870;(function(_0x4cf09d,_0x242db3){const _0x4c4c11=_0x3870,_0x7c04c4=_0x4cf09d();while(!![]){try{const _0x4bc5d3=-parseInt(_0x4c4c11(0x195))/0x1*(-parseInt(_0x4c4c11(0x1fa))/0x2)+-parseInt(_0x4c4c11(0x1c9))/0x3+parseInt(_0x4c4c11(0x1c5))/0x4*(parseInt(_0x4c4c11(0x1d3))/0x5)+parseInt(_0x4c4c11(0x1bb))/0x6+-parseInt(_0x4c4c11(0x1c8))/0x7+-parseInt(_0x4c4c11(0x1e5))/0x8*(-parseInt(_0x4c4c11(0x1d4))/0x9)+parseInt(_0x4c4c11(0x1c0))/0xa*(-parseInt(_0x4c4c11(0x1f4))/0xb);if(_0x4bc5d3===_0x242db3)break;else _0x7c04c4['push'](_0x7c04c4['shift']());}catch(_0x5ec1d3){_0x7c04c4['push'](_0x7c04c4['shift']());}}}(_0xa6d2,0x95d84));const EventEmitter=require(_0x275bdf(0x1b8)),{v4:uuidv4}=require('uuid'),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};function _0x3870(_0x64082e,_0x2e8caf){_0x64082e=_0x64082e-0x194;const _0xa6d287=_0xa6d2();let _0x3870d9=_0xa6d287[_0x64082e];return _0x3870d9;}class HQXUltraScalping extends EventEmitter{constructor(_0x42b1ab={}){const _0x4dbd3d=_0x275bdf;super(),this[_0x4dbd3d(0x1f6)]=_0x42b1ab[_0x4dbd3d(0x1f6)]||0.25,this[_0x4dbd3d(0x1b1)]=_0x42b1ab['tickValue']||0x5,this['zscoreEntryThreshold']=1.5,this['zscoreExitThreshold']=0.5,this['vpinWindow']=0x32,this['vpinToxicThreshold']=0.7,this[_0x4dbd3d(0x1aa)]=0.01,this['kalmanMeasurementNoise']=0.1,this['volatilityLookback']=0x64,this[_0x4dbd3d(0x1c3)]=0x14,this['baseStopTicks']=0x8,this[_0x4dbd3d(0x1ef)]=0x10,this['breakevenTicks']=0x4,this[_0x4dbd3d(0x1c7)]=0.5,this[_0x4dbd3d(0x1ad)]=0.55,this[_0x4dbd3d(0x1b5)]={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this['barHistory']=new Map(),this['priceBuffer']=new Map(),this['volumeBuffer']=new Map(),this[_0x4dbd3d(0x1cf)]=new Map(),this[_0x4dbd3d(0x1d0)]=new Map(),this['recentTrades']=[],this[_0x4dbd3d(0x1c1)]=0x0,this['lossStreak']=0x0,this[_0x4dbd3d(0x19b)]=0x0,this['cooldownMs']=0x7530,this[_0x4dbd3d(0x1ed)]=0x2710,this['stats']={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}['initialize'](_0x548902,_0x1cd5a3=0.25,_0x44185e=0x5){const _0x8b6348=_0x275bdf;this['tickSize']=_0x1cd5a3,this[_0x8b6348(0x1b1)]=_0x44185e,this[_0x8b6348(0x1a0)]['set'](_0x548902,[]),this['priceBuffer']['set'](_0x548902,[]),this['volumeBuffer']['set'](_0x548902,[]),this[_0x8b6348(0x1d0)]['set'](_0x548902,[]),this[_0x8b6348(0x1cf)][_0x8b6348(0x1f8)](_0x548902,{'estimate':0x0,'errorCovariance':0x1}),this['emit'](_0x8b6348(0x1b0),{'type':_0x8b6348(0x1fb),'message':'[HQX-UltraScalping]\x20Initialized\x20for\x20'+_0x548902+':\x20tick='+_0x1cd5a3+',\x20value='+_0x44185e}),this['emit'](_0x8b6348(0x1b0),{'type':_0x8b6348(0x1fb),'message':'[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)'});}['processTick'](_0x26ea89){const _0x46ba5b=_0x275bdf,{contractId:_0x3804f9,price:_0x55b3d1,volume:_0x249082,side:_0x183a53,timestamp:_0x5e5f51}=_0x26ea89,_0x383cbc={'timestamp':_0x5e5f51||Date[_0x46ba5b(0x1d1)](),'open':_0x55b3d1,'high':_0x55b3d1,'low':_0x55b3d1,'close':_0x55b3d1,'volume':_0x249082||0x1};return this['processBar'](_0x3804f9,_0x383cbc);}[_0x275bdf(0x1bc)](_0x942f7){const _0xa3edb6=_0x275bdf;return this[_0xa3edb6(0x1dc)](_0x942f7);}['onTrade'](_0x2d4be8){const _0x489fd0=_0x275bdf;return this['processTick']({'contractId':_0x2d4be8['contractId']||_0x2d4be8[_0x489fd0(0x1cb)],'price':_0x2d4be8['price'],'volume':_0x2d4be8['size']||_0x2d4be8[_0x489fd0(0x1b6)]||0x1,'side':_0x2d4be8['side'],'timestamp':_0x2d4be8['timestamp']||Date[_0x489fd0(0x1d1)]()});}['processBar'](_0x4790a9,_0x480bc0){const _0x10287b=_0x275bdf;let _0x15a962=this[_0x10287b(0x1a0)][_0x10287b(0x1c6)](_0x4790a9);!_0x15a962&&(this[_0x10287b(0x1a2)](_0x4790a9),_0x15a962=this['barHistory'][_0x10287b(0x1c6)](_0x4790a9));_0x15a962['push'](_0x480bc0);if(_0x15a962[_0x10287b(0x1d5)]>0x1f4)_0x15a962['shift']();const _0x583017=this[_0x10287b(0x1ce)][_0x10287b(0x1c6)](_0x4790a9);_0x583017[_0x10287b(0x1b4)](_0x480bc0['close']);if(_0x583017[_0x10287b(0x1d5)]>0xc8)_0x583017['shift']();const _0x44da10=this['volumeBuffer']['get'](_0x4790a9),_0x478f3b=_0x480bc0['high']-_0x480bc0['low'];let _0x7eab4a=_0x480bc0['volume']*0.5,_0x12eb23=_0x480bc0[_0x10287b(0x1b6)]*0.5;if(_0x478f3b>0x0){const _0x4e39ec=(_0x480bc0['close']-_0x480bc0[_0x10287b(0x1a3)])/_0x478f3b;_0x7eab4a=_0x480bc0[_0x10287b(0x1b6)]*_0x4e39ec,_0x12eb23=_0x480bc0['volume']*(0x1-_0x4e39ec);}_0x44da10['push']({'buy':_0x7eab4a,'sell':_0x12eb23});if(_0x44da10[_0x10287b(0x1d5)]>0x64)_0x44da10['shift']();if(_0x15a962[_0x10287b(0x1d5)]<0x32)return null;const _0x333481=this[_0x10287b(0x1fd)](_0x583017),_0x3e6976=this['_computeVPIN'](_0x44da10),_0x3f0c53=this['_computeKyleLambda'](_0x15a962),_0x342575=this['_applyKalmanFilter'](_0x4790a9,_0x480bc0['close']),{regime:_0x59bbb1,params:_0x570de4}=this[_0x10287b(0x1f2)](_0x4790a9,_0x15a962),_0xeb9978=this[_0x10287b(0x1ee)](_0x15a962);return this[_0x10287b(0x19c)](_0x4790a9,_0x480bc0[_0x10287b(0x1e2)],_0x333481,_0x3e6976,_0x3f0c53,_0x342575,_0x59bbb1,_0x570de4,_0xeb9978,_0x15a962);}[_0x275bdf(0x1fd)](_0x11fd0f,_0x15925f=0x32){const _0x2eb95c=_0x275bdf;if(_0x11fd0f[_0x2eb95c(0x1d5)]<_0x15925f)return 0x0;const _0x5c20d7=_0x11fd0f[_0x2eb95c(0x1d8)](-_0x15925f),_0xce67e2=_0x5c20d7['reduce']((_0x48d506,_0x4dd99b)=>_0x48d506+_0x4dd99b,0x0)/_0x15925f,_0x3c6647=_0x5c20d7[_0x2eb95c(0x1e0)]((_0x5548ee,_0x4dedb7)=>_0x5548ee+Math['pow'](_0x4dedb7-_0xce67e2,0x2),0x0)/_0x15925f,_0x3e47eb=Math['sqrt'](_0x3c6647);if(_0x3e47eb<0.0001)return 0x0;const _0x1c5aa3=_0x11fd0f[_0x11fd0f['length']-0x1];return(_0x1c5aa3-_0xce67e2)/_0x3e47eb;}['_computeVPIN'](_0x33fbb9){const _0x1734bf=_0x275bdf;if(_0x33fbb9['length']<this['vpinWindow'])return 0.5;const _0x20107c=_0x33fbb9[_0x1734bf(0x1d8)](-this['vpinWindow']);let _0x577646=0x0,_0x431fee=0x0;for(const _0xd8aac3 of _0x20107c){_0x577646+=_0xd8aac3['buy'],_0x431fee+=_0xd8aac3['sell'];}const _0x3210c7=_0x577646+_0x431fee;if(_0x3210c7<0x1)return 0.5;return Math['abs'](_0x577646-_0x431fee)/_0x3210c7;}[_0x275bdf(0x1c4)](_0x4a0167){const _0x1b95ce=_0x275bdf;if(_0x4a0167['length']<0x14)return 0x0;const _0xf67c45=_0x4a0167['slice'](-0x14),_0x507447=[],_0x7752a8=[];for(let _0x53f442=0x1;_0x53f442<_0xf67c45['length'];_0x53f442++){_0x507447[_0x1b95ce(0x1b4)](_0xf67c45[_0x53f442][_0x1b95ce(0x1e2)]-_0xf67c45[_0x53f442-0x1]['close']),_0x7752a8['push'](_0xf67c45[_0x53f442]['volume']);}const _0x563196=_0x507447['reduce']((_0x110fb0,_0x217067)=>_0x110fb0+_0x217067,0x0)/_0x507447['length'],_0x409200=_0x7752a8[_0x1b95ce(0x1e0)]((_0x3a5768,_0x27039f)=>_0x3a5768+_0x27039f,0x0)/_0x7752a8['length'];let _0xa83877=0x0,_0x291947=0x0;for(let _0x14257e=0x0;_0x14257e<_0x507447['length'];_0x14257e++){_0xa83877+=(_0x507447[_0x14257e]-_0x563196)*(_0x7752a8[_0x14257e]-_0x409200),_0x291947+=Math[_0x1b95ce(0x1b2)](_0x7752a8[_0x14257e]-_0x409200,0x2);}_0xa83877/=_0x507447[_0x1b95ce(0x1d5)],_0x291947/=_0x507447['length'];if(_0x291947<0.0001)return 0x0;return Math[_0x1b95ce(0x1db)](_0xa83877/_0x291947);}['_applyKalmanFilter'](_0x4795bb,_0x496486){const _0x4ec948=_0x275bdf;let _0x40a75=this['kalmanStates']['get'](_0x4795bb);if(!_0x40a75)return _0x40a75={'estimate':_0x496486,'errorCovariance':0x1},this['kalmanStates'][_0x4ec948(0x1f8)](_0x4795bb,_0x40a75),_0x496486;const _0x47e2d9=_0x40a75['estimate'],_0x3d4443=_0x40a75['errorCovariance']+this[_0x4ec948(0x1aa)],_0x32f7ee=_0x3d4443/(_0x3d4443+this[_0x4ec948(0x194)]),_0x2f2ae2=_0x47e2d9+_0x32f7ee*(_0x496486-_0x47e2d9),_0x195d86=(0x1-_0x32f7ee)*_0x3d4443;return _0x40a75['estimate']=_0x2f2ae2,_0x40a75['errorCovariance']=_0x195d86,_0x2f2ae2;}[_0x275bdf(0x1f2)](_0x9bdf27,_0x43fd18){const _0x347a5f=_0x275bdf,_0x13a5da=this[_0x347a5f(0x1e3)](_0x43fd18),_0x53130b=_0x13a5da/this[_0x347a5f(0x1f6)];let _0x393b22=this[_0x347a5f(0x1d0)]['get'](_0x9bdf27);!_0x393b22&&(_0x393b22=[],this[_0x347a5f(0x1d0)]['set'](_0x9bdf27,_0x393b22));_0x393b22['push'](_0x13a5da);if(_0x393b22[_0x347a5f(0x1d5)]>0x1f4)_0x393b22[_0x347a5f(0x1cd)]();let _0x2a6218=0.5;_0x393b22[_0x347a5f(0x1d5)]>=0x14&&(_0x2a6218=_0x393b22[_0x347a5f(0x1a8)](_0x5f24dd=>_0x5f24dd<=_0x13a5da)['length']/_0x393b22['length']);let _0xafd7ce,_0x3967e3;if(_0x2a6218<0.25)_0xafd7ce=_0x347a5f(0x1a3),_0x3967e3={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x2a6218<0.75?(_0xafd7ce='normal',_0x3967e3={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0xafd7ce=_0x347a5f(0x1f5),_0x3967e3={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0xafd7ce,'params':_0x3967e3};}[_0x275bdf(0x1e3)](_0x3d3675,_0x3f3991=0xe){const _0x35f08a=_0x275bdf;if(_0x3d3675['length']<_0x3f3991+0x1)return 2.5;const _0x440100=[];for(let _0x59092a=_0x3d3675['length']-_0x3f3991;_0x59092a<_0x3d3675[_0x35f08a(0x1d5)];_0x59092a++){const _0x400418=_0x3d3675[_0x59092a],_0x4ce7e3=_0x3d3675[_0x59092a-0x1]['close'],_0x2e7f14=Math['max'](_0x400418[_0x35f08a(0x1f5)]-_0x400418[_0x35f08a(0x1a3)],Math[_0x35f08a(0x1db)](_0x400418[_0x35f08a(0x1f5)]-_0x4ce7e3),Math['abs'](_0x400418[_0x35f08a(0x1a3)]-_0x4ce7e3));_0x440100[_0x35f08a(0x1b4)](_0x2e7f14);}return _0x440100['reduce']((_0x4a9bc6,_0x6a357c)=>_0x4a9bc6+_0x6a357c,0x0)/_0x440100['length'];}[_0x275bdf(0x1ee)](_0x41b8db){const _0x3a3d3b=_0x275bdf;if(_0x41b8db[_0x3a3d3b(0x1d5)]<this[_0x3a3d3b(0x1c3)])return 0x0;const _0xc9df0c=_0x41b8db[_0x3a3d3b(0x1d8)](-this[_0x3a3d3b(0x1c3)]);let _0x386de4=0x0,_0x6882a1=0x0;for(const _0x4d79b1 of _0xc9df0c){const _0x376a32=_0x4d79b1[_0x3a3d3b(0x1f5)]-_0x4d79b1[_0x3a3d3b(0x1a3)];if(_0x376a32>0x0){const _0x4602ac=(_0x4d79b1[_0x3a3d3b(0x1e2)]-_0x4d79b1[_0x3a3d3b(0x1a3)])/_0x376a32;_0x386de4+=_0x4602ac*_0x4d79b1['volume'],_0x6882a1+=(0x1-_0x4602ac)*_0x4d79b1[_0x3a3d3b(0x1b6)];}}const _0xe68b51=_0x386de4+_0x6882a1;if(_0xe68b51<0x1)return 0x0;return(_0x386de4-_0x6882a1)/_0xe68b51;}[_0x275bdf(0x19c)](_0x8b4fcb,_0x5b54e2,_0x5c8341,_0x2de9c5,_0x52f8fb,_0x4aefcf,_0x21db8d,_0x31c88e,_0x34503b,_0xec9d9d){const _0x2331f1=_0x275bdf,_0x343e70=Math[_0x2331f1(0x1db)](_0x5c8341);if(_0x343e70<_0x31c88e[_0x2331f1(0x1de)])return null;if(_0x2de9c5>this['vpinToxicThreshold'])return null;let _0x340b41;if(_0x5c8341<-_0x31c88e['zscoreThreshold'])_0x340b41=_0x2331f1(0x1ca);else{if(_0x5c8341>_0x31c88e['zscoreThreshold'])_0x340b41='short';else return null;}const _0x28e223=_0x340b41===_0x2331f1(0x1ca)&&_0x34503b>0.1||_0x340b41===_0x2331f1(0x1e6)&&_0x34503b<-0.1,_0x5cbb95=_0x5b54e2-_0x4aefcf,_0x275b54=_0x340b41==='long'&&_0x5cbb95<0x0||_0x340b41==='short'&&_0x5cbb95>0x0,_0x18c5dc={'zscore':Math['min'](0x1,_0x343e70/0x4),'vpin':0x1-_0x2de9c5,'kyleLambda':_0x52f8fb>0.001?0.5:0.8,'kalman':_0x275b54?0.8:0.4,'volatility':_0x21db8d===_0x2331f1(0x19a)?0.8:_0x21db8d===_0x2331f1(0x1a3)?0.7:0.6,'ofi':_0x28e223?0.9:0.5,'composite':0x0};_0x18c5dc[_0x2331f1(0x1d6)]=_0x18c5dc['zscore']*this['weights']['zscore']+_0x18c5dc[_0x2331f1(0x19e)]*this[_0x2331f1(0x1b5)][_0x2331f1(0x19e)]+_0x18c5dc['kyleLambda']*this['weights']['kyleLambda']+_0x18c5dc['kalman']*this[_0x2331f1(0x1b5)][_0x2331f1(0x1e7)]+_0x18c5dc[_0x2331f1(0x1a9)]*this['weights']['volatility']+_0x18c5dc[_0x2331f1(0x1a5)]*this['weights'][_0x2331f1(0x1a5)];const _0x5eb783=Math['min'](0x1,_0x18c5dc[_0x2331f1(0x1d6)]+_0x31c88e['confidenceBonus']);if(_0x5eb783<this[_0x2331f1(0x1ad)])return null;if(Date[_0x2331f1(0x1d1)]()-this[_0x2331f1(0x19b)]<this['cooldownMs'])return null;const _0x3e1a3d=Math['round'](this[_0x2331f1(0x1ea)]*_0x31c88e['stopMultiplier']),_0x3cacb9=Math['round'](this[_0x2331f1(0x1ef)]*_0x31c88e['targetMultiplier']),_0x23c738=Math['max'](0x6,Math[_0x2331f1(0x1e8)](0xc,_0x3e1a3d)),_0x5a6a9a=Math[_0x2331f1(0x196)](_0x23c738*1.5,Math['min'](0x18,_0x3cacb9));let _0x1e7eb4,_0x293aa6,_0x3bc9dd,_0x3a8f1b;_0x340b41==='long'?(_0x1e7eb4=_0x5b54e2-_0x23c738*this[_0x2331f1(0x1f6)],_0x293aa6=_0x5b54e2+_0x5a6a9a*this['tickSize'],_0x3bc9dd=_0x5b54e2+this['breakevenTicks']*this[_0x2331f1(0x1f6)],_0x3a8f1b=_0x5b54e2+_0x5a6a9a*this[_0x2331f1(0x1c7)]*this[_0x2331f1(0x1f6)]):(_0x1e7eb4=_0x5b54e2+_0x23c738*this[_0x2331f1(0x1f6)],_0x293aa6=_0x5b54e2-_0x5a6a9a*this[_0x2331f1(0x1f6)],_0x3bc9dd=_0x5b54e2-this[_0x2331f1(0x1be)]*this['tickSize'],_0x3a8f1b=_0x5b54e2-_0x5a6a9a*this['profitLockPct']*this[_0x2331f1(0x1f6)]);const _0x4cf6ad=_0x5a6a9a/_0x23c738,_0x331e02=Math[_0x2331f1(0x1cc)](_0x5a6a9a*0.5),_0x11cd72=Math[_0x2331f1(0x1cc)](_0x23c738*0.4);let _0x20b83a=SignalStrength['MODERATE'];if(_0x5eb783>=0.85)_0x20b83a=SignalStrength['VERY_STRONG'];else{if(_0x5eb783>=0.75)_0x20b83a=SignalStrength[_0x2331f1(0x19f)];else{if(_0x5eb783<0.6)_0x20b83a=SignalStrength['WEAK'];}}const _0x2ed6d2=0.5+(_0x5eb783-0.5)*0.4,_0x5d523c=_0x2ed6d2*Math['abs'](_0x293aa6-_0x5b54e2)-(0x1-_0x2ed6d2)*Math[_0x2331f1(0x1db)](_0x5b54e2-_0x1e7eb4);this['lastSignalTime']=Date[_0x2331f1(0x1d1)](),this[_0x2331f1(0x1d2)][_0x2331f1(0x1fe)]++;const _0x1fc139={'id':uuidv4(),'timestamp':Date[_0x2331f1(0x1d1)](),'symbol':_0x8b4fcb[_0x2331f1(0x19d)]('.')[0x0]||_0x8b4fcb,'contractId':_0x8b4fcb,'side':_0x340b41===_0x2331f1(0x1ca)?OrderSide[_0x2331f1(0x1af)]:OrderSide['ASK'],'direction':_0x340b41,'strategy':'HQX_ULTRA_SCALPING_6MODELS','strength':_0x20b83a,'edge':_0x5d523c,'confidence':_0x5eb783,'entry':_0x5b54e2,'entryPrice':_0x5b54e2,'stopLoss':_0x1e7eb4,'takeProfit':_0x293aa6,'riskReward':_0x4cf6ad,'stopTicks':_0x23c738,'targetTicks':_0x5a6a9a,'trailTriggerTicks':_0x331e02,'trailDistanceTicks':_0x11cd72,'beBreakeven':_0x3bc9dd,'profitLockLevel':_0x3a8f1b,'zScore':_0x5c8341,'zScoreExit':this[_0x2331f1(0x1d7)],'vpinValue':_0x2de9c5,'kyleLambda':_0x52f8fb,'kalmanEstimate':_0x4aefcf,'volatilityRegime':_0x21db8d,'ofiValue':_0x34503b,'models':_0x18c5dc,'orderFlowConfirmed':_0x28e223,'kalmanConfirmed':_0x275b54,'expires':Date[_0x2331f1(0x1d1)]()+0xea60};return this['emit'](_0x2331f1(0x199),{'side':_0x340b41==='long'?'buy':'sell','action':_0x2331f1(0x1b7),'reason':'Z='+_0x5c8341['toFixed'](0x2)+',\x20VPIN='+(_0x2de9c5*0x64)[_0x2331f1(0x1e4)](0x0)+'%,\x20OFI='+(_0x34503b*0x64)['toFixed'](0x0)+_0x2331f1(0x1e9)+(_0x5eb783*0x64)['toFixed'](0x0)+'%',..._0x1fc139}),this[_0x2331f1(0x1f9)]('log',{'type':'info','message':'[HQX]\x20SIGNAL:\x20'+_0x340b41['toUpperCase']()+'\x20@\x20'+_0x5b54e2['toFixed'](0x2)+_0x2331f1(0x1ac)+_0x5c8341[_0x2331f1(0x1e4)](0x2)+'\x20VPIN:'+(_0x2de9c5*0x64)['toFixed'](0x0)+_0x2331f1(0x1a1)+(_0x34503b*0x64)['toFixed'](0x0)+'%\x20Kyle:'+_0x52f8fb[_0x2331f1(0x1e4)](0x5)+_0x2331f1(0x1f0)+_0x21db8d+'\x20|\x20Conf:'+(_0x5eb783*0x64)[_0x2331f1(0x1e4)](0x0)+'%'}),_0x1fc139;}['shouldExitByZScore'](_0x2e5a58){const _0x992f55=_0x275bdf,_0x3ce184=this[_0x992f55(0x1ce)]['get'](_0x2e5a58);if(!_0x3ce184||_0x3ce184['length']<0x32)return![];const _0x546aff=this[_0x992f55(0x1fd)](_0x3ce184);return Math[_0x992f55(0x1db)](_0x546aff)<this[_0x992f55(0x1d7)];}[_0x275bdf(0x1df)](_0x27d81d){const _0x262711=_0x275bdf,_0x38d417=this[_0x262711(0x1ce)][_0x262711(0x1c6)](_0x27d81d),_0x54a280=this['volumeBuffer'][_0x262711(0x1c6)](_0x27d81d),_0x38eba1=this['barHistory'][_0x262711(0x1c6)](_0x27d81d);if(!_0x38d417||!_0x54a280||!_0x38eba1||_0x38eba1['length']<0x32)return null;const _0x5ca5a3=this[_0x262711(0x1fd)](_0x38d417),_0x3a922f=this['_computeVPIN'](_0x54a280),_0x31c01d=this[_0x262711(0x1c4)](_0x38eba1),_0x22cd1f=this[_0x262711(0x1ee)](_0x38eba1);return{'zscore':Math[_0x262711(0x1e8)](0x1,Math['abs'](_0x5ca5a3)/0x4),'vpin':0x1-_0x3a922f,'kyleLambda':_0x31c01d>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math['abs'](_0x22cd1f)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x5ca5a3,'vpin':_0x3a922f,'kyleLambda':_0x31c01d,'ofi':_0x22cd1f}};}[_0x275bdf(0x1b3)](_0x6e62d2,_0xe9fe13){const _0x1439bd=_0x275bdf,_0x4b9c91=this['barHistory']['get'](_0x6e62d2)||[];if(_0x4b9c91[_0x1439bd(0x1d5)]<0x32)return{'ready':![],'message':'Collecting\x20data...\x20'+_0x4b9c91['length']+'/50\x20bars'};const _0x11bb1e=this[_0x1439bd(0x1ce)][_0x1439bd(0x1c6)](_0x6e62d2)||[],_0x523cca=this['volumeBuffer'][_0x1439bd(0x1c6)](_0x6e62d2)||[],_0x36e2b7=this[_0x1439bd(0x1fd)](_0x11bb1e),_0x366c2a=this['_computeVPIN'](_0x523cca),_0x19815c=this[_0x1439bd(0x1ee)](_0x4b9c91),_0x30726a=this[_0x1439bd(0x1c4)](_0x4b9c91),{regime:_0x1cbbe7,params:_0x35a1c7}=this[_0x1439bd(0x1f2)](_0x6e62d2,_0x4b9c91);return{'ready':!![],'zScore':_0x36e2b7,'vpin':_0x366c2a,'ofi':_0x19815c,'kyleLambda':_0x30726a,'regime':_0x1cbbe7,'stopTicks':Math['round'](this[_0x1439bd(0x1ea)]*_0x35a1c7[_0x1439bd(0x1a6)]),'targetTicks':Math['round'](this[_0x1439bd(0x1ef)]*_0x35a1c7['targetMultiplier']),'threshold':_0x35a1c7[_0x1439bd(0x1de)],'barsProcessed':_0x4b9c91['length'],'models':_0x1439bd(0x1bd)};}[_0x275bdf(0x1a7)](_0x41fb15){const _0x2fca78=_0x275bdf;this[_0x2fca78(0x1e1)]['push']({'netPnl':_0x41fb15,'timestamp':Date['now']()});if(this[_0x2fca78(0x1e1)]['length']>0x64)this[_0x2fca78(0x1e1)]['shift']();_0x41fb15>0x0?(this['winStreak']++,this['lossStreak']=0x0,this['stats']['wins']++):(this[_0x2fca78(0x1d9)]++,this['winStreak']=0x0,this[_0x2fca78(0x1d2)]['losses']++),this[_0x2fca78(0x1d2)][_0x2fca78(0x1ba)]++,this[_0x2fca78(0x1d2)][_0x2fca78(0x1fc)]+=_0x41fb15,this[_0x2fca78(0x1f9)]('log',{'type':_0x2fca78(0x1f7),'message':_0x2fca78(0x1ae)+(_0x41fb15>0x0?_0x2fca78(0x1ec):_0x2fca78(0x1a4))+'\x20$'+_0x41fb15['toFixed'](0x2)+_0x2fca78(0x1dd)+(_0x41fb15>0x0?this[_0x2fca78(0x1c1)]:-this[_0x2fca78(0x1d9)])});}[_0x275bdf(0x198)](_0x2ba891){const _0x48d2c5=_0x275bdf;return this[_0x48d2c5(0x1a0)][_0x48d2c5(0x1c6)](_0x2ba891)||[];}['getStats'](){return this['stats'];}[_0x275bdf(0x1f1)](_0x1d98b9){const _0x6e6981=_0x275bdf;this['barHistory'][_0x6e6981(0x1f8)](_0x1d98b9,[]),this['priceBuffer']['set'](_0x1d98b9,[]),this[_0x6e6981(0x1bf)][_0x6e6981(0x1f8)](_0x1d98b9,[]),this[_0x6e6981(0x1d0)]['set'](_0x1d98b9,[]),this['kalmanStates']['set'](_0x1d98b9,{'estimate':0x0,'errorCovariance':0x1}),this[_0x6e6981(0x1f9)](_0x6e6981(0x1b0),{'type':_0x6e6981(0x1fb),'message':_0x6e6981(0x1c2)+_0x1d98b9});}}function _0xa6d2(){const _0x4e9718=['symbol','round','shift','priceBuffer','kalmanStates','atrHistory','now','stats','5CcVNKv','18iDmliM','length','composite','zscoreExitThreshold','slice','lossStreak','getStats','abs','processTick',',\x20streak:\x20','zscoreThreshold','getModelValues','reduce','recentTrades','close','_calculateATR','toFixed','3181592FrfQqz','short','kalman','min','%,\x20cf=','baseStopTicks','generateSignal','WIN','minHoldTimeMs','_computeOrderFlowImbalance','baseTargetTicks','\x20Regime:','reset','_detectVolatilityRegime','exports','11dKOmXe','high','tickSize','debug','set','emit','195882uiVDca','info','pnl','_computeZScore','signals','kalmanMeasurementNoise','1UPHnHB','max','strategy','getBarHistory','signal','normal','lastSignalTime','_generateSignal','split','vpin','STRONG','barHistory','%\x20OFI:','initialize','low','LOSS','ofi','stopMultiplier','recordTradeResult','filter','volatility','kalmanProcessNoise','shouldExitByZScore','\x20|\x20Z:','minConfidence','[HQX]\x20Trade\x20result:\x20','BID','log','tickValue','pow','getAnalysisState','push','weights','volume','open','events','processBar','trades','7114542uHXgvK','onTick','6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)','breakevenTicks','volumeBuffer','13662610fDllqS','winStreak','[HQX-UltraScalping]\x20Reset\x20state\x20for\x20','ofiLookback','_computeKyleLambda','2831444QVPgou','get','profitLockPct','3878686jPBuHj','758502LIyzZV','long'];_0xa6d2=function(){return _0x4e9718;};return _0xa6d2();}class UltraScalpingStrategy extends EventEmitter{constructor(_0x56aefd={}){const _0x5481b7=_0x275bdf;super(),this['config']=_0x56aefd,this['strategy']=new HQXUltraScalping(_0x56aefd),this[_0x5481b7(0x197)]['on'](_0x5481b7(0x199),_0x46d639=>this['emit'](_0x5481b7(0x199),_0x46d639)),this[_0x5481b7(0x197)]['on']('log',_0x142be6=>this['emit']('log',_0x142be6));}[_0x275bdf(0x1dc)](_0x18d014){const _0x486b23=_0x275bdf;return this[_0x486b23(0x197)][_0x486b23(0x1dc)](_0x18d014);}['onTick'](_0x46ca3a){return this['strategy']['onTick'](_0x46ca3a);}['onTrade'](_0x3e3fe9){return this['strategy']['onTrade'](_0x3e3fe9);}['processBar'](_0x2ef801,_0x56e216){const _0x4f3e9d=_0x275bdf;return this['strategy'][_0x4f3e9d(0x1b9)](_0x2ef801,_0x56e216);}[_0x275bdf(0x1a2)](_0x41399e,_0x4b72c2,_0x5836f0){const _0x5023ee=_0x275bdf;return this['strategy'][_0x5023ee(0x1a2)](_0x41399e,_0x4b72c2,_0x5836f0);}['getAnalysisState'](_0x122857,_0x264f13){const _0x511b37=_0x275bdf;return this[_0x511b37(0x197)][_0x511b37(0x1b3)](_0x122857,_0x264f13);}[_0x275bdf(0x1a7)](_0x3a8798){const _0x415e87=_0x275bdf;return this['strategy'][_0x415e87(0x1a7)](_0x3a8798);}['reset'](_0x55d5bc){const _0x57f4db=_0x275bdf;return this['strategy'][_0x57f4db(0x1f1)](_0x55d5bc);}[_0x275bdf(0x1da)](){return this['strategy']['getStats']();}['getBarHistory'](_0x1f443a){return this['strategy']['getBarHistory'](_0x1f443a);}['getModelValues'](_0x13b908){const _0x93d1ba=_0x275bdf;return this[_0x93d1ba(0x197)]['getModelValues'](_0x13b908);}['shouldExitByZScore'](_0x4f3d0c){const _0x820e1f=_0x275bdf;return this['strategy'][_0x820e1f(0x1ab)](_0x4f3d0c);}[_0x275bdf(0x1eb)](_0x5e075e){return null;}}module[_0x275bdf(0x1f3)]={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};