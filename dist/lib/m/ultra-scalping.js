const _0x2023a7=_0x41d2;(function(_0xe58ba7,_0x259ef7){const _0x25cf42=_0x41d2,_0x57ee1f=_0xe58ba7();while(!![]){try{const _0x416926=-parseInt(_0x25cf42(0x12d))/0x1+-parseInt(_0x25cf42(0x138))/0x2+-parseInt(_0x25cf42(0xe7))/0x3*(-parseInt(_0x25cf42(0x150))/0x4)+parseInt(_0x25cf42(0x144))/0x5+parseInt(_0x25cf42(0x132))/0x6*(-parseInt(_0x25cf42(0x125))/0x7)+-parseInt(_0x25cf42(0x111))/0x8+-parseInt(_0x25cf42(0x131))/0x9*(-parseInt(_0x25cf42(0x12b))/0xa);if(_0x416926===_0x259ef7)break;else _0x57ee1f['push'](_0x57ee1f['shift']());}catch(_0x16eb56){_0x57ee1f['push'](_0x57ee1f['shift']());}}}(_0x2bdc,0x5bd86));const EventEmitter=require(_0x2023a7(0x10f)),{v4:uuidv4}=require('uuid'),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};class HQXUltraScalping extends EventEmitter{constructor(_0x3b427a={}){const _0x20a631=_0x2023a7;super(),this['tickSize']=_0x3b427a['tickSize']||0.25,this[_0x20a631(0x129)]=_0x3b427a[_0x20a631(0x129)]||0x5,this[_0x20a631(0x102)]=1.5,this['zscoreExitThreshold']=0.5,this['vpinWindow']=0x32,this['vpinToxicThreshold']=0.7,this[_0x20a631(0x121)]=0.01,this['kalmanMeasurementNoise']=0.1,this[_0x20a631(0xe5)]=0x64,this[_0x20a631(0x14d)]=0x14,this['baseStopTicks']=0x8,this['baseTargetTicks']=0x10,this['breakevenTicks']=0x4,this[_0x20a631(0x13c)]=0.5,this[_0x20a631(0x120)]=0.55,this[_0x20a631(0x127)]={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this[_0x20a631(0xfe)]=new Map(),this[_0x20a631(0x115)]=new Map(),this['volumeBuffer']=new Map(),this['kalmanStates']=new Map(),this['atrHistory']=new Map(),this[_0x20a631(0x105)]=[],this[_0x20a631(0x13e)]=0x0,this['lossStreak']=0x0,this[_0x20a631(0xe3)]=0x0,this['cooldownMs']=0x7530,this[_0x20a631(0xe6)]=0x2710,this['stats']={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}['initialize'](_0x18a03d,_0x1da83b=0.25,_0x41c908=0x5){const _0x56a49b=_0x2023a7;this[_0x56a49b(0x124)]=_0x1da83b,this[_0x56a49b(0x129)]=_0x41c908,this[_0x56a49b(0xfe)]['set'](_0x18a03d,[]),this[_0x56a49b(0x115)][_0x56a49b(0x126)](_0x18a03d,[]),this['volumeBuffer']['set'](_0x18a03d,[]),this['atrHistory'][_0x56a49b(0x126)](_0x18a03d,[]),this[_0x56a49b(0x10e)][_0x56a49b(0x126)](_0x18a03d,{'estimate':0x0,'errorCovariance':0x1}),this[_0x56a49b(0xea)](_0x56a49b(0x147),{'type':_0x56a49b(0x128),'message':'[HQX-UltraScalping]\x20Initialized\x20for\x20'+_0x18a03d+_0x56a49b(0x10a)+_0x1da83b+_0x56a49b(0xfd)+_0x41c908}),this['emit']('log',{'type':_0x56a49b(0x128),'message':'[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)'});}[_0x2023a7(0xe4)](_0x3f133a){const _0x5de93b=_0x2023a7,{contractId:_0x3e303f,price:_0x344888,volume:_0x39befb,side:_0x14f1b6,timestamp:_0x405942}=_0x3f133a,_0x30ec10={'timestamp':_0x405942||Date[_0x5de93b(0x156)](),'open':_0x344888,'high':_0x344888,'low':_0x344888,'close':_0x344888,'volume':_0x39befb||0x1};return this['processBar'](_0x3e303f,_0x30ec10);}['onTick'](_0x27e1fa){return this['processTick'](_0x27e1fa);}['onTrade'](_0x4d60d6){const _0x37ea35=_0x2023a7;return this[_0x37ea35(0xe4)]({'contractId':_0x4d60d6[_0x37ea35(0x13a)]||_0x4d60d6['symbol'],'price':_0x4d60d6[_0x37ea35(0x13d)],'volume':_0x4d60d6['size']||_0x4d60d6['volume']||0x1,'side':_0x4d60d6['side'],'timestamp':_0x4d60d6[_0x37ea35(0x113)]||Date['now']()});}['processBar'](_0x571956,_0xa5b7a3){const _0x2df866=_0x2023a7;let _0x527b8d=this[_0x2df866(0xfe)][_0x2df866(0xf0)](_0x571956);!_0x527b8d&&(this[_0x2df866(0xf2)](_0x571956),_0x527b8d=this[_0x2df866(0xfe)]['get'](_0x571956));_0x527b8d[_0x2df866(0x140)](_0xa5b7a3);if(_0x527b8d['length']>0x1f4)_0x527b8d['shift']();const _0x122fde=this[_0x2df866(0x115)]['get'](_0x571956);_0x122fde[_0x2df866(0x140)](_0xa5b7a3['close']);if(_0x122fde[_0x2df866(0x110)]>0xc8)_0x122fde[_0x2df866(0x10b)]();const _0xeda77c=this[_0x2df866(0xec)][_0x2df866(0xf0)](_0x571956),_0x46a912=_0xa5b7a3[_0x2df866(0x14c)]-_0xa5b7a3[_0x2df866(0x12a)];let _0x3ace07=_0xa5b7a3[_0x2df866(0x157)]*0.5,_0x2767fd=_0xa5b7a3[_0x2df866(0x157)]*0.5;if(_0x46a912>0x0){const _0x42c1e4=(_0xa5b7a3['close']-_0xa5b7a3[_0x2df866(0x12a)])/_0x46a912;_0x3ace07=_0xa5b7a3[_0x2df866(0x157)]*_0x42c1e4,_0x2767fd=_0xa5b7a3[_0x2df866(0x157)]*(0x1-_0x42c1e4);}_0xeda77c[_0x2df866(0x140)]({'buy':_0x3ace07,'sell':_0x2767fd});if(_0xeda77c['length']>0x64)_0xeda77c[_0x2df866(0x10b)]();if(_0x527b8d[_0x2df866(0x110)]<0x32)return null;const _0x22aff5=this['_computeZScore'](_0x122fde),_0x5a89c6=this[_0x2df866(0x155)](_0xeda77c),_0x5408bd=this['_computeKyleLambda'](_0x527b8d),_0x2a4a7f=this['_applyKalmanFilter'](_0x571956,_0xa5b7a3['close']),{regime:_0x413d16,params:_0x59c837}=this[_0x2df866(0x142)](_0x571956,_0x527b8d),_0x424377=this['_computeOrderFlowImbalance'](_0x527b8d);return this[_0x2df866(0xee)](_0x571956,_0xa5b7a3['close'],_0x22aff5,_0x5a89c6,_0x5408bd,_0x2a4a7f,_0x413d16,_0x59c837,_0x424377,_0x527b8d);}['_computeZScore'](_0x3594f9,_0x1987c2=0x32){const _0x595351=_0x2023a7;if(_0x3594f9['length']<_0x1987c2)return 0x0;const _0x57c16b=_0x3594f9[_0x595351(0xfa)](-_0x1987c2),_0x13ead0=_0x57c16b[_0x595351(0x10c)]((_0x504c6f,_0x4ea2dc)=>_0x504c6f+_0x4ea2dc,0x0)/_0x1987c2,_0x1e9866=_0x57c16b['reduce']((_0x54947a,_0x2e0032)=>_0x54947a+Math[_0x595351(0x12c)](_0x2e0032-_0x13ead0,0x2),0x0)/_0x1987c2,_0x21f5db=Math['sqrt'](_0x1e9866);if(_0x21f5db<0.0001)return 0x0;const _0x11a339=_0x3594f9[_0x3594f9[_0x595351(0x110)]-0x1];return(_0x11a339-_0x13ead0)/_0x21f5db;}['_computeVPIN'](_0x54ce35){const _0x24f0b3=_0x2023a7;if(_0x54ce35['length']<this['vpinWindow'])return 0.5;const _0x3a0cbb=_0x54ce35[_0x24f0b3(0xfa)](-this[_0x24f0b3(0xf1)]);let _0x477d71=0x0,_0x58b0c5=0x0;for(const _0x4904d6 of _0x3a0cbb){_0x477d71+=_0x4904d6[_0x24f0b3(0x13b)],_0x58b0c5+=_0x4904d6['sell'];}const _0x323518=_0x477d71+_0x58b0c5;if(_0x323518<0x1)return 0.5;return Math[_0x24f0b3(0xf9)](_0x477d71-_0x58b0c5)/_0x323518;}['_computeKyleLambda'](_0x32b91e){const _0x4fcb29=_0x2023a7;if(_0x32b91e[_0x4fcb29(0x110)]<0x14)return 0x0;const _0x4725fd=_0x32b91e['slice'](-0x14),_0x13f172=[],_0x349eb8=[];for(let _0x236424=0x1;_0x236424<_0x4725fd[_0x4fcb29(0x110)];_0x236424++){_0x13f172['push'](_0x4725fd[_0x236424][_0x4fcb29(0x11f)]-_0x4725fd[_0x236424-0x1]['close']),_0x349eb8[_0x4fcb29(0x140)](_0x4725fd[_0x236424]['volume']);}const _0x8f81df=_0x13f172['reduce']((_0x12ef9f,_0x3daef1)=>_0x12ef9f+_0x3daef1,0x0)/_0x13f172['length'],_0x31063e=_0x349eb8['reduce']((_0x47659b,_0x44048f)=>_0x47659b+_0x44048f,0x0)/_0x349eb8['length'];let _0x17bba6=0x0,_0x4864f7=0x0;for(let _0x198f64=0x0;_0x198f64<_0x13f172['length'];_0x198f64++){_0x17bba6+=(_0x13f172[_0x198f64]-_0x8f81df)*(_0x349eb8[_0x198f64]-_0x31063e),_0x4864f7+=Math[_0x4fcb29(0x12c)](_0x349eb8[_0x198f64]-_0x31063e,0x2);}_0x17bba6/=_0x13f172['length'],_0x4864f7/=_0x13f172['length'];if(_0x4864f7<0.0001)return 0x0;return Math['abs'](_0x17bba6/_0x4864f7);}[_0x2023a7(0x107)](_0xb60e1b,_0xda3591){const _0x9197d9=_0x2023a7;let _0x53d719=this[_0x9197d9(0x10e)][_0x9197d9(0xf0)](_0xb60e1b);if(!_0x53d719)return _0x53d719={'estimate':_0xda3591,'errorCovariance':0x1},this[_0x9197d9(0x10e)][_0x9197d9(0x126)](_0xb60e1b,_0x53d719),_0xda3591;const _0x2c6290=_0x53d719[_0x9197d9(0x136)],_0x243402=_0x53d719['errorCovariance']+this['kalmanProcessNoise'],_0x19b234=_0x243402/(_0x243402+this[_0x9197d9(0x14f)]),_0x5bd76f=_0x2c6290+_0x19b234*(_0xda3591-_0x2c6290),_0xa004b7=(0x1-_0x19b234)*_0x243402;return _0x53d719[_0x9197d9(0x136)]=_0x5bd76f,_0x53d719['errorCovariance']=_0xa004b7,_0x5bd76f;}['_detectVolatilityRegime'](_0x2b638a,_0x1f48bd){const _0x4817fd=_0x2023a7,_0x513335=this[_0x4817fd(0x119)](_0x1f48bd),_0x34d306=_0x513335/this['tickSize'];let _0x479683=this[_0x4817fd(0xf3)]['get'](_0x2b638a);!_0x479683&&(_0x479683=[],this[_0x4817fd(0xf3)][_0x4817fd(0x126)](_0x2b638a,_0x479683));_0x479683['push'](_0x513335);if(_0x479683[_0x4817fd(0x110)]>0x1f4)_0x479683[_0x4817fd(0x10b)]();let _0x1cce76=0.5;_0x479683['length']>=0x14&&(_0x1cce76=_0x479683['filter'](_0x3a3f72=>_0x3a3f72<=_0x513335)['length']/_0x479683[_0x4817fd(0x110)]);let _0x53ce01,_0x12e374;if(_0x1cce76<0.25)_0x53ce01='low',_0x12e374={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x1cce76<0.75?(_0x53ce01='normal',_0x12e374={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0x53ce01='high',_0x12e374={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0x53ce01,'params':_0x12e374};}['_calculateATR'](_0x513292,_0xb442dd=0xe){const _0x4a7779=_0x2023a7;if(_0x513292['length']<_0xb442dd+0x1)return 2.5;const _0x2a02fb=[];for(let _0x572d11=_0x513292[_0x4a7779(0x110)]-_0xb442dd;_0x572d11<_0x513292[_0x4a7779(0x110)];_0x572d11++){const _0x1acc7d=_0x513292[_0x572d11],_0x4f0707=_0x513292[_0x572d11-0x1][_0x4a7779(0x11f)],_0x52051a=Math[_0x4a7779(0x106)](_0x1acc7d['high']-_0x1acc7d['low'],Math[_0x4a7779(0xf9)](_0x1acc7d[_0x4a7779(0x14c)]-_0x4f0707),Math[_0x4a7779(0xf9)](_0x1acc7d['low']-_0x4f0707));_0x2a02fb['push'](_0x52051a);}return _0x2a02fb[_0x4a7779(0x10c)]((_0x5b377f,_0x580a4e)=>_0x5b377f+_0x580a4e,0x0)/_0x2a02fb['length'];}[_0x2023a7(0x158)](_0x4bb32b){const _0x1ee37b=_0x2023a7;if(_0x4bb32b['length']<this['ofiLookback'])return 0x0;const _0x1b396c=_0x4bb32b[_0x1ee37b(0xfa)](-this[_0x1ee37b(0x14d)]);let _0x30305d=0x0,_0x272570=0x0;for(const _0x3df72b of _0x1b396c){const _0x57fbe7=_0x3df72b['high']-_0x3df72b[_0x1ee37b(0x12a)];if(_0x57fbe7>0x0){const _0x296e40=(_0x3df72b[_0x1ee37b(0x11f)]-_0x3df72b[_0x1ee37b(0x12a)])/_0x57fbe7;_0x30305d+=_0x296e40*_0x3df72b[_0x1ee37b(0x157)],_0x272570+=(0x1-_0x296e40)*_0x3df72b['volume'];}}const _0x176b28=_0x30305d+_0x272570;if(_0x176b28<0x1)return 0x0;return(_0x30305d-_0x272570)/_0x176b28;}['_generateSignal'](_0x4fb3e9,_0x220cf5,_0x1e6ccf,_0x2bbeb5,_0x2b682d,_0x47bba5,_0x509952,_0x1249e1,_0x266d29,_0x11237c){const _0x2d195d=_0x2023a7,_0x18789e=Math[_0x2d195d(0xf9)](_0x1e6ccf);if(_0x18789e<_0x1249e1[_0x2d195d(0x14a)])return null;if(_0x2bbeb5>this[_0x2d195d(0xe9)])return null;let _0x22d619;if(_0x1e6ccf<-_0x1249e1[_0x2d195d(0x14a)])_0x22d619=_0x2d195d(0x139);else{if(_0x1e6ccf>_0x1249e1['zscoreThreshold'])_0x22d619=_0x2d195d(0x101);else return null;}const _0x5c3459=_0x22d619===_0x2d195d(0x139)&&_0x266d29>0.1||_0x22d619==='short'&&_0x266d29<-0.1,_0x571e21=_0x220cf5-_0x47bba5,_0x2ae862=_0x22d619===_0x2d195d(0x139)&&_0x571e21<0x0||_0x22d619==='short'&&_0x571e21>0x0,_0x2d7efd={'zscore':Math['min'](0x1,_0x18789e/0x4),'vpin':0x1-_0x2bbeb5,'kyleLambda':_0x2b682d>0.001?0.5:0.8,'kalman':_0x2ae862?0.8:0.4,'volatility':_0x509952===_0x2d195d(0x11b)?0.8:_0x509952==='low'?0.7:0.6,'ofi':_0x5c3459?0.9:0.5,'composite':0x0};_0x2d7efd[_0x2d195d(0x14e)]=_0x2d7efd['zscore']*this['weights']['zscore']+_0x2d7efd['vpin']*this['weights'][_0x2d195d(0x152)]+_0x2d7efd['kyleLambda']*this[_0x2d195d(0x127)]['kyleLambda']+_0x2d7efd[_0x2d195d(0xf4)]*this[_0x2d195d(0x127)][_0x2d195d(0xf4)]+_0x2d7efd[_0x2d195d(0x145)]*this['weights'][_0x2d195d(0x145)]+_0x2d7efd['ofi']*this[_0x2d195d(0x127)]['ofi'];const _0x27f4fa=Math[_0x2d195d(0x12e)](0x1,_0x2d7efd[_0x2d195d(0x14e)]+_0x1249e1['confidenceBonus']);if(_0x27f4fa<this['minConfidence'])return null;if(Date[_0x2d195d(0x156)]()-this[_0x2d195d(0xe3)]<this[_0x2d195d(0x143)])return null;const _0x10e5ae=Math['round'](this['baseStopTicks']*_0x1249e1['stopMultiplier']),_0x10c48e=Math[_0x2d195d(0xf8)](this['baseTargetTicks']*_0x1249e1[_0x2d195d(0x117)]),_0x3713e8=Math[_0x2d195d(0x106)](0x6,Math[_0x2d195d(0x12e)](0xc,_0x10e5ae)),_0x1c5aec=Math[_0x2d195d(0x106)](_0x3713e8*1.5,Math[_0x2d195d(0x12e)](0x18,_0x10c48e));let _0x59030b,_0x2670c0,_0x1219df,_0x36f57f;_0x22d619===_0x2d195d(0x139)?(_0x59030b=_0x220cf5-_0x3713e8*this['tickSize'],_0x2670c0=_0x220cf5+_0x1c5aec*this[_0x2d195d(0x124)],_0x1219df=_0x220cf5+this[_0x2d195d(0x114)]*this['tickSize'],_0x36f57f=_0x220cf5+_0x1c5aec*this[_0x2d195d(0x13c)]*this['tickSize']):(_0x59030b=_0x220cf5+_0x3713e8*this['tickSize'],_0x2670c0=_0x220cf5-_0x1c5aec*this['tickSize'],_0x1219df=_0x220cf5-this[_0x2d195d(0x114)]*this['tickSize'],_0x36f57f=_0x220cf5-_0x1c5aec*this['profitLockPct']*this['tickSize']);const _0x3452f2=_0x1c5aec/_0x3713e8,_0x4d1e88=Math[_0x2d195d(0xf8)](_0x1c5aec*0.5),_0x5b6191=Math[_0x2d195d(0xf8)](_0x3713e8*0.4);let _0x41df5f=SignalStrength['MODERATE'];if(_0x27f4fa>=0.85)_0x41df5f=SignalStrength[_0x2d195d(0x141)];else{if(_0x27f4fa>=0.75)_0x41df5f=SignalStrength[_0x2d195d(0xe8)];else{if(_0x27f4fa<0.6)_0x41df5f=SignalStrength['WEAK'];}}const _0xb5601=0.5+(_0x27f4fa-0.5)*0.4,_0x1274ea=_0xb5601*Math[_0x2d195d(0xf9)](_0x2670c0-_0x220cf5)-(0x1-_0xb5601)*Math[_0x2d195d(0xf9)](_0x220cf5-_0x59030b);this['lastSignalTime']=Date[_0x2d195d(0x156)](),this['stats'][_0x2d195d(0x146)]++;const _0x5e288c={'id':uuidv4(),'timestamp':Date[_0x2d195d(0x156)](),'symbol':_0x4fb3e9[_0x2d195d(0x153)]('.')[0x0]||_0x4fb3e9,'contractId':_0x4fb3e9,'side':_0x22d619===_0x2d195d(0x139)?OrderSide[_0x2d195d(0x159)]:OrderSide['ASK'],'direction':_0x22d619,'strategy':'HQX_ULTRA_SCALPING_6MODELS','strength':_0x41df5f,'edge':_0x1274ea,'confidence':_0x27f4fa,'entry':_0x220cf5,'entryPrice':_0x220cf5,'stopLoss':_0x59030b,'takeProfit':_0x2670c0,'riskReward':_0x3452f2,'stopTicks':_0x3713e8,'targetTicks':_0x1c5aec,'trailTriggerTicks':_0x4d1e88,'trailDistanceTicks':_0x5b6191,'beBreakeven':_0x1219df,'profitLockLevel':_0x36f57f,'zScore':_0x1e6ccf,'zScoreExit':this[_0x2d195d(0x13f)],'vpinValue':_0x2bbeb5,'kyleLambda':_0x2b682d,'kalmanEstimate':_0x47bba5,'volatilityRegime':_0x509952,'ofiValue':_0x266d29,'models':_0x2d7efd,'orderFlowConfirmed':_0x5c3459,'kalmanConfirmed':_0x2ae862,'expires':Date[_0x2d195d(0x156)]()+0xea60};return this[_0x2d195d(0xea)](_0x2d195d(0x109),{'side':_0x22d619==='long'?_0x2d195d(0x13b):'sell','action':_0x2d195d(0x11d),'reason':'Z='+_0x1e6ccf[_0x2d195d(0x122)](0x2)+_0x2d195d(0x116)+(_0x2bbeb5*0x64)[_0x2d195d(0x122)](0x0)+'%,\x20OFI='+(_0x266d29*0x64)['toFixed'](0x0)+_0x2d195d(0x135)+(_0x27f4fa*0x64)[_0x2d195d(0x122)](0x0)+'%',..._0x5e288c}),this[_0x2d195d(0xea)]('log',{'type':_0x2d195d(0x128),'message':'[HQX]\x20SIGNAL:\x20'+_0x22d619[_0x2d195d(0x100)]()+_0x2d195d(0x103)+_0x220cf5['toFixed'](0x2)+_0x2d195d(0x134)+_0x1e6ccf[_0x2d195d(0x122)](0x2)+_0x2d195d(0xef)+(_0x2bbeb5*0x64)[_0x2d195d(0x122)](0x0)+'%\x20OFI:'+(_0x266d29*0x64)[_0x2d195d(0x122)](0x0)+'%\x20Kyle:'+_0x2b682d['toFixed'](0x5)+_0x2d195d(0xf5)+_0x509952+'\x20|\x20Conf:'+(_0x27f4fa*0x64)[_0x2d195d(0x122)](0x0)+'%'}),_0x5e288c;}['shouldExitByZScore'](_0x467e1c){const _0x2f512b=_0x2023a7,_0xd7b508=this['priceBuffer']['get'](_0x467e1c);if(!_0xd7b508||_0xd7b508['length']<0x32)return![];const _0x31187d=this['_computeZScore'](_0xd7b508);return Math[_0x2f512b(0xf9)](_0x31187d)<this[_0x2f512b(0x13f)];}[_0x2023a7(0x137)](_0x26d0f0){const _0x57597c=_0x2023a7,_0x5b7349=this[_0x57597c(0x115)]['get'](_0x26d0f0),_0x4df43c=this[_0x57597c(0xec)][_0x57597c(0xf0)](_0x26d0f0),_0x177c00=this['barHistory']['get'](_0x26d0f0);if(!_0x5b7349||!_0x4df43c||!_0x177c00||_0x177c00[_0x57597c(0x110)]<0x32)return null;const _0x78496f=this['_computeZScore'](_0x5b7349),_0xc6f03=this[_0x57597c(0x155)](_0x4df43c),_0x2b2f40=this['_computeKyleLambda'](_0x177c00),_0x113dfb=this['_computeOrderFlowImbalance'](_0x177c00);return{'zscore':Math['min'](0x1,Math[_0x57597c(0xf9)](_0x78496f)/0x4),'vpin':0x1-_0xc6f03,'kyleLambda':_0x2b2f40>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math['abs'](_0x113dfb)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x78496f,'vpin':_0xc6f03,'kyleLambda':_0x2b2f40,'ofi':_0x113dfb}};}[_0x2023a7(0x154)](_0x2f0855,_0x1a7ead){const _0x17090b=_0x2023a7,_0x191da4=this[_0x17090b(0xfe)]['get'](_0x2f0855)||[];if(_0x191da4['length']<0x32)return{'ready':![],'message':_0x17090b(0x118)+_0x191da4[_0x17090b(0x110)]+_0x17090b(0xfc)};const _0x4fb90f=this[_0x17090b(0x115)][_0x17090b(0xf0)](_0x2f0855)||[],_0x467441=this['volumeBuffer']['get'](_0x2f0855)||[],_0x319965=this[_0x17090b(0x123)](_0x4fb90f),_0x561a96=this[_0x17090b(0x155)](_0x467441),_0x11f4d7=this['_computeOrderFlowImbalance'](_0x191da4),_0x54d4f2=this['_computeKyleLambda'](_0x191da4),{regime:_0xa1f46b,params:_0x177a6a}=this['_detectVolatilityRegime'](_0x2f0855,_0x191da4);return{'ready':!![],'zScore':_0x319965,'vpin':_0x561a96,'ofi':_0x11f4d7,'kyleLambda':_0x54d4f2,'regime':_0xa1f46b,'stopTicks':Math['round'](this[_0x17090b(0xeb)]*_0x177a6a['stopMultiplier']),'targetTicks':Math['round'](this[_0x17090b(0xf7)]*_0x177a6a[_0x17090b(0x117)]),'threshold':_0x177a6a['zscoreThreshold'],'barsProcessed':_0x191da4['length'],'models':'6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)'};}[_0x2023a7(0x149)](_0x43cdea){const _0x5ef64f=_0x2023a7;this[_0x5ef64f(0x105)]['push']({'netPnl':_0x43cdea,'timestamp':Date['now']()});if(this[_0x5ef64f(0x105)]['length']>0x64)this['recentTrades'][_0x5ef64f(0x10b)]();_0x43cdea>0x0?(this[_0x5ef64f(0x13e)]++,this[_0x5ef64f(0x148)]=0x0,this[_0x5ef64f(0xff)][_0x5ef64f(0x10d)]++):(this[_0x5ef64f(0x148)]++,this['winStreak']=0x0,this[_0x5ef64f(0xff)][_0x5ef64f(0x130)]++),this[_0x5ef64f(0xff)][_0x5ef64f(0x112)]++,this[_0x5ef64f(0xff)][_0x5ef64f(0xed)]+=_0x43cdea,this['emit']('log',{'type':_0x5ef64f(0x14b),'message':'[HQX]\x20Trade\x20result:\x20'+(_0x43cdea>0x0?_0x5ef64f(0x11a):'LOSS')+'\x20$'+_0x43cdea[_0x5ef64f(0x122)](0x2)+_0x5ef64f(0x11c)+(_0x43cdea>0x0?this['winStreak']:-this[_0x5ef64f(0x148)])});}['getBarHistory'](_0x5dc5c1){const _0x2732db=_0x2023a7;return this[_0x2732db(0xfe)]['get'](_0x5dc5c1)||[];}['getStats'](){const _0x32cc1d=_0x2023a7;return this[_0x32cc1d(0xff)];}['reset'](_0x24ac37){const _0x5724c6=_0x2023a7;this[_0x5724c6(0xfe)]['set'](_0x24ac37,[]),this[_0x5724c6(0x115)][_0x5724c6(0x126)](_0x24ac37,[]),this['volumeBuffer'][_0x5724c6(0x126)](_0x24ac37,[]),this['atrHistory'][_0x5724c6(0x126)](_0x24ac37,[]),this[_0x5724c6(0x10e)][_0x5724c6(0x126)](_0x24ac37,{'estimate':0x0,'errorCovariance':0x1}),this['emit']('log',{'type':'info','message':'[HQX-UltraScalping]\x20Reset\x20state\x20for\x20'+_0x24ac37});}}function _0x41d2(_0x4e3bf3,_0x54ae4b){_0x4e3bf3=_0x4e3bf3-0xe3;const _0x2bdca3=_0x2bdc();let _0x41d2c8=_0x2bdca3[_0x4e3bf3];return _0x41d2c8;}class UltraScalpingStrategy extends EventEmitter{constructor(_0x2ab4f8={}){const _0x47e567=_0x2023a7;super(),this['config']=_0x2ab4f8,this['strategy']=new HQXUltraScalping(_0x2ab4f8),this[_0x47e567(0x11e)]['on'](_0x47e567(0x109),_0x48c2b3=>this['emit'](_0x47e567(0x109),_0x48c2b3)),this['strategy']['on'](_0x47e567(0x147),_0x46b484=>this['emit'](_0x47e567(0x147),_0x46b484));}['processTick'](_0x3e479e){const _0x58cb92=_0x2023a7;return this[_0x58cb92(0x11e)][_0x58cb92(0xe4)](_0x3e479e);}['onTick'](_0x2f555f){const _0x35af9a=_0x2023a7;return this['strategy'][_0x35af9a(0x12f)](_0x2f555f);}['onTrade'](_0x376a4a){const _0x2e2a24=_0x2023a7;return this['strategy'][_0x2e2a24(0xfb)](_0x376a4a);}['processBar'](_0x22066c,_0x543350){const _0x428d8e=_0x2023a7;return this[_0x428d8e(0x11e)][_0x428d8e(0x151)](_0x22066c,_0x543350);}['initialize'](_0x13e7d7,_0x46cda3,_0x5cec6e){return this['strategy']['initialize'](_0x13e7d7,_0x46cda3,_0x5cec6e);}['getAnalysisState'](_0x490eae,_0x1afc25){const _0x45b1d9=_0x2023a7;return this[_0x45b1d9(0x11e)][_0x45b1d9(0x154)](_0x490eae,_0x1afc25);}[_0x2023a7(0x149)](_0x5bec52){return this['strategy']['recordTradeResult'](_0x5bec52);}['reset'](_0x114e79){const _0x348766=_0x2023a7;return this['strategy'][_0x348766(0x133)](_0x114e79);}['getStats'](){const _0xbee9fa=_0x2023a7;return this[_0xbee9fa(0x11e)][_0xbee9fa(0x104)]();}['getBarHistory'](_0x3d707){const _0x4abef7=_0x2023a7;return this['strategy'][_0x4abef7(0xf6)](_0x3d707);}[_0x2023a7(0x137)](_0x5abeab){const _0x4a9ebf=_0x2023a7;return this['strategy'][_0x4a9ebf(0x137)](_0x5abeab);}[_0x2023a7(0x108)](_0x3cda40){const _0x2d1cc8=_0x2023a7;return this[_0x2d1cc8(0x11e)][_0x2d1cc8(0x108)](_0x3cda40);}['generateSignal'](_0x2383b9){return null;}}module['exports']={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};function _0x2bdc(){const _0x3417c4=['volatilityLookback','minHoldTimeMs','711tIExVh','STRONG','vpinToxicThreshold','emit','baseStopTicks','volumeBuffer','pnl','_generateSignal','\x20VPIN:','get','vpinWindow','initialize','atrHistory','kalman','\x20Regime:','getBarHistory','baseTargetTicks','round','abs','slice','onTrade','/50\x20bars',',\x20value=','barHistory','stats','toUpperCase','short','zscoreEntryThreshold','\x20@\x20','getStats','recentTrades','max','_applyKalmanFilter','shouldExitByZScore','signal',':\x20tick=','shift','reduce','wins','kalmanStates','events','length','355624SKrifv','trades','timestamp','breakevenTicks','priceBuffer',',\x20VPIN=','targetMultiplier','Collecting\x20data...\x20','_calculateATR','WIN','normal',',\x20streak:\x20','open','strategy','close','minConfidence','kalmanProcessNoise','toFixed','_computeZScore','tickSize','819FnLiWe','set','weights','info','tickValue','low','329230hMpPZm','pow','131875ZFWxEm','min','onTick','losses','90pUOBeK','5154WkNrmG','reset','\x20|\x20Z:','%,\x20cf=','estimate','getModelValues','947906AFLwKx','long','contractId','buy','profitLockPct','price','winStreak','zscoreExitThreshold','push','VERY_STRONG','_detectVolatilityRegime','cooldownMs','465755ICaoUP','volatility','signals','log','lossStreak','recordTradeResult','zscoreThreshold','debug','high','ofiLookback','composite','kalmanMeasurementNoise','11892lLuCUM','processBar','vpin','split','getAnalysisState','_computeVPIN','now','volume','_computeOrderFlowImbalance','BID','lastSignalTime','processTick'];_0x2bdc=function(){return _0x3417c4;};return _0x2bdc();}