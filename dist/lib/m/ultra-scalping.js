const _0x3f38f4=_0x30a6;(function(_0x3c3e69,_0x1223f4){const _0x5e8f56=_0x30a6,_0xb5f6d7=_0x3c3e69();while(!![]){try{const _0x303347=-parseInt(_0x5e8f56(0x127))/0x1*(parseInt(_0x5e8f56(0x104))/0x2)+-parseInt(_0x5e8f56(0x113))/0x3+parseInt(_0x5e8f56(0x14b))/0x4+-parseInt(_0x5e8f56(0x126))/0x5+parseInt(_0x5e8f56(0xfa))/0x6+-parseInt(_0x5e8f56(0x139))/0x7*(-parseInt(_0x5e8f56(0x155))/0x8)+parseInt(_0x5e8f56(0x144))/0x9*(-parseInt(_0x5e8f56(0x159))/0xa);if(_0x303347===_0x1223f4)break;else _0xb5f6d7['push'](_0xb5f6d7['shift']());}catch(_0x5e1db9){_0xb5f6d7['push'](_0xb5f6d7['shift']());}}}(_0x492e,0xf0c16));const EventEmitter=require(_0x3f38f4(0x117)),{v4:uuidv4}=require('uuid'),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};class HQXUltraScalping extends EventEmitter{constructor(_0x3c54c6={}){const _0x5be687=_0x3f38f4;super(),this[_0x5be687(0x132)]=_0x3c54c6[_0x5be687(0x132)]||0.25,this['tickValue']=_0x3c54c6[_0x5be687(0xff)]||0x5,this[_0x5be687(0x10e)]=1.5,this[_0x5be687(0x135)]=0.5,this['vpinWindow']=0x32,this[_0x5be687(0x152)]=0.7,this[_0x5be687(0x14d)]=0.01,this['kalmanMeasurementNoise']=0.1,this[_0x5be687(0x140)]=0x64,this['ofiLookback']=0x14,this['baseStopTicks']=0x8,this[_0x5be687(0x120)]=0x10,this['breakevenTicks']=0x4,this['profitLockPct']=0.5,this['minConfidence']=0.55,this[_0x5be687(0x10a)]={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this[_0x5be687(0xfb)]=new Map(),this['priceBuffer']=new Map(),this['volumeBuffer']=new Map(),this['kalmanStates']=new Map(),this[_0x5be687(0x146)]=new Map(),this['recentTrades']=[],this[_0x5be687(0x142)]=0x0,this[_0x5be687(0x122)]=0x0,this[_0x5be687(0x145)]=0x0,this[_0x5be687(0x108)]=0x7530,this[_0x5be687(0x158)]=0x2710,this['stats']={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}[_0x3f38f4(0x136)](_0x464eb7,_0x5a9dff=0.25,_0x2fc97c=0x5){const _0x564b59=_0x3f38f4;this[_0x564b59(0x132)]=_0x5a9dff,this['tickValue']=_0x2fc97c,this['barHistory']['set'](_0x464eb7,[]),this[_0x564b59(0x11c)]['set'](_0x464eb7,[]),this[_0x564b59(0x125)][_0x564b59(0x11e)](_0x464eb7,[]),this['atrHistory'][_0x564b59(0x11e)](_0x464eb7,[]),this[_0x564b59(0x134)]['set'](_0x464eb7,{'estimate':0x0,'errorCovariance':0x1}),this['emit']('log',{'type':_0x564b59(0x13e),'message':'[HQX-UltraScalping]\x20Initialized\x20for\x20'+_0x464eb7+_0x564b59(0x11a)+_0x5a9dff+',\x20value='+_0x2fc97c}),this['emit'](_0x564b59(0x12f),{'type':'info','message':'[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)'});}['processTick'](_0x2d5017){const {contractId:_0x28f845,price:_0x88f637,volume:_0x7efaf6,side:_0x391eaf,timestamp:_0x3a6445}=_0x2d5017,_0x5e6b0b={'timestamp':_0x3a6445||Date['now'](),'open':_0x88f637,'high':_0x88f637,'low':_0x88f637,'close':_0x88f637,'volume':_0x7efaf6||0x1};return this['processBar'](_0x28f845,_0x5e6b0b);}[_0x3f38f4(0x105)](_0xa459d5){const _0x322b9e=_0x3f38f4;return this[_0x322b9e(0x130)](_0xa459d5);}['onTrade'](_0x5cf3bf){const _0xd0316b=_0x3f38f4;return this['processTick']({'contractId':_0x5cf3bf['contractId']||_0x5cf3bf['symbol'],'price':_0x5cf3bf['price'],'volume':_0x5cf3bf['size']||_0x5cf3bf['volume']||0x1,'side':_0x5cf3bf['side'],'timestamp':_0x5cf3bf[_0xd0316b(0x14c)]||Date[_0xd0316b(0x141)]()});}['processBar'](_0x50cd75,_0x58e8e3){const _0x4c230d=_0x3f38f4;let _0x590f41=this[_0x4c230d(0xfb)]['get'](_0x50cd75);!_0x590f41&&(this['initialize'](_0x50cd75),_0x590f41=this[_0x4c230d(0xfb)]['get'](_0x50cd75));_0x590f41[_0x4c230d(0x115)](_0x58e8e3);if(_0x590f41[_0x4c230d(0xf6)]>0x1f4)_0x590f41[_0x4c230d(0x10c)]();const _0x524a2d=this['priceBuffer'][_0x4c230d(0x10d)](_0x50cd75);_0x524a2d[_0x4c230d(0x115)](_0x58e8e3[_0x4c230d(0x150)]);if(_0x524a2d['length']>0xc8)_0x524a2d[_0x4c230d(0x10c)]();const _0xd29926=this['volumeBuffer']['get'](_0x50cd75),_0x55ca76=_0x58e8e3['high']-_0x58e8e3[_0x4c230d(0x13a)];let _0x2823ba=_0x58e8e3['volume']*0.5,_0x3a9aae=_0x58e8e3[_0x4c230d(0x119)]*0.5;if(_0x55ca76>0x0){const _0x362c99=(_0x58e8e3[_0x4c230d(0x150)]-_0x58e8e3[_0x4c230d(0x13a)])/_0x55ca76;_0x2823ba=_0x58e8e3['volume']*_0x362c99,_0x3a9aae=_0x58e8e3['volume']*(0x1-_0x362c99);}_0xd29926['push']({'buy':_0x2823ba,'sell':_0x3a9aae});if(_0xd29926['length']>0x64)_0xd29926[_0x4c230d(0x10c)]();if(_0x590f41[_0x4c230d(0xf6)]<0x32)return null;const _0x1325ba=this['_computeZScore'](_0x524a2d),_0x571dd6=this['_computeVPIN'](_0xd29926),_0x3b2656=this['_computeKyleLambda'](_0x590f41),_0x4756eb=this[_0x4c230d(0x147)](_0x50cd75,_0x58e8e3['close']),{regime:_0x2d97c8,params:_0x2a0174}=this[_0x4c230d(0x11d)](_0x50cd75,_0x590f41),_0x5047bc=this[_0x4c230d(0x13d)](_0x590f41);return this['_generateSignal'](_0x50cd75,_0x58e8e3['close'],_0x1325ba,_0x571dd6,_0x3b2656,_0x4756eb,_0x2d97c8,_0x2a0174,_0x5047bc,_0x590f41);}['_computeZScore'](_0x7deb7,_0x58db7a=0x32){const _0x414084=_0x3f38f4;if(_0x7deb7[_0x414084(0xf6)]<_0x58db7a)return 0x0;const _0x2e1682=_0x7deb7[_0x414084(0xf9)](-_0x58db7a),_0x318644=_0x2e1682[_0x414084(0xfe)]((_0xac1064,_0x2adf11)=>_0xac1064+_0x2adf11,0x0)/_0x58db7a,_0x254ca1=_0x2e1682[_0x414084(0xfe)]((_0x33805b,_0x2ed0d1)=>_0x33805b+Math['pow'](_0x2ed0d1-_0x318644,0x2),0x0)/_0x58db7a,_0x42d35e=Math['sqrt'](_0x254ca1);if(_0x42d35e<0.0001)return 0x0;const _0x88f22d=_0x7deb7[_0x7deb7['length']-0x1];return(_0x88f22d-_0x318644)/_0x42d35e;}[_0x3f38f4(0x157)](_0x211fb8){const _0x2b9432=_0x3f38f4;if(_0x211fb8['length']<this[_0x2b9432(0x137)])return 0.5;const _0x81e4de=_0x211fb8['slice'](-this[_0x2b9432(0x137)]);let _0x270492=0x0,_0x4a3949=0x0;for(const _0x36179f of _0x81e4de){_0x270492+=_0x36179f[_0x2b9432(0x129)],_0x4a3949+=_0x36179f[_0x2b9432(0x138)];}const _0x44a161=_0x270492+_0x4a3949;if(_0x44a161<0x1)return 0.5;return Math[_0x2b9432(0x12c)](_0x270492-_0x4a3949)/_0x44a161;}[_0x3f38f4(0x12e)](_0x2bb288){const _0x21dc46=_0x3f38f4;if(_0x2bb288[_0x21dc46(0xf6)]<0x14)return 0x0;const _0x114e7e=_0x2bb288[_0x21dc46(0xf9)](-0x14),_0x580449=[],_0x4d1abc=[];for(let _0x25a48c=0x1;_0x25a48c<_0x114e7e['length'];_0x25a48c++){_0x580449[_0x21dc46(0x115)](_0x114e7e[_0x25a48c][_0x21dc46(0x150)]-_0x114e7e[_0x25a48c-0x1]['close']),_0x4d1abc['push'](_0x114e7e[_0x25a48c][_0x21dc46(0x119)]);}const _0x1eed1c=_0x580449[_0x21dc46(0xfe)]((_0x551e0b,_0x79e264)=>_0x551e0b+_0x79e264,0x0)/_0x580449[_0x21dc46(0xf6)],_0x5d6f31=_0x4d1abc[_0x21dc46(0xfe)]((_0x19105f,_0x474e55)=>_0x19105f+_0x474e55,0x0)/_0x4d1abc[_0x21dc46(0xf6)];let _0x5bcef2=0x0,_0x52b84d=0x0;for(let _0x21c761=0x0;_0x21c761<_0x580449[_0x21dc46(0xf6)];_0x21c761++){_0x5bcef2+=(_0x580449[_0x21c761]-_0x1eed1c)*(_0x4d1abc[_0x21c761]-_0x5d6f31),_0x52b84d+=Math[_0x21dc46(0x154)](_0x4d1abc[_0x21c761]-_0x5d6f31,0x2);}_0x5bcef2/=_0x580449[_0x21dc46(0xf6)],_0x52b84d/=_0x580449['length'];if(_0x52b84d<0.0001)return 0x0;return Math['abs'](_0x5bcef2/_0x52b84d);}[_0x3f38f4(0x147)](_0xe221fa,_0x8dbb94){const _0x4dc809=_0x3f38f4;let _0x332c4e=this[_0x4dc809(0x134)][_0x4dc809(0x10d)](_0xe221fa);if(!_0x332c4e)return _0x332c4e={'estimate':_0x8dbb94,'errorCovariance':0x1},this[_0x4dc809(0x134)]['set'](_0xe221fa,_0x332c4e),_0x8dbb94;const _0x238ea1=_0x332c4e[_0x4dc809(0x128)],_0x2ce695=_0x332c4e['errorCovariance']+this['kalmanProcessNoise'],_0x1fb9a6=_0x2ce695/(_0x2ce695+this['kalmanMeasurementNoise']),_0x418ab9=_0x238ea1+_0x1fb9a6*(_0x8dbb94-_0x238ea1),_0xce5b9e=(0x1-_0x1fb9a6)*_0x2ce695;return _0x332c4e['estimate']=_0x418ab9,_0x332c4e[_0x4dc809(0x143)]=_0xce5b9e,_0x418ab9;}[_0x3f38f4(0x11d)](_0x26bd7b,_0x1640fe){const _0x34b40f=_0x3f38f4,_0x2726dd=this[_0x34b40f(0xf4)](_0x1640fe),_0x2b9bfe=_0x2726dd/this[_0x34b40f(0x132)];let _0x5b3cb2=this['atrHistory'][_0x34b40f(0x10d)](_0x26bd7b);!_0x5b3cb2&&(_0x5b3cb2=[],this['atrHistory'][_0x34b40f(0x11e)](_0x26bd7b,_0x5b3cb2));_0x5b3cb2[_0x34b40f(0x115)](_0x2726dd);if(_0x5b3cb2['length']>0x1f4)_0x5b3cb2[_0x34b40f(0x10c)]();let _0x4550ab=0.5;_0x5b3cb2[_0x34b40f(0xf6)]>=0x14&&(_0x4550ab=_0x5b3cb2[_0x34b40f(0x14f)](_0x389c46=>_0x389c46<=_0x2726dd)[_0x34b40f(0xf6)]/_0x5b3cb2['length']);let _0x322a81,_0x12da5f;if(_0x4550ab<0.25)_0x322a81='low',_0x12da5f={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x4550ab<0.75?(_0x322a81=_0x34b40f(0x13f),_0x12da5f={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0x322a81=_0x34b40f(0xf3),_0x12da5f={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0x322a81,'params':_0x12da5f};}[_0x3f38f4(0xf4)](_0x18e3e6,_0x4a2b73=0xe){const _0x212453=_0x3f38f4;if(_0x18e3e6[_0x212453(0xf6)]<_0x4a2b73+0x1)return 2.5;const _0x29de65=[];for(let _0x489b71=_0x18e3e6[_0x212453(0xf6)]-_0x4a2b73;_0x489b71<_0x18e3e6[_0x212453(0xf6)];_0x489b71++){const _0x2e0a47=_0x18e3e6[_0x489b71],_0x26dbf2=_0x18e3e6[_0x489b71-0x1]['close'],_0x3a3455=Math['max'](_0x2e0a47[_0x212453(0xf3)]-_0x2e0a47[_0x212453(0x13a)],Math['abs'](_0x2e0a47[_0x212453(0xf3)]-_0x26dbf2),Math['abs'](_0x2e0a47[_0x212453(0x13a)]-_0x26dbf2));_0x29de65['push'](_0x3a3455);}return _0x29de65[_0x212453(0xfe)]((_0xad4b3f,_0x5d77c7)=>_0xad4b3f+_0x5d77c7,0x0)/_0x29de65['length'];}[_0x3f38f4(0x13d)](_0x537d02){const _0x452547=_0x3f38f4;if(_0x537d02['length']<this['ofiLookback'])return 0x0;const _0xa1e75b=_0x537d02['slice'](-this['ofiLookback']);let _0xf2e98=0x0,_0x1a00ce=0x0;for(const _0x46657 of _0xa1e75b){const _0x1aeaaf=_0x46657[_0x452547(0xf3)]-_0x46657[_0x452547(0x13a)];if(_0x1aeaaf>0x0){const _0x3ad9ad=(_0x46657[_0x452547(0x150)]-_0x46657['low'])/_0x1aeaaf;_0xf2e98+=_0x3ad9ad*_0x46657[_0x452547(0x119)],_0x1a00ce+=(0x1-_0x3ad9ad)*_0x46657['volume'];}}const _0x54c894=_0xf2e98+_0x1a00ce;if(_0x54c894<0x1)return 0x0;return(_0xf2e98-_0x1a00ce)/_0x54c894;}[_0x3f38f4(0x14a)](_0x507b98,_0x3263f1,_0x2faa63,_0x1fab76,_0x3da40e,_0x596d19,_0x51c2b6,_0x52e7c0,_0x5b469b,_0x10653a){const _0x2ddf32=_0x3f38f4,_0x2441b5=Math['abs'](_0x2faa63);if(_0x2441b5<_0x52e7c0['zscoreThreshold'])return null;if(_0x1fab76>this['vpinToxicThreshold'])return null;let _0x1242ea;if(_0x2faa63<-_0x52e7c0['zscoreThreshold'])_0x1242ea='long';else{if(_0x2faa63>_0x52e7c0['zscoreThreshold'])_0x1242ea=_0x2ddf32(0xf7);else return null;}const _0x7db943=_0x1242ea===_0x2ddf32(0xfd)&&_0x5b469b>0.1||_0x1242ea===_0x2ddf32(0xf7)&&_0x5b469b<-0.1,_0x50fa47=_0x3263f1-_0x596d19,_0x1895a4=_0x1242ea===_0x2ddf32(0xfd)&&_0x50fa47<0x0||_0x1242ea===_0x2ddf32(0xf7)&&_0x50fa47>0x0,_0x4afb8d={'zscore':Math[_0x2ddf32(0x12b)](0x1,_0x2441b5/0x4),'vpin':0x1-_0x1fab76,'kyleLambda':_0x3da40e>0.001?0.5:0.8,'kalman':_0x1895a4?0.8:0.4,'volatility':_0x51c2b6===_0x2ddf32(0x13f)?0.8:_0x51c2b6==='low'?0.7:0.6,'ofi':_0x7db943?0.9:0.5,'composite':0x0};_0x4afb8d[_0x2ddf32(0xf5)]=_0x4afb8d['zscore']*this[_0x2ddf32(0x10a)]['zscore']+_0x4afb8d['vpin']*this[_0x2ddf32(0x10a)]['vpin']+_0x4afb8d['kyleLambda']*this['weights'][_0x2ddf32(0x106)]+_0x4afb8d['kalman']*this['weights'][_0x2ddf32(0x124)]+_0x4afb8d['volatility']*this['weights'][_0x2ddf32(0x15a)]+_0x4afb8d['ofi']*this['weights'][_0x2ddf32(0x15d)];const _0x256dc9=Math['min'](0x1,_0x4afb8d[_0x2ddf32(0xf5)]+_0x52e7c0[_0x2ddf32(0x156)]);if(_0x256dc9<this[_0x2ddf32(0x15c)])return null;if(Date['now']()-this['lastSignalTime']<this[_0x2ddf32(0x108)])return null;const _0x1ccb91=Math['round'](this[_0x2ddf32(0x15b)]*_0x52e7c0[_0x2ddf32(0x103)]),_0x5cc624=Math['round'](this['baseTargetTicks']*_0x52e7c0[_0x2ddf32(0x112)]),_0x44d2b0=Math[_0x2ddf32(0x10f)](0x6,Math['min'](0xc,_0x1ccb91)),_0x367001=Math['max'](_0x44d2b0*1.5,Math['min'](0x18,_0x5cc624));let _0x4408b9,_0x454d41,_0x1bfe33,_0x1d89bf;_0x1242ea==='long'?(_0x4408b9=_0x3263f1-_0x44d2b0*this['tickSize'],_0x454d41=_0x3263f1+_0x367001*this[_0x2ddf32(0x132)],_0x1bfe33=_0x3263f1+this[_0x2ddf32(0x14e)]*this[_0x2ddf32(0x132)],_0x1d89bf=_0x3263f1+_0x367001*this[_0x2ddf32(0xfc)]*this['tickSize']):(_0x4408b9=_0x3263f1+_0x44d2b0*this['tickSize'],_0x454d41=_0x3263f1-_0x367001*this['tickSize'],_0x1bfe33=_0x3263f1-this['breakevenTicks']*this[_0x2ddf32(0x132)],_0x1d89bf=_0x3263f1-_0x367001*this['profitLockPct']*this[_0x2ddf32(0x132)]);const _0x2df7f9=_0x367001/_0x44d2b0,_0x3e5215=Math[_0x2ddf32(0x133)](_0x367001*0.5),_0x19d283=Math['round'](_0x44d2b0*0.4);let _0x48825d=SignalStrength[_0x2ddf32(0x118)];if(_0x256dc9>=0.85)_0x48825d=SignalStrength[_0x2ddf32(0x13c)];else{if(_0x256dc9>=0.75)_0x48825d=SignalStrength['STRONG'];else{if(_0x256dc9<0.6)_0x48825d=SignalStrength['WEAK'];}}const _0x496c28=0.5+(_0x256dc9-0.5)*0.4,_0x21c395=_0x496c28*Math[_0x2ddf32(0x12c)](_0x454d41-_0x3263f1)-(0x1-_0x496c28)*Math[_0x2ddf32(0x12c)](_0x3263f1-_0x4408b9);this['lastSignalTime']=Date[_0x2ddf32(0x141)](),this[_0x2ddf32(0x11f)]['signals']++;const _0x253fba={'id':uuidv4(),'timestamp':Date[_0x2ddf32(0x141)](),'symbol':_0x507b98['split']('.')[0x0]||_0x507b98,'contractId':_0x507b98,'side':_0x1242ea==='long'?OrderSide['BID']:OrderSide['ASK'],'direction':_0x1242ea,'strategy':'HQX_ULTRA_SCALPING_6MODELS','strength':_0x48825d,'edge':_0x21c395,'confidence':_0x256dc9,'entry':_0x3263f1,'entryPrice':_0x3263f1,'stopLoss':_0x4408b9,'takeProfit':_0x454d41,'riskReward':_0x2df7f9,'stopTicks':_0x44d2b0,'targetTicks':_0x367001,'trailTriggerTicks':_0x3e5215,'trailDistanceTicks':_0x19d283,'beBreakeven':_0x1bfe33,'profitLockLevel':_0x1d89bf,'zScore':_0x2faa63,'zScoreExit':this[_0x2ddf32(0x135)],'vpinValue':_0x1fab76,'kyleLambda':_0x3da40e,'kalmanEstimate':_0x596d19,'volatilityRegime':_0x51c2b6,'ofiValue':_0x5b469b,'models':_0x4afb8d,'orderFlowConfirmed':_0x7db943,'kalmanConfirmed':_0x1895a4,'expires':Date[_0x2ddf32(0x141)]()+0xea60};return this['emit'](_0x2ddf32(0x10b),{'side':_0x1242ea===_0x2ddf32(0xfd)?_0x2ddf32(0x129):'sell','action':'open','reason':'Z='+_0x2faa63['toFixed'](0x2)+_0x2ddf32(0x121)+(_0x1fab76*0x64)[_0x2ddf32(0x151)](0x0)+_0x2ddf32(0x111)+(_0x5b469b*0x64)['toFixed'](0x0)+'%,\x20cf='+(_0x256dc9*0x64)[_0x2ddf32(0x151)](0x0)+'%',..._0x253fba}),this['emit'](_0x2ddf32(0x12f),{'type':_0x2ddf32(0x13e),'message':_0x2ddf32(0x123)+_0x1242ea[_0x2ddf32(0x100)]()+'\x20@\x20'+_0x3263f1[_0x2ddf32(0x151)](0x2)+'\x20|\x20Z:'+_0x2faa63[_0x2ddf32(0x151)](0x2)+'\x20VPIN:'+(_0x1fab76*0x64)[_0x2ddf32(0x151)](0x0)+'%\x20OFI:'+(_0x5b469b*0x64)['toFixed'](0x0)+'%\x20Kyle:'+_0x3da40e['toFixed'](0x5)+'\x20Regime:'+_0x51c2b6+'\x20|\x20Conf:'+(_0x256dc9*0x64)['toFixed'](0x0)+'%'}),_0x253fba;}[_0x3f38f4(0x107)](_0x3f100d){const _0x59d96e=_0x3f38f4,_0x464578=this[_0x59d96e(0x11c)][_0x59d96e(0x10d)](_0x3f100d);if(!_0x464578||_0x464578['length']<0x32)return![];const _0x3aa107=this[_0x59d96e(0x12a)](_0x464578);return Math[_0x59d96e(0x12c)](_0x3aa107)<this['zscoreExitThreshold'];}[_0x3f38f4(0xf8)](_0x3ca54b){const _0x127579=_0x3f38f4,_0x27b100=this['priceBuffer']['get'](_0x3ca54b),_0x27c0d3=this['volumeBuffer'][_0x127579(0x10d)](_0x3ca54b),_0x1af95c=this[_0x127579(0xfb)]['get'](_0x3ca54b);if(!_0x27b100||!_0x27c0d3||!_0x1af95c||_0x1af95c[_0x127579(0xf6)]<0x32)return null;const _0x596ec7=this['_computeZScore'](_0x27b100),_0x28214d=this[_0x127579(0x157)](_0x27c0d3),_0x4606b6=this['_computeKyleLambda'](_0x1af95c),_0x1d2055=this['_computeOrderFlowImbalance'](_0x1af95c);return{'zscore':Math['min'](0x1,Math['abs'](_0x596ec7)/0x4),'vpin':0x1-_0x28214d,'kyleLambda':_0x4606b6>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math['abs'](_0x1d2055)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x596ec7,'vpin':_0x28214d,'kyleLambda':_0x4606b6,'ofi':_0x1d2055}};}['getAnalysisState'](_0x1b5736,_0x2a931f){const _0x4e564d=_0x3f38f4,_0xb68db1=this['barHistory']['get'](_0x1b5736)||[];if(_0xb68db1[_0x4e564d(0xf6)]<0x32)return{'ready':![],'message':'Collecting\x20data...\x20'+_0xb68db1[_0x4e564d(0xf6)]+'/50\x20bars'};const _0x5592fa=this['priceBuffer']['get'](_0x1b5736)||[],_0x449d36=this['volumeBuffer']['get'](_0x1b5736)||[],_0x3e3124=this['_computeZScore'](_0x5592fa),_0x57a88c=this[_0x4e564d(0x157)](_0x449d36),_0x2e7e00=this[_0x4e564d(0x13d)](_0xb68db1),_0x5cb4e9=this['_computeKyleLambda'](_0xb68db1),{regime:_0x1035a4,params:_0x4b10bc}=this[_0x4e564d(0x11d)](_0x1b5736,_0xb68db1);return{'ready':!![],'zScore':_0x3e3124,'vpin':_0x57a88c,'ofi':_0x2e7e00,'kyleLambda':_0x5cb4e9,'regime':_0x1035a4,'stopTicks':Math['round'](this['baseStopTicks']*_0x4b10bc[_0x4e564d(0x103)]),'targetTicks':Math[_0x4e564d(0x133)](this['baseTargetTicks']*_0x4b10bc['targetMultiplier']),'threshold':_0x4b10bc['zscoreThreshold'],'barsProcessed':_0xb68db1[_0x4e564d(0xf6)],'models':'6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)'};}[_0x3f38f4(0x12d)](_0x450d04){const _0x52acbd=_0x3f38f4;this[_0x52acbd(0x116)]['push']({'netPnl':_0x450d04,'timestamp':Date[_0x52acbd(0x141)]()});if(this['recentTrades']['length']>0x64)this['recentTrades']['shift']();_0x450d04>0x0?(this[_0x52acbd(0x142)]++,this['lossStreak']=0x0,this[_0x52acbd(0x11f)]['wins']++):(this[_0x52acbd(0x122)]++,this['winStreak']=0x0,this['stats'][_0x52acbd(0xf2)]++),this[_0x52acbd(0x11f)][_0x52acbd(0x149)]++,this['stats']['pnl']+=_0x450d04,this['emit'](_0x52acbd(0x12f),{'type':_0x52acbd(0x102),'message':'[HQX]\x20Trade\x20result:\x20'+(_0x450d04>0x0?'WIN':'LOSS')+'\x20$'+_0x450d04['toFixed'](0x2)+',\x20streak:\x20'+(_0x450d04>0x0?this['winStreak']:-this[_0x52acbd(0x122)])});}['getBarHistory'](_0x2909f8){const _0x462d7e=_0x3f38f4;return this[_0x462d7e(0xfb)]['get'](_0x2909f8)||[];}['getStats'](){const _0x5987ba=_0x3f38f4;return this[_0x5987ba(0x11f)];}['reset'](_0x2f1c56){const _0x3a12f5=_0x3f38f4;this['barHistory'][_0x3a12f5(0x11e)](_0x2f1c56,[]),this['priceBuffer']['set'](_0x2f1c56,[]),this['volumeBuffer']['set'](_0x2f1c56,[]),this['atrHistory'][_0x3a12f5(0x11e)](_0x2f1c56,[]),this[_0x3a12f5(0x134)]['set'](_0x2f1c56,{'estimate':0x0,'errorCovariance':0x1}),this[_0x3a12f5(0x114)](_0x3a12f5(0x12f),{'type':'info','message':_0x3a12f5(0x153)+_0x2f1c56});}}function _0x492e(){const _0x223a4b=['long','reduce','tickValue','toUpperCase','onTrade','debug','stopMultiplier','96702fpQzch','onTick','kyleLambda','shouldExitByZScore','cooldownMs','getAnalysisState','weights','signal','shift','get','zscoreEntryThreshold','max','getStats','%,\x20OFI=','targetMultiplier','1411050IMIQCo','emit','push','recentTrades','events','MODERATE','volume',':\x20tick=','getBarHistory','priceBuffer','_detectVolatilityRegime','set','stats','baseTargetTicks',',\x20VPIN=','lossStreak','[HQX]\x20SIGNAL:\x20','kalman','volumeBuffer','3286540CgzlHt','12ZmjSmH','estimate','buy','_computeZScore','min','abs','recordTradeResult','_computeKyleLambda','log','processTick','strategy','tickSize','round','kalmanStates','zscoreExitThreshold','initialize','vpinWindow','sell','12355JODrZy','low','processBar','VERY_STRONG','_computeOrderFlowImbalance','info','normal','volatilityLookback','now','winStreak','errorCovariance','207iZSoLF','lastSignalTime','atrHistory','_applyKalmanFilter','reset','trades','_generateSignal','7487032MEshvr','timestamp','kalmanProcessNoise','breakevenTicks','filter','close','toFixed','vpinToxicThreshold','[HQX-UltraScalping]\x20Reset\x20state\x20for\x20','pow','8288qXISxq','confidenceBonus','_computeVPIN','minHoldTimeMs','1069340CnLiZe','volatility','baseStopTicks','minConfidence','ofi','losses','high','_calculateATR','composite','length','short','getModelValues','slice','8719128UInoaM','barHistory','profitLockPct'];_0x492e=function(){return _0x223a4b;};return _0x492e();}function _0x30a6(_0x385a7b,_0x44cee7){_0x385a7b=_0x385a7b-0xf2;const _0x492e31=_0x492e();let _0x30a6e4=_0x492e31[_0x385a7b];return _0x30a6e4;}class UltraScalpingStrategy extends EventEmitter{constructor(_0x5b81aa={}){const _0x45add5=_0x3f38f4;super(),this['config']=_0x5b81aa,this[_0x45add5(0x131)]=new HQXUltraScalping(_0x5b81aa),this[_0x45add5(0x131)]['on'](_0x45add5(0x10b),_0x136f3b=>this['emit']('signal',_0x136f3b)),this['strategy']['on']('log',_0x222daa=>this[_0x45add5(0x114)]('log',_0x222daa));}['processTick'](_0x17aa81){const _0x40989e=_0x3f38f4;return this[_0x40989e(0x131)][_0x40989e(0x130)](_0x17aa81);}[_0x3f38f4(0x105)](_0xb2a0d3){const _0x13c7ae=_0x3f38f4;return this['strategy'][_0x13c7ae(0x105)](_0xb2a0d3);}[_0x3f38f4(0x101)](_0x47cc66){return this['strategy']['onTrade'](_0x47cc66);}[_0x3f38f4(0x13b)](_0x1fec33,_0x2b69c5){const _0x6a528a=_0x3f38f4;return this[_0x6a528a(0x131)][_0x6a528a(0x13b)](_0x1fec33,_0x2b69c5);}['initialize'](_0x2aeb31,_0x5e8a23,_0x1364cb){return this['strategy']['initialize'](_0x2aeb31,_0x5e8a23,_0x1364cb);}[_0x3f38f4(0x109)](_0x2e5e45,_0x52fb80){return this['strategy']['getAnalysisState'](_0x2e5e45,_0x52fb80);}[_0x3f38f4(0x12d)](_0x40c722){const _0x537a0c=_0x3f38f4;return this[_0x537a0c(0x131)]['recordTradeResult'](_0x40c722);}['reset'](_0x5d82c7){const _0x32c500=_0x3f38f4;return this[_0x32c500(0x131)][_0x32c500(0x148)](_0x5d82c7);}[_0x3f38f4(0x110)](){return this['strategy']['getStats']();}[_0x3f38f4(0x11b)](_0x20cecd){return this['strategy']['getBarHistory'](_0x20cecd);}[_0x3f38f4(0xf8)](_0x5c9f6d){return this['strategy']['getModelValues'](_0x5c9f6d);}[_0x3f38f4(0x107)](_0x3f5e7c){const _0x167e98=_0x3f38f4;return this[_0x167e98(0x131)]['shouldExitByZScore'](_0x3f5e7c);}['generateSignal'](_0x139b38){return null;}}module['exports']={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};