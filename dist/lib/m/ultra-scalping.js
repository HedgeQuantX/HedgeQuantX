const _0x25ec0c=_0x681d;function _0x1ce9(){const _0x591cb0=['WEAK','53200VgJmOL','reduce','6VRNGeR','trades','_calculateATR','vpinWindow','barHistory','max','_computeZScore','_generateSignal','estimate','onTrade','1713NlwPVu','toUpperCase','2874529FubOBY',':\x20tick=','zscoreEntryThreshold','/50\x20bars','strategy','getBarHistory','sqrt','atrHistory','kyleLambda','buy','breakevenTicks','generateSignal','[HQX]\x20Trade\x20result:\x20','zscoreExitThreshold','kalman','42518oTQpBD','get','short','open','emit','\x20@\x20','_computeOrderFlowImbalance','tickSize','stats','lastSignalTime','getStats','toFixed','winStreak','signal','zscoreThreshold','%,\x20OFI=','volumeBuffer','715772vlgJvY','confidenceBonus','abs','high','16LvQzXm','symbol','vpinToxicThreshold','ASK','weights','close','LOSS','recentTrades','12026840ZgJdoz','uuid','STRONG','\x20Regime:','_detectVolatilityRegime','volume','tickValue','onTick','processBar','6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)','processTick','[HQX-UltraScalping]\x20Initialized\x20for\x20','stopMultiplier','round','_computeVPIN','424UThnFM','\x20|\x20Conf:','long','reset','1960569dOqUUn','priceBuffer','vpin','profitLockPct','ofiLookback','_computeKyleLambda','min','kalmanMeasurementNoise','info','signals','set','shouldExitByZScore','recordTradeResult','push','filter','getAnalysisState','slice','baseStopTicks','baseTargetTicks','low','lossStreak','log','shift','length'];_0x1ce9=function(){return _0x591cb0;};return _0x1ce9();}(function(_0x3ecadb,_0x5aa991){const _0x145507=_0x681d,_0x4ab801=_0x3ecadb();while(!![]){try{const _0x1a76a7=-parseInt(_0x145507(0x14e))/0x1+parseInt(_0x145507(0x17a))/0x2*(parseInt(_0x145507(0x13d))/0x3)+-parseInt(_0x145507(0x15f))/0x4+-parseInt(_0x145507(0x131))/0x5+-parseInt(_0x145507(0x133))/0x6*(parseInt(_0x145507(0x13f))/0x7)+-parseInt(_0x145507(0x163))/0x8*(parseInt(_0x145507(0x118))/0x9)+parseInt(_0x145507(0x16b))/0xa;if(_0x1a76a7===_0x5aa991)break;else _0x4ab801['push'](_0x4ab801['shift']());}catch(_0x4f1393){_0x4ab801['push'](_0x4ab801['shift']());}}}(_0x1ce9,0x3be3a));const EventEmitter=require('events'),{v4:uuidv4}=require(_0x25ec0c(0x16c)),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};function _0x681d(_0x13eb78,_0xc9ff03){_0x13eb78=_0x13eb78-0x118;const _0x1ce911=_0x1ce9();let _0x681d0c=_0x1ce911[_0x13eb78];return _0x681d0c;}class HQXUltraScalping extends EventEmitter{constructor(_0x24eb07={}){const _0x569675=_0x25ec0c;super(),this[_0x569675(0x155)]=_0x24eb07[_0x569675(0x155)]||0.25,this[_0x569675(0x171)]=_0x24eb07['tickValue']||0x5,this[_0x569675(0x141)]=1.5,this['zscoreExitThreshold']=0.5,this[_0x569675(0x136)]=0x32,this['vpinToxicThreshold']=0.7,this['kalmanProcessNoise']=0.01,this['kalmanMeasurementNoise']=0.1,this['volatilityLookback']=0x64,this['ofiLookback']=0x14,this['baseStopTicks']=0x8,this[_0x569675(0x12a)]=0x10,this['breakevenTicks']=0x4,this[_0x569675(0x11b)]=0.5,this['minConfidence']=0.55,this[_0x569675(0x167)]={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this[_0x569675(0x137)]=new Map(),this['priceBuffer']=new Map(),this[_0x569675(0x15e)]=new Map(),this['kalmanStates']=new Map(),this[_0x569675(0x146)]=new Map(),this[_0x569675(0x16a)]=[],this[_0x569675(0x15a)]=0x0,this[_0x569675(0x12c)]=0x0,this['lastSignalTime']=0x0,this['cooldownMs']=0x7530,this['minHoldTimeMs']=0x2710,this[_0x569675(0x156)]={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}['initialize'](_0xd388e8,_0x16d8cf=0.25,_0x138a3a=0x5){const _0x52a9ba=_0x25ec0c;this[_0x52a9ba(0x155)]=_0x16d8cf,this['tickValue']=_0x138a3a,this['barHistory']['set'](_0xd388e8,[]),this[_0x52a9ba(0x119)]['set'](_0xd388e8,[]),this['volumeBuffer'][_0x52a9ba(0x122)](_0xd388e8,[]),this[_0x52a9ba(0x146)][_0x52a9ba(0x122)](_0xd388e8,[]),this['kalmanStates']['set'](_0xd388e8,{'estimate':0x0,'errorCovariance':0x1}),this[_0x52a9ba(0x152)](_0x52a9ba(0x12d),{'type':_0x52a9ba(0x120),'message':_0x52a9ba(0x176)+_0xd388e8+_0x52a9ba(0x140)+_0x16d8cf+',\x20value='+_0x138a3a}),this['emit']('log',{'type':'info','message':'[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)'});}[_0x25ec0c(0x175)](_0x564aca){const {contractId:_0x45b123,price:_0x167042,volume:_0x8c0e5d,side:_0xffe477,timestamp:_0x28a9d8}=_0x564aca,_0x5c0322={'timestamp':_0x28a9d8||Date['now'](),'open':_0x167042,'high':_0x167042,'low':_0x167042,'close':_0x167042,'volume':_0x8c0e5d||0x1};return this['processBar'](_0x45b123,_0x5c0322);}['onTick'](_0xc80be9){const _0xf652d9=_0x25ec0c;return this[_0xf652d9(0x175)](_0xc80be9);}[_0x25ec0c(0x13c)](_0x4fbdeb){const _0x250d38=_0x25ec0c;return this['processTick']({'contractId':_0x4fbdeb['contractId']||_0x4fbdeb[_0x250d38(0x164)],'price':_0x4fbdeb['price'],'volume':_0x4fbdeb['size']||_0x4fbdeb['volume']||0x1,'side':_0x4fbdeb['side'],'timestamp':_0x4fbdeb['timestamp']||Date['now']()});}['processBar'](_0x1442cf,_0x231c33){const _0x4a41d8=_0x25ec0c;let _0x532f3f=this['barHistory']['get'](_0x1442cf);!_0x532f3f&&(this['initialize'](_0x1442cf),_0x532f3f=this[_0x4a41d8(0x137)]['get'](_0x1442cf));_0x532f3f['push'](_0x231c33);if(_0x532f3f[_0x4a41d8(0x12f)]>0x1f4)_0x532f3f['shift']();const _0x54c1a3=this[_0x4a41d8(0x119)][_0x4a41d8(0x14f)](_0x1442cf);_0x54c1a3['push'](_0x231c33['close']);if(_0x54c1a3['length']>0xc8)_0x54c1a3[_0x4a41d8(0x12e)]();const _0x3e12c6=this[_0x4a41d8(0x15e)][_0x4a41d8(0x14f)](_0x1442cf),_0x20f9d8=_0x231c33[_0x4a41d8(0x162)]-_0x231c33[_0x4a41d8(0x12b)];let _0x4cce04=_0x231c33['volume']*0.5,_0xa5bffa=_0x231c33['volume']*0.5;if(_0x20f9d8>0x0){const _0x3c114e=(_0x231c33['close']-_0x231c33[_0x4a41d8(0x12b)])/_0x20f9d8;_0x4cce04=_0x231c33['volume']*_0x3c114e,_0xa5bffa=_0x231c33['volume']*(0x1-_0x3c114e);}_0x3e12c6[_0x4a41d8(0x125)]({'buy':_0x4cce04,'sell':_0xa5bffa});if(_0x3e12c6['length']>0x64)_0x3e12c6['shift']();if(_0x532f3f[_0x4a41d8(0x12f)]<0x32)return null;const _0x4a5788=this['_computeZScore'](_0x54c1a3),_0x4337d1=this['_computeVPIN'](_0x3e12c6),_0x5120e2=this[_0x4a41d8(0x11d)](_0x532f3f),_0x5cd1fc=this['_applyKalmanFilter'](_0x1442cf,_0x231c33['close']),{regime:_0x1e8732,params:_0x36dd63}=this[_0x4a41d8(0x16f)](_0x1442cf,_0x532f3f),_0x455254=this[_0x4a41d8(0x154)](_0x532f3f);return this[_0x4a41d8(0x13a)](_0x1442cf,_0x231c33[_0x4a41d8(0x168)],_0x4a5788,_0x4337d1,_0x5120e2,_0x5cd1fc,_0x1e8732,_0x36dd63,_0x455254,_0x532f3f);}['_computeZScore'](_0x56cc77,_0x44e30c=0x32){const _0x203b4e=_0x25ec0c;if(_0x56cc77['length']<_0x44e30c)return 0x0;const _0x1d8e30=_0x56cc77['slice'](-_0x44e30c),_0x36705a=_0x1d8e30[_0x203b4e(0x132)]((_0x333ff7,_0x3cf675)=>_0x333ff7+_0x3cf675,0x0)/_0x44e30c,_0x2de8f6=_0x1d8e30[_0x203b4e(0x132)]((_0x1f8c86,_0x27057b)=>_0x1f8c86+Math['pow'](_0x27057b-_0x36705a,0x2),0x0)/_0x44e30c,_0x2a63f3=Math[_0x203b4e(0x145)](_0x2de8f6);if(_0x2a63f3<0.0001)return 0x0;const _0x2a0b8c=_0x56cc77[_0x56cc77[_0x203b4e(0x12f)]-0x1];return(_0x2a0b8c-_0x36705a)/_0x2a63f3;}['_computeVPIN'](_0x2f67d7){const _0x1ee21a=_0x25ec0c;if(_0x2f67d7['length']<this[_0x1ee21a(0x136)])return 0.5;const _0x3920b3=_0x2f67d7['slice'](-this[_0x1ee21a(0x136)]);let _0x5e1231=0x0,_0x3057c5=0x0;for(const _0x1f11ed of _0x3920b3){_0x5e1231+=_0x1f11ed[_0x1ee21a(0x148)],_0x3057c5+=_0x1f11ed['sell'];}const _0x488ca2=_0x5e1231+_0x3057c5;if(_0x488ca2<0x1)return 0.5;return Math['abs'](_0x5e1231-_0x3057c5)/_0x488ca2;}['_computeKyleLambda'](_0x3e58e0){const _0x3c008a=_0x25ec0c;if(_0x3e58e0['length']<0x14)return 0x0;const _0x377e14=_0x3e58e0['slice'](-0x14),_0x383b9d=[],_0x41ee55=[];for(let _0x4417f7=0x1;_0x4417f7<_0x377e14['length'];_0x4417f7++){_0x383b9d['push'](_0x377e14[_0x4417f7][_0x3c008a(0x168)]-_0x377e14[_0x4417f7-0x1][_0x3c008a(0x168)]),_0x41ee55['push'](_0x377e14[_0x4417f7][_0x3c008a(0x170)]);}const _0x304307=_0x383b9d[_0x3c008a(0x132)]((_0x4a85d8,_0x4472f5)=>_0x4a85d8+_0x4472f5,0x0)/_0x383b9d['length'],_0x1b3832=_0x41ee55['reduce']((_0x5908ed,_0x3d50b3)=>_0x5908ed+_0x3d50b3,0x0)/_0x41ee55['length'];let _0x334ee2=0x0,_0x386c5e=0x0;for(let _0x41f00e=0x0;_0x41f00e<_0x383b9d[_0x3c008a(0x12f)];_0x41f00e++){_0x334ee2+=(_0x383b9d[_0x41f00e]-_0x304307)*(_0x41ee55[_0x41f00e]-_0x1b3832),_0x386c5e+=Math['pow'](_0x41ee55[_0x41f00e]-_0x1b3832,0x2);}_0x334ee2/=_0x383b9d['length'],_0x386c5e/=_0x383b9d['length'];if(_0x386c5e<0.0001)return 0x0;return Math['abs'](_0x334ee2/_0x386c5e);}['_applyKalmanFilter'](_0x2ba437,_0x55dc91){const _0x5e51c2=_0x25ec0c;let _0x5d6e15=this['kalmanStates']['get'](_0x2ba437);if(!_0x5d6e15)return _0x5d6e15={'estimate':_0x55dc91,'errorCovariance':0x1},this['kalmanStates']['set'](_0x2ba437,_0x5d6e15),_0x55dc91;const _0x326864=_0x5d6e15[_0x5e51c2(0x13b)],_0x63370d=_0x5d6e15['errorCovariance']+this['kalmanProcessNoise'],_0x2c0592=_0x63370d/(_0x63370d+this[_0x5e51c2(0x11f)]),_0x136516=_0x326864+_0x2c0592*(_0x55dc91-_0x326864),_0x288567=(0x1-_0x2c0592)*_0x63370d;return _0x5d6e15[_0x5e51c2(0x13b)]=_0x136516,_0x5d6e15['errorCovariance']=_0x288567,_0x136516;}[_0x25ec0c(0x16f)](_0x5e689e,_0x44afd7){const _0x3b5214=_0x25ec0c,_0x31ae07=this[_0x3b5214(0x135)](_0x44afd7),_0x144e0d=_0x31ae07/this['tickSize'];let _0x54ac70=this[_0x3b5214(0x146)][_0x3b5214(0x14f)](_0x5e689e);!_0x54ac70&&(_0x54ac70=[],this['atrHistory'][_0x3b5214(0x122)](_0x5e689e,_0x54ac70));_0x54ac70[_0x3b5214(0x125)](_0x31ae07);if(_0x54ac70['length']>0x1f4)_0x54ac70['shift']();let _0x60c15a=0.5;_0x54ac70['length']>=0x14&&(_0x60c15a=_0x54ac70[_0x3b5214(0x126)](_0x2c4acf=>_0x2c4acf<=_0x31ae07)['length']/_0x54ac70['length']);let _0x31775f,_0x136e93;if(_0x60c15a<0.25)_0x31775f='low',_0x136e93={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x60c15a<0.75?(_0x31775f='normal',_0x136e93={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0x31775f='high',_0x136e93={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0x31775f,'params':_0x136e93};}['_calculateATR'](_0x272d28,_0x26ea80=0xe){const _0x4764c5=_0x25ec0c;if(_0x272d28['length']<_0x26ea80+0x1)return 2.5;const _0x39e351=[];for(let _0x316356=_0x272d28['length']-_0x26ea80;_0x316356<_0x272d28['length'];_0x316356++){const _0x362b73=_0x272d28[_0x316356],_0x35bca5=_0x272d28[_0x316356-0x1]['close'],_0xc5c1d7=Math[_0x4764c5(0x138)](_0x362b73[_0x4764c5(0x162)]-_0x362b73[_0x4764c5(0x12b)],Math[_0x4764c5(0x161)](_0x362b73['high']-_0x35bca5),Math[_0x4764c5(0x161)](_0x362b73[_0x4764c5(0x12b)]-_0x35bca5));_0x39e351['push'](_0xc5c1d7);}return _0x39e351['reduce']((_0x547998,_0x26b7ed)=>_0x547998+_0x26b7ed,0x0)/_0x39e351[_0x4764c5(0x12f)];}['_computeOrderFlowImbalance'](_0x1cfd11){const _0x295658=_0x25ec0c;if(_0x1cfd11['length']<this[_0x295658(0x11c)])return 0x0;const _0x11857e=_0x1cfd11[_0x295658(0x128)](-this['ofiLookback']);let _0x428bb7=0x0,_0x288b9f=0x0;for(const _0x52f5ff of _0x11857e){const _0x3b8d71=_0x52f5ff[_0x295658(0x162)]-_0x52f5ff['low'];if(_0x3b8d71>0x0){const _0x37146f=(_0x52f5ff['close']-_0x52f5ff[_0x295658(0x12b)])/_0x3b8d71;_0x428bb7+=_0x37146f*_0x52f5ff[_0x295658(0x170)],_0x288b9f+=(0x1-_0x37146f)*_0x52f5ff[_0x295658(0x170)];}}const _0x577fff=_0x428bb7+_0x288b9f;if(_0x577fff<0x1)return 0x0;return(_0x428bb7-_0x288b9f)/_0x577fff;}[_0x25ec0c(0x13a)](_0x2a541f,_0x37bac3,_0x5362f8,_0x2fe4b8,_0x9084c0,_0x4a7a22,_0x5afb6d,_0x5c393b,_0x3ff8a2,_0x1987c4){const _0x210f1b=_0x25ec0c,_0xc36d49=Math[_0x210f1b(0x161)](_0x5362f8);if(_0xc36d49<_0x5c393b[_0x210f1b(0x15c)])return null;if(_0x2fe4b8>this[_0x210f1b(0x165)])return null;let _0x2cbd66;if(_0x5362f8<-_0x5c393b['zscoreThreshold'])_0x2cbd66=_0x210f1b(0x17c);else{if(_0x5362f8>_0x5c393b[_0x210f1b(0x15c)])_0x2cbd66=_0x210f1b(0x150);else return null;}const _0x2842c2=_0x2cbd66===_0x210f1b(0x17c)&&_0x3ff8a2>0.1||_0x2cbd66==='short'&&_0x3ff8a2<-0.1,_0x156f33=_0x37bac3-_0x4a7a22,_0x27a9ff=_0x2cbd66===_0x210f1b(0x17c)&&_0x156f33<0x0||_0x2cbd66===_0x210f1b(0x150)&&_0x156f33>0x0,_0xa70813={'zscore':Math[_0x210f1b(0x11e)](0x1,_0xc36d49/0x4),'vpin':0x1-_0x2fe4b8,'kyleLambda':_0x9084c0>0.001?0.5:0.8,'kalman':_0x27a9ff?0.8:0.4,'volatility':_0x5afb6d==='normal'?0.8:_0x5afb6d==='low'?0.7:0.6,'ofi':_0x2842c2?0.9:0.5,'composite':0x0};_0xa70813['composite']=_0xa70813['zscore']*this[_0x210f1b(0x167)]['zscore']+_0xa70813[_0x210f1b(0x11a)]*this['weights'][_0x210f1b(0x11a)]+_0xa70813[_0x210f1b(0x147)]*this[_0x210f1b(0x167)][_0x210f1b(0x147)]+_0xa70813['kalman']*this['weights'][_0x210f1b(0x14d)]+_0xa70813['volatility']*this[_0x210f1b(0x167)]['volatility']+_0xa70813['ofi']*this[_0x210f1b(0x167)]['ofi'];const _0xa1ae70=Math[_0x210f1b(0x11e)](0x1,_0xa70813['composite']+_0x5c393b[_0x210f1b(0x160)]);if(_0xa1ae70<this['minConfidence'])return null;if(Date['now']()-this[_0x210f1b(0x157)]<this['cooldownMs'])return null;const _0x1448bb=Math['round'](this[_0x210f1b(0x129)]*_0x5c393b['stopMultiplier']),_0x26ea75=Math[_0x210f1b(0x178)](this[_0x210f1b(0x12a)]*_0x5c393b['targetMultiplier']),_0x2c6a68=Math[_0x210f1b(0x138)](0x6,Math[_0x210f1b(0x11e)](0xc,_0x1448bb)),_0x2c9a8b=Math[_0x210f1b(0x138)](_0x2c6a68*1.5,Math[_0x210f1b(0x11e)](0x18,_0x26ea75));let _0x2e0b76,_0x32eca3,_0xb55e8f,_0x5b9b34;_0x2cbd66===_0x210f1b(0x17c)?(_0x2e0b76=_0x37bac3-_0x2c6a68*this[_0x210f1b(0x155)],_0x32eca3=_0x37bac3+_0x2c9a8b*this['tickSize'],_0xb55e8f=_0x37bac3+this[_0x210f1b(0x149)]*this['tickSize'],_0x5b9b34=_0x37bac3+_0x2c9a8b*this['profitLockPct']*this['tickSize']):(_0x2e0b76=_0x37bac3+_0x2c6a68*this[_0x210f1b(0x155)],_0x32eca3=_0x37bac3-_0x2c9a8b*this[_0x210f1b(0x155)],_0xb55e8f=_0x37bac3-this[_0x210f1b(0x149)]*this[_0x210f1b(0x155)],_0x5b9b34=_0x37bac3-_0x2c9a8b*this[_0x210f1b(0x11b)]*this['tickSize']);const _0x44e223=_0x2c9a8b/_0x2c6a68,_0x43d1c8=Math[_0x210f1b(0x178)](_0x2c9a8b*0.5),_0x2167b0=Math[_0x210f1b(0x178)](_0x2c6a68*0.4);let _0xbf3c45=SignalStrength['MODERATE'];if(_0xa1ae70>=0.85)_0xbf3c45=SignalStrength['VERY_STRONG'];else{if(_0xa1ae70>=0.75)_0xbf3c45=SignalStrength[_0x210f1b(0x16d)];else{if(_0xa1ae70<0.6)_0xbf3c45=SignalStrength[_0x210f1b(0x130)];}}const _0x104791=0.5+(_0xa1ae70-0.5)*0.4,_0x45900b=_0x104791*Math[_0x210f1b(0x161)](_0x32eca3-_0x37bac3)-(0x1-_0x104791)*Math['abs'](_0x37bac3-_0x2e0b76);this['lastSignalTime']=Date['now'](),this[_0x210f1b(0x156)][_0x210f1b(0x121)]++;const _0x1899ad={'id':uuidv4(),'timestamp':Date['now'](),'symbol':_0x2a541f['split']('.')[0x0]||_0x2a541f,'contractId':_0x2a541f,'side':_0x2cbd66==='long'?OrderSide['BID']:OrderSide[_0x210f1b(0x166)],'direction':_0x2cbd66,'strategy':'HQX_ULTRA_SCALPING_6MODELS','strength':_0xbf3c45,'edge':_0x45900b,'confidence':_0xa1ae70,'entry':_0x37bac3,'entryPrice':_0x37bac3,'stopLoss':_0x2e0b76,'takeProfit':_0x32eca3,'riskReward':_0x44e223,'stopTicks':_0x2c6a68,'targetTicks':_0x2c9a8b,'trailTriggerTicks':_0x43d1c8,'trailDistanceTicks':_0x2167b0,'beBreakeven':_0xb55e8f,'profitLockLevel':_0x5b9b34,'zScore':_0x5362f8,'zScoreExit':this[_0x210f1b(0x14c)],'vpinValue':_0x2fe4b8,'kyleLambda':_0x9084c0,'kalmanEstimate':_0x4a7a22,'volatilityRegime':_0x5afb6d,'ofiValue':_0x3ff8a2,'models':_0xa70813,'orderFlowConfirmed':_0x2842c2,'kalmanConfirmed':_0x27a9ff,'expires':Date['now']()+0xea60};return this[_0x210f1b(0x152)]('signal',{'side':_0x2cbd66==='long'?_0x210f1b(0x148):'sell','action':_0x210f1b(0x151),'reason':'Z='+_0x5362f8['toFixed'](0x2)+',\x20VPIN='+(_0x2fe4b8*0x64)['toFixed'](0x0)+_0x210f1b(0x15d)+(_0x3ff8a2*0x64)[_0x210f1b(0x159)](0x0)+'%,\x20cf='+(_0xa1ae70*0x64)[_0x210f1b(0x159)](0x0)+'%',..._0x1899ad}),this[_0x210f1b(0x152)](_0x210f1b(0x12d),{'type':_0x210f1b(0x120),'message':'[HQX]\x20SIGNAL:\x20'+_0x2cbd66[_0x210f1b(0x13e)]()+_0x210f1b(0x153)+_0x37bac3['toFixed'](0x2)+'\x20|\x20Z:'+_0x5362f8['toFixed'](0x2)+'\x20VPIN:'+(_0x2fe4b8*0x64)['toFixed'](0x0)+'%\x20OFI:'+(_0x3ff8a2*0x64)['toFixed'](0x0)+'%\x20Kyle:'+_0x9084c0[_0x210f1b(0x159)](0x5)+_0x210f1b(0x16e)+_0x5afb6d+_0x210f1b(0x17b)+(_0xa1ae70*0x64)[_0x210f1b(0x159)](0x0)+'%'}),_0x1899ad;}['shouldExitByZScore'](_0x3cf5a0){const _0xaedc1f=_0x25ec0c,_0x6c2423=this[_0xaedc1f(0x119)][_0xaedc1f(0x14f)](_0x3cf5a0);if(!_0x6c2423||_0x6c2423['length']<0x32)return![];const _0x597b95=this[_0xaedc1f(0x139)](_0x6c2423);return Math[_0xaedc1f(0x161)](_0x597b95)<this[_0xaedc1f(0x14c)];}['getModelValues'](_0x34f955){const _0x1ac26c=_0x25ec0c,_0x4dbaa7=this[_0x1ac26c(0x119)]['get'](_0x34f955),_0x537d16=this[_0x1ac26c(0x15e)][_0x1ac26c(0x14f)](_0x34f955),_0x5dae22=this['barHistory'][_0x1ac26c(0x14f)](_0x34f955);if(!_0x4dbaa7||!_0x537d16||!_0x5dae22||_0x5dae22['length']<0x32)return null;const _0x5ad365=this['_computeZScore'](_0x4dbaa7),_0x480bb1=this['_computeVPIN'](_0x537d16),_0x398339=this[_0x1ac26c(0x11d)](_0x5dae22),_0x2a82cb=this['_computeOrderFlowImbalance'](_0x5dae22);return{'zscore':Math['min'](0x1,Math[_0x1ac26c(0x161)](_0x5ad365)/0x4),'vpin':0x1-_0x480bb1,'kyleLambda':_0x398339>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math['abs'](_0x2a82cb)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x5ad365,'vpin':_0x480bb1,'kyleLambda':_0x398339,'ofi':_0x2a82cb}};}[_0x25ec0c(0x127)](_0x868cfa,_0x45ed5c){const _0x3ed786=_0x25ec0c,_0x1135d8=this['barHistory'][_0x3ed786(0x14f)](_0x868cfa)||[];if(_0x1135d8['length']<0x32)return{'ready':![],'message':'Collecting\x20data...\x20'+_0x1135d8['length']+_0x3ed786(0x142)};const _0x230ec9=this[_0x3ed786(0x119)]['get'](_0x868cfa)||[],_0x1d04ac=this[_0x3ed786(0x15e)]['get'](_0x868cfa)||[],_0x5d2f6c=this['_computeZScore'](_0x230ec9),_0x3d21c7=this[_0x3ed786(0x179)](_0x1d04ac),_0x552760=this[_0x3ed786(0x154)](_0x1135d8),_0xa93f48=this[_0x3ed786(0x11d)](_0x1135d8),{regime:_0x235004,params:_0x2dfb29}=this['_detectVolatilityRegime'](_0x868cfa,_0x1135d8);return{'ready':!![],'zScore':_0x5d2f6c,'vpin':_0x3d21c7,'ofi':_0x552760,'kyleLambda':_0xa93f48,'regime':_0x235004,'stopTicks':Math['round'](this[_0x3ed786(0x129)]*_0x2dfb29[_0x3ed786(0x177)]),'targetTicks':Math['round'](this['baseTargetTicks']*_0x2dfb29['targetMultiplier']),'threshold':_0x2dfb29['zscoreThreshold'],'barsProcessed':_0x1135d8[_0x3ed786(0x12f)],'models':_0x3ed786(0x174)};}['recordTradeResult'](_0x57c6fc){const _0x443d8e=_0x25ec0c;this[_0x443d8e(0x16a)][_0x443d8e(0x125)]({'netPnl':_0x57c6fc,'timestamp':Date['now']()});if(this[_0x443d8e(0x16a)]['length']>0x64)this['recentTrades'][_0x443d8e(0x12e)]();_0x57c6fc>0x0?(this[_0x443d8e(0x15a)]++,this[_0x443d8e(0x12c)]=0x0,this['stats']['wins']++):(this[_0x443d8e(0x12c)]++,this[_0x443d8e(0x15a)]=0x0,this[_0x443d8e(0x156)]['losses']++),this['stats'][_0x443d8e(0x134)]++,this['stats']['pnl']+=_0x57c6fc,this[_0x443d8e(0x152)]('log',{'type':'debug','message':_0x443d8e(0x14b)+(_0x57c6fc>0x0?'WIN':_0x443d8e(0x169))+'\x20$'+_0x57c6fc[_0x443d8e(0x159)](0x2)+',\x20streak:\x20'+(_0x57c6fc>0x0?this[_0x443d8e(0x15a)]:-this['lossStreak'])});}['getBarHistory'](_0x478bf3){const _0x5b5bf9=_0x25ec0c;return this[_0x5b5bf9(0x137)]['get'](_0x478bf3)||[];}[_0x25ec0c(0x158)](){return this['stats'];}['reset'](_0x15949e){const _0xd4e09f=_0x25ec0c;this['barHistory']['set'](_0x15949e,[]),this['priceBuffer']['set'](_0x15949e,[]),this[_0xd4e09f(0x15e)]['set'](_0x15949e,[]),this[_0xd4e09f(0x146)][_0xd4e09f(0x122)](_0x15949e,[]),this['kalmanStates']['set'](_0x15949e,{'estimate':0x0,'errorCovariance':0x1}),this[_0xd4e09f(0x152)]('log',{'type':_0xd4e09f(0x120),'message':'[HQX-UltraScalping]\x20Reset\x20state\x20for\x20'+_0x15949e});}}class UltraScalpingStrategy extends EventEmitter{constructor(_0x63f1c8={}){const _0x1a9473=_0x25ec0c;super(),this['config']=_0x63f1c8,this[_0x1a9473(0x143)]=new HQXUltraScalping(_0x63f1c8),this[_0x1a9473(0x143)]['on'](_0x1a9473(0x15b),_0x177427=>this[_0x1a9473(0x152)](_0x1a9473(0x15b),_0x177427)),this['strategy']['on'](_0x1a9473(0x12d),_0x3ae7e8=>this[_0x1a9473(0x152)]('log',_0x3ae7e8));}['processTick'](_0x15795e){const _0x230916=_0x25ec0c;return this[_0x230916(0x143)]['processTick'](_0x15795e);}['onTick'](_0x139ec2){const _0x32a3c2=_0x25ec0c;return this['strategy'][_0x32a3c2(0x172)](_0x139ec2);}['onTrade'](_0x260570){const _0x4a9f34=_0x25ec0c;return this[_0x4a9f34(0x143)][_0x4a9f34(0x13c)](_0x260570);}['processBar'](_0x517c9b,_0x4e2b5a){const _0x269f3d=_0x25ec0c;return this['strategy'][_0x269f3d(0x173)](_0x517c9b,_0x4e2b5a);}['initialize'](_0x5a3e4b,_0x4b240b,_0x43a10b){const _0x37d3d8=_0x25ec0c;return this[_0x37d3d8(0x143)]['initialize'](_0x5a3e4b,_0x4b240b,_0x43a10b);}['getAnalysisState'](_0x39e7f9,_0x4a7311){const _0x44c7c9=_0x25ec0c;return this[_0x44c7c9(0x143)]['getAnalysisState'](_0x39e7f9,_0x4a7311);}['recordTradeResult'](_0x3a8e0f){const _0x31841a=_0x25ec0c;return this[_0x31841a(0x143)][_0x31841a(0x124)](_0x3a8e0f);}[_0x25ec0c(0x17d)](_0x22890e){const _0x2bc4c5=_0x25ec0c;return this[_0x2bc4c5(0x143)][_0x2bc4c5(0x17d)](_0x22890e);}['getStats'](){return this['strategy']['getStats']();}[_0x25ec0c(0x144)](_0x2b734b){const _0x4039f4=_0x25ec0c;return this['strategy'][_0x4039f4(0x144)](_0x2b734b);}['getModelValues'](_0x4c7224){return this['strategy']['getModelValues'](_0x4c7224);}[_0x25ec0c(0x123)](_0x285148){const _0x2e749c=_0x25ec0c;return this[_0x2e749c(0x143)]['shouldExitByZScore'](_0x285148);}[_0x25ec0c(0x14a)](_0x5b2bb5){return null;}}module['exports']={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};