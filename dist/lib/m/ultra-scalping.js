const _0x2f642f=_0xc24e;(function(_0x534985,_0x43b609){const _0x144ed8=_0xc24e,_0x4f2c1b=_0x534985();while(!![]){try{const _0x14585b=parseInt(_0x144ed8(0x1c1))/0x1+parseInt(_0x144ed8(0x209))/0x2*(parseInt(_0x144ed8(0x1d3))/0x3)+parseInt(_0x144ed8(0x1cd))/0x4+-parseInt(_0x144ed8(0x222))/0x5*(-parseInt(_0x144ed8(0x1c5))/0x6)+parseInt(_0x144ed8(0x1f9))/0x7*(parseInt(_0x144ed8(0x1fe))/0x8)+parseInt(_0x144ed8(0x20a))/0x9+-parseInt(_0x144ed8(0x1eb))/0xa*(parseInt(_0x144ed8(0x221))/0xb);if(_0x14585b===_0x43b609)break;else _0x4f2c1b['push'](_0x4f2c1b['shift']());}catch(_0x4967e7){_0x4f2c1b['push'](_0x4f2c1b['shift']());}}}(_0x48c6,0x5f6c4));const EventEmitter=require('events'),{v4:uuidv4}=require(_0x2f642f(0x1de)),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};function _0xc24e(_0x283884,_0x5434b3){_0x283884=_0x283884-0x1c1;const _0x48c67c=_0x48c6();let _0xc24e09=_0x48c67c[_0x283884];return _0xc24e09;}class HQXUltraScalping extends EventEmitter{constructor(_0x2414d4={}){const _0x3f1b40=_0x2f642f;super(),this['tickSize']=_0x2414d4[_0x3f1b40(0x225)]||0.25,this['tickValue']=_0x2414d4[_0x3f1b40(0x1ec)]||0x5,this[_0x3f1b40(0x1f8)]=1.5,this[_0x3f1b40(0x1f0)]=0.5,this[_0x3f1b40(0x22b)]=0x32,this['vpinToxicThreshold']=0.7,this['kalmanProcessNoise']=0.01,this[_0x3f1b40(0x1ca)]=0.1,this[_0x3f1b40(0x214)]=0x64,this['ofiLookback']=0x14,this[_0x3f1b40(0x204)]=0x8,this['baseTargetTicks']=0x10,this[_0x3f1b40(0x207)]=0x4,this[_0x3f1b40(0x21b)]=0.5,this[_0x3f1b40(0x1d7)]=0.55,this[_0x3f1b40(0x1cf)]={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this['barHistory']=new Map(),this['priceBuffer']=new Map(),this[_0x3f1b40(0x228)]=new Map(),this[_0x3f1b40(0x1f5)]=new Map(),this[_0x3f1b40(0x1da)]=new Map(),this[_0x3f1b40(0x22c)]=[],this['winStreak']=0x0,this[_0x3f1b40(0x1c7)]=0x0,this['lastSignalTime']=0x0,this[_0x3f1b40(0x1d2)]=0x7530,this['minHoldTimeMs']=0x2710,this[_0x3f1b40(0x218)]={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}['initialize'](_0x399a09,_0x345ef3=0.25,_0x2b342b=0x5){const _0x22c560=_0x2f642f;this['tickSize']=_0x345ef3,this[_0x22c560(0x1ec)]=_0x2b342b,this['barHistory'][_0x22c560(0x1e4)](_0x399a09,[]),this['priceBuffer'][_0x22c560(0x1e4)](_0x399a09,[]),this['volumeBuffer']['set'](_0x399a09,[]),this[_0x22c560(0x1da)][_0x22c560(0x1e4)](_0x399a09,[]),this['kalmanStates'][_0x22c560(0x1e4)](_0x399a09,{'estimate':0x0,'errorCovariance':0x1}),this[_0x22c560(0x1e3)](_0x22c560(0x21c),{'type':_0x22c560(0x1fb),'message':'[HQX-UltraScalping]\x20Initialized\x20for\x20'+_0x399a09+_0x22c560(0x22f)+_0x345ef3+_0x22c560(0x227)+_0x2b342b}),this['emit']('log',{'type':_0x22c560(0x1fb),'message':'[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)'});}[_0x2f642f(0x1e7)](_0x75bef9){const _0x1da886=_0x2f642f,{contractId:_0x20709,price:_0x3c4554,volume:_0x59081c,side:_0x4553c2,timestamp:_0x329465}=_0x75bef9,_0x311f44={'timestamp':_0x329465||Date[_0x1da886(0x1d4)](),'open':_0x3c4554,'high':_0x3c4554,'low':_0x3c4554,'close':_0x3c4554,'volume':_0x59081c||0x1};return this[_0x1da886(0x1f7)](_0x20709,_0x311f44);}['onTick'](_0x2bb0ab){const _0x2f43a1=_0x2f642f;return this[_0x2f43a1(0x1e7)](_0x2bb0ab);}[_0x2f642f(0x1c3)](_0x409667){const _0x5b3a82=_0x2f642f;return this['processTick']({'contractId':_0x409667['contractId']||_0x409667['symbol'],'price':_0x409667['price'],'volume':_0x409667['size']||_0x409667[_0x5b3a82(0x20f)]||0x1,'side':_0x409667['side'],'timestamp':_0x409667['timestamp']||Date[_0x5b3a82(0x1d4)]()});}['processBar'](_0x26a6fa,_0x5b1f4c){const _0x4a78ef=_0x2f642f;let _0xf19f87=this[_0x4a78ef(0x1d6)]['get'](_0x26a6fa);!_0xf19f87&&(this['initialize'](_0x26a6fa),_0xf19f87=this[_0x4a78ef(0x1d6)][_0x4a78ef(0x21f)](_0x26a6fa));_0xf19f87[_0x4a78ef(0x202)](_0x5b1f4c);if(_0xf19f87['length']>0x1f4)_0xf19f87[_0x4a78ef(0x203)]();const _0x35caf7=this['priceBuffer'][_0x4a78ef(0x21f)](_0x26a6fa);_0x35caf7['push'](_0x5b1f4c[_0x4a78ef(0x1e0)]);if(_0x35caf7[_0x4a78ef(0x219)]>0xc8)_0x35caf7[_0x4a78ef(0x203)]();const _0x561b2f=this[_0x4a78ef(0x228)]['get'](_0x26a6fa),_0x572621=_0x5b1f4c[_0x4a78ef(0x210)]-_0x5b1f4c['low'];let _0x541019=_0x5b1f4c['volume']*0.5,_0x548299=_0x5b1f4c['volume']*0.5;if(_0x572621>0x0){const _0x34f7a3=(_0x5b1f4c['close']-_0x5b1f4c[_0x4a78ef(0x1cb)])/_0x572621;_0x541019=_0x5b1f4c[_0x4a78ef(0x20f)]*_0x34f7a3,_0x548299=_0x5b1f4c[_0x4a78ef(0x20f)]*(0x1-_0x34f7a3);}_0x561b2f['push']({'buy':_0x541019,'sell':_0x548299});if(_0x561b2f['length']>0x64)_0x561b2f['shift']();if(_0xf19f87[_0x4a78ef(0x219)]<0x32)return null;const _0x31da01=this['_computeZScore'](_0x35caf7),_0x56ba55=this[_0x4a78ef(0x1ce)](_0x561b2f),_0x2673a5=this['_computeKyleLambda'](_0xf19f87),_0x16f9fd=this['_applyKalmanFilter'](_0x26a6fa,_0x5b1f4c[_0x4a78ef(0x1e0)]),{regime:_0x412535,params:_0x116ada}=this['_detectVolatilityRegime'](_0x26a6fa,_0xf19f87),_0x4bf2f5=this[_0x4a78ef(0x1ee)](_0xf19f87);return this['_generateSignal'](_0x26a6fa,_0x5b1f4c[_0x4a78ef(0x1e0)],_0x31da01,_0x56ba55,_0x2673a5,_0x16f9fd,_0x412535,_0x116ada,_0x4bf2f5,_0xf19f87);}['_computeZScore'](_0x1161cd,_0x164df5=0x32){const _0x29e0cd=_0x2f642f;if(_0x1161cd[_0x29e0cd(0x219)]<_0x164df5)return 0x0;const _0xca41d6=_0x1161cd[_0x29e0cd(0x201)](-_0x164df5),_0x3d6b74=_0xca41d6[_0x29e0cd(0x21a)]((_0x438fb5,_0x5d2b28)=>_0x438fb5+_0x5d2b28,0x0)/_0x164df5,_0x3f2d03=_0xca41d6['reduce']((_0x31e357,_0xa39a04)=>_0x31e357+Math['pow'](_0xa39a04-_0x3d6b74,0x2),0x0)/_0x164df5,_0x56c7a2=Math['sqrt'](_0x3f2d03);if(_0x56c7a2<0.0001)return 0x0;const _0x101e32=_0x1161cd[_0x1161cd['length']-0x1];return(_0x101e32-_0x3d6b74)/_0x56c7a2;}[_0x2f642f(0x1ce)](_0x396c66){const _0x47d144=_0x2f642f;if(_0x396c66[_0x47d144(0x219)]<this['vpinWindow'])return 0.5;const _0x3437ba=_0x396c66['slice'](-this[_0x47d144(0x22b)]);let _0x2c7542=0x0,_0x5c01ab=0x0;for(const _0x448869 of _0x3437ba){_0x2c7542+=_0x448869['buy'],_0x5c01ab+=_0x448869[_0x47d144(0x200)];}const _0x430093=_0x2c7542+_0x5c01ab;if(_0x430093<0x1)return 0.5;return Math['abs'](_0x2c7542-_0x5c01ab)/_0x430093;}[_0x2f642f(0x20c)](_0x2ecd65){const _0x24d324=_0x2f642f;if(_0x2ecd65[_0x24d324(0x219)]<0x14)return 0x0;const _0x158b71=_0x2ecd65['slice'](-0x14),_0x25477e=[],_0xbe90ab=[];for(let _0x48142a=0x1;_0x48142a<_0x158b71['length'];_0x48142a++){_0x25477e[_0x24d324(0x202)](_0x158b71[_0x48142a][_0x24d324(0x1e0)]-_0x158b71[_0x48142a-0x1]['close']),_0xbe90ab[_0x24d324(0x202)](_0x158b71[_0x48142a]['volume']);}const _0x56e280=_0x25477e[_0x24d324(0x21a)]((_0x35b610,_0x11c18c)=>_0x35b610+_0x11c18c,0x0)/_0x25477e['length'],_0x294f35=_0xbe90ab['reduce']((_0x7fc270,_0x4ee76a)=>_0x7fc270+_0x4ee76a,0x0)/_0xbe90ab[_0x24d324(0x219)];let _0x5675fd=0x0,_0x302fd0=0x0;for(let _0x485f43=0x0;_0x485f43<_0x25477e[_0x24d324(0x219)];_0x485f43++){_0x5675fd+=(_0x25477e[_0x485f43]-_0x56e280)*(_0xbe90ab[_0x485f43]-_0x294f35),_0x302fd0+=Math['pow'](_0xbe90ab[_0x485f43]-_0x294f35,0x2);}_0x5675fd/=_0x25477e['length'],_0x302fd0/=_0x25477e[_0x24d324(0x219)];if(_0x302fd0<0.0001)return 0x0;return Math[_0x24d324(0x1e8)](_0x5675fd/_0x302fd0);}[_0x2f642f(0x1c4)](_0x30a1f0,_0x5665d3){const _0x1639e6=_0x2f642f;let _0x2ad690=this[_0x1639e6(0x1f5)]['get'](_0x30a1f0);if(!_0x2ad690)return _0x2ad690={'estimate':_0x5665d3,'errorCovariance':0x1},this[_0x1639e6(0x1f5)][_0x1639e6(0x1e4)](_0x30a1f0,_0x2ad690),_0x5665d3;const _0x1592b8=_0x2ad690[_0x1639e6(0x224)],_0x5d2221=_0x2ad690[_0x1639e6(0x1d9)]+this['kalmanProcessNoise'],_0x242476=_0x5d2221/(_0x5d2221+this['kalmanMeasurementNoise']),_0x206629=_0x1592b8+_0x242476*(_0x5665d3-_0x1592b8),_0x9d4e0d=(0x1-_0x242476)*_0x5d2221;return _0x2ad690['estimate']=_0x206629,_0x2ad690['errorCovariance']=_0x9d4e0d,_0x206629;}[_0x2f642f(0x1fc)](_0x114c0f,_0x36e0ae){const _0x42027e=_0x2f642f,_0x270f51=this['_calculateATR'](_0x36e0ae),_0x1bcad5=_0x270f51/this['tickSize'];let _0x327f56=this[_0x42027e(0x1da)][_0x42027e(0x21f)](_0x114c0f);!_0x327f56&&(_0x327f56=[],this['atrHistory']['set'](_0x114c0f,_0x327f56));_0x327f56['push'](_0x270f51);if(_0x327f56[_0x42027e(0x219)]>0x1f4)_0x327f56[_0x42027e(0x203)]();let _0x49426c=0.5;_0x327f56[_0x42027e(0x219)]>=0x14&&(_0x49426c=_0x327f56['filter'](_0x280a36=>_0x280a36<=_0x270f51)['length']/_0x327f56[_0x42027e(0x219)]);let _0x4f0473,_0x49115d;if(_0x49426c<0.25)_0x4f0473='low',_0x49115d={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x49426c<0.75?(_0x4f0473=_0x42027e(0x1fd),_0x49115d={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0x4f0473=_0x42027e(0x210),_0x49115d={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0x4f0473,'params':_0x49115d};}['_calculateATR'](_0x28314f,_0x3fc9b2=0xe){const _0x47e4f8=_0x2f642f;if(_0x28314f['length']<_0x3fc9b2+0x1)return 2.5;const _0x1252a8=[];for(let _0x1ec026=_0x28314f[_0x47e4f8(0x219)]-_0x3fc9b2;_0x1ec026<_0x28314f['length'];_0x1ec026++){const _0x2e3a81=_0x28314f[_0x1ec026],_0xc80a30=_0x28314f[_0x1ec026-0x1][_0x47e4f8(0x1e0)],_0x8e586d=Math['max'](_0x2e3a81['high']-_0x2e3a81['low'],Math[_0x47e4f8(0x1e8)](_0x2e3a81[_0x47e4f8(0x210)]-_0xc80a30),Math[_0x47e4f8(0x1e8)](_0x2e3a81['low']-_0xc80a30));_0x1252a8['push'](_0x8e586d);}return _0x1252a8['reduce']((_0x52e839,_0x2313d0)=>_0x52e839+_0x2313d0,0x0)/_0x1252a8['length'];}[_0x2f642f(0x1ee)](_0x52aaaa){const _0x12b781=_0x2f642f;if(_0x52aaaa['length']<this[_0x12b781(0x1fa)])return 0x0;const _0x58a42e=_0x52aaaa['slice'](-this['ofiLookback']);let _0x5e22c9=0x0,_0x3e4a54=0x0;for(const _0x3604d4 of _0x58a42e){const _0x564bb5=_0x3604d4['high']-_0x3604d4['low'];if(_0x564bb5>0x0){const _0x2252e8=(_0x3604d4[_0x12b781(0x1e0)]-_0x3604d4[_0x12b781(0x1cb)])/_0x564bb5;_0x5e22c9+=_0x2252e8*_0x3604d4['volume'],_0x3e4a54+=(0x1-_0x2252e8)*_0x3604d4['volume'];}}const _0x1a545c=_0x5e22c9+_0x3e4a54;if(_0x1a545c<0x1)return 0x0;return(_0x5e22c9-_0x3e4a54)/_0x1a545c;}[_0x2f642f(0x1e6)](_0x572768,_0x33d398,_0x5732c7,_0x285202,_0x1efeb9,_0x28e662,_0x37fb21,_0x3733a1,_0x58ba42,_0x240380){const _0x59ebe3=_0x2f642f,_0x95c4f8=Math[_0x59ebe3(0x1e8)](_0x5732c7);if(_0x95c4f8<_0x3733a1['zscoreThreshold'])return null;if(_0x285202>this['vpinToxicThreshold'])return null;let _0x270e0c;if(_0x5732c7<-_0x3733a1[_0x59ebe3(0x1d8)])_0x270e0c=_0x59ebe3(0x21d);else{if(_0x5732c7>_0x3733a1[_0x59ebe3(0x1d8)])_0x270e0c=_0x59ebe3(0x223);else return null;}const _0x1d3ef6=_0x270e0c==='long'&&_0x58ba42>0.1||_0x270e0c===_0x59ebe3(0x223)&&_0x58ba42<-0.1,_0x1fb89e=_0x33d398-_0x28e662,_0x3bf8d6=_0x270e0c===_0x59ebe3(0x21d)&&_0x1fb89e<0x0||_0x270e0c==='short'&&_0x1fb89e>0x0,_0x3c3886={'zscore':Math['min'](0x1,_0x95c4f8/0x4),'vpin':0x1-_0x285202,'kyleLambda':_0x1efeb9>0.001?0.5:0.8,'kalman':_0x3bf8d6?0.8:0.4,'volatility':_0x37fb21===_0x59ebe3(0x1fd)?0.8:_0x37fb21==='low'?0.7:0.6,'ofi':_0x1d3ef6?0.9:0.5,'composite':0x0};_0x3c3886[_0x59ebe3(0x1d0)]=_0x3c3886[_0x59ebe3(0x1cc)]*this[_0x59ebe3(0x1cf)]['zscore']+_0x3c3886['vpin']*this['weights']['vpin']+_0x3c3886[_0x59ebe3(0x20e)]*this['weights']['kyleLambda']+_0x3c3886['kalman']*this['weights']['kalman']+_0x3c3886[_0x59ebe3(0x1d1)]*this[_0x59ebe3(0x1cf)][_0x59ebe3(0x1d1)]+_0x3c3886['ofi']*this[_0x59ebe3(0x1cf)][_0x59ebe3(0x216)];const _0x3f8db7=Math['min'](0x1,_0x3c3886['composite']+_0x3733a1[_0x59ebe3(0x213)]);if(_0x3f8db7<this['minConfidence'])return null;if(Date['now']()-this['lastSignalTime']<this['cooldownMs'])return null;const _0x5bc68e=Math['round'](this['baseStopTicks']*_0x3733a1['stopMultiplier']),_0x768062=Math[_0x59ebe3(0x20b)](this[_0x59ebe3(0x22e)]*_0x3733a1['targetMultiplier']),_0x31307c=Math['max'](0x6,Math['min'](0xc,_0x5bc68e)),_0x206f74=Math['max'](_0x31307c*1.5,Math['min'](0x18,_0x768062));let _0x15c472,_0x11d4bb,_0x118339,_0x7e3ca2;_0x270e0c===_0x59ebe3(0x21d)?(_0x15c472=_0x33d398-_0x31307c*this['tickSize'],_0x11d4bb=_0x33d398+_0x206f74*this[_0x59ebe3(0x225)],_0x118339=_0x33d398+this['breakevenTicks']*this[_0x59ebe3(0x225)],_0x7e3ca2=_0x33d398+_0x206f74*this[_0x59ebe3(0x21b)]*this[_0x59ebe3(0x225)]):(_0x15c472=_0x33d398+_0x31307c*this['tickSize'],_0x11d4bb=_0x33d398-_0x206f74*this['tickSize'],_0x118339=_0x33d398-this['breakevenTicks']*this[_0x59ebe3(0x225)],_0x7e3ca2=_0x33d398-_0x206f74*this['profitLockPct']*this['tickSize']);const _0x52be1d=_0x206f74/_0x31307c,_0x72d77b=Math[_0x59ebe3(0x20b)](_0x206f74*0.5),_0x285a79=Math['round'](_0x31307c*0.4);let _0x28ac1c=SignalStrength[_0x59ebe3(0x208)];if(_0x3f8db7>=0.85)_0x28ac1c=SignalStrength['VERY_STRONG'];else{if(_0x3f8db7>=0.75)_0x28ac1c=SignalStrength['STRONG'];else{if(_0x3f8db7<0.6)_0x28ac1c=SignalStrength['WEAK'];}}const _0x2fd433=0.5+(_0x3f8db7-0.5)*0.4,_0x5483cb=_0x2fd433*Math['abs'](_0x11d4bb-_0x33d398)-(0x1-_0x2fd433)*Math[_0x59ebe3(0x1e8)](_0x33d398-_0x15c472);this[_0x59ebe3(0x1d5)]=Date[_0x59ebe3(0x1d4)](),this[_0x59ebe3(0x218)][_0x59ebe3(0x1f4)]++;const _0x4c8b68={'id':uuidv4(),'timestamp':Date[_0x59ebe3(0x1d4)](),'symbol':_0x572768['split']('.')[0x0]||_0x572768,'contractId':_0x572768,'side':_0x270e0c===_0x59ebe3(0x21d)?OrderSide[_0x59ebe3(0x1e2)]:OrderSide[_0x59ebe3(0x1c2)],'direction':_0x270e0c,'strategy':_0x59ebe3(0x1f2),'strength':_0x28ac1c,'edge':_0x5483cb,'confidence':_0x3f8db7,'entry':_0x33d398,'entryPrice':_0x33d398,'stopLoss':_0x15c472,'takeProfit':_0x11d4bb,'riskReward':_0x52be1d,'stopTicks':_0x31307c,'targetTicks':_0x206f74,'trailTriggerTicks':_0x72d77b,'trailDistanceTicks':_0x285a79,'beBreakeven':_0x118339,'profitLockLevel':_0x7e3ca2,'zScore':_0x5732c7,'zScoreExit':this['zscoreExitThreshold'],'vpinValue':_0x285202,'kyleLambda':_0x1efeb9,'kalmanEstimate':_0x28e662,'volatilityRegime':_0x37fb21,'ofiValue':_0x58ba42,'models':_0x3c3886,'orderFlowConfirmed':_0x1d3ef6,'kalmanConfirmed':_0x3bf8d6,'expires':Date['now']()+0xea60};return this[_0x59ebe3(0x1e3)](_0x59ebe3(0x229),{'side':_0x270e0c===_0x59ebe3(0x21d)?_0x59ebe3(0x217):'sell','action':_0x59ebe3(0x220),'reason':'Z='+_0x5732c7['toFixed'](0x2)+_0x59ebe3(0x1e5)+(_0x285202*0x64)['toFixed'](0x0)+'%,\x20OFI='+(_0x58ba42*0x64)[_0x59ebe3(0x1f6)](0x0)+_0x59ebe3(0x215)+(_0x3f8db7*0x64)['toFixed'](0x0)+'%',..._0x4c8b68}),this['emit']('log',{'type':_0x59ebe3(0x1fb),'message':'[HQX]\x20SIGNAL:\x20'+_0x270e0c['toUpperCase']()+'\x20@\x20'+_0x33d398[_0x59ebe3(0x1f6)](0x2)+'\x20|\x20Z:'+_0x5732c7['toFixed'](0x2)+'\x20VPIN:'+(_0x285202*0x64)[_0x59ebe3(0x1f6)](0x0)+_0x59ebe3(0x1ff)+(_0x58ba42*0x64)[_0x59ebe3(0x1f6)](0x0)+_0x59ebe3(0x21e)+_0x1efeb9['toFixed'](0x5)+'\x20Regime:'+_0x37fb21+_0x59ebe3(0x1df)+(_0x3f8db7*0x64)[_0x59ebe3(0x1f6)](0x0)+'%'}),_0x4c8b68;}['shouldExitByZScore'](_0x35553e){const _0x3100b2=_0x2f642f,_0x4d18f6=this[_0x3100b2(0x1dc)][_0x3100b2(0x21f)](_0x35553e);if(!_0x4d18f6||_0x4d18f6['length']<0x32)return![];const _0x25f249=this[_0x3100b2(0x22a)](_0x4d18f6);return Math['abs'](_0x25f249)<this[_0x3100b2(0x1f0)];}[_0x2f642f(0x226)](_0x20f79c){const _0x3967e1=_0x2f642f,_0x453533=this[_0x3967e1(0x1dc)]['get'](_0x20f79c),_0x43daf0=this['volumeBuffer']['get'](_0x20f79c),_0x1e60be=this[_0x3967e1(0x1d6)]['get'](_0x20f79c);if(!_0x453533||!_0x43daf0||!_0x1e60be||_0x1e60be['length']<0x32)return null;const _0x1a1dc9=this['_computeZScore'](_0x453533),_0x14c4da=this[_0x3967e1(0x1ce)](_0x43daf0),_0x39dceb=this[_0x3967e1(0x20c)](_0x1e60be),_0x4a2092=this['_computeOrderFlowImbalance'](_0x1e60be);return{'zscore':Math[_0x3967e1(0x1f3)](0x1,Math['abs'](_0x1a1dc9)/0x4),'vpin':0x1-_0x14c4da,'kyleLambda':_0x39dceb>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math[_0x3967e1(0x1e8)](_0x4a2092)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x1a1dc9,'vpin':_0x14c4da,'kyleLambda':_0x39dceb,'ofi':_0x4a2092}};}[_0x2f642f(0x1ef)](_0x15937a,_0x56b1e5){const _0x4e2ee8=_0x2f642f,_0x139953=this['barHistory']['get'](_0x15937a)||[];if(_0x139953[_0x4e2ee8(0x219)]<0x32)return{'ready':![],'message':_0x4e2ee8(0x206)+_0x139953[_0x4e2ee8(0x219)]+'/50\x20bars'};const _0x119888=this['priceBuffer'][_0x4e2ee8(0x21f)](_0x15937a)||[],_0x57c1cf=this[_0x4e2ee8(0x228)]['get'](_0x15937a)||[],_0x19f0b4=this[_0x4e2ee8(0x22a)](_0x119888),_0x921872=this[_0x4e2ee8(0x1ce)](_0x57c1cf),_0x5def40=this['_computeOrderFlowImbalance'](_0x139953),_0xc85c2b=this[_0x4e2ee8(0x20c)](_0x139953),{regime:_0x16c6d5,params:_0x1a43c5}=this['_detectVolatilityRegime'](_0x15937a,_0x139953);return{'ready':!![],'zScore':_0x19f0b4,'vpin':_0x921872,'ofi':_0x5def40,'kyleLambda':_0xc85c2b,'regime':_0x16c6d5,'stopTicks':Math['round'](this['baseStopTicks']*_0x1a43c5['stopMultiplier']),'targetTicks':Math['round'](this['baseTargetTicks']*_0x1a43c5[_0x4e2ee8(0x205)]),'threshold':_0x1a43c5['zscoreThreshold'],'barsProcessed':_0x139953['length'],'models':'6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)'};}[_0x2f642f(0x1db)](_0x34f4ee){const _0x27c887=_0x2f642f;this[_0x27c887(0x22c)][_0x27c887(0x202)]({'netPnl':_0x34f4ee,'timestamp':Date[_0x27c887(0x1d4)]()});if(this['recentTrades'][_0x27c887(0x219)]>0x64)this['recentTrades'][_0x27c887(0x203)]();_0x34f4ee>0x0?(this['winStreak']++,this[_0x27c887(0x1c7)]=0x0,this['stats']['wins']++):(this[_0x27c887(0x1c7)]++,this['winStreak']=0x0,this[_0x27c887(0x218)][_0x27c887(0x22d)]++),this['stats'][_0x27c887(0x20d)]++,this['stats'][_0x27c887(0x1f1)]+=_0x34f4ee,this['emit'](_0x27c887(0x21c),{'type':'debug','message':_0x27c887(0x1c8)+(_0x34f4ee>0x0?'WIN':_0x27c887(0x1ea))+'\x20$'+_0x34f4ee[_0x27c887(0x1f6)](0x2)+_0x27c887(0x1c9)+(_0x34f4ee>0x0?this['winStreak']:-this['lossStreak'])});}['getBarHistory'](_0x93968b){const _0x132087=_0x2f642f;return this['barHistory'][_0x132087(0x21f)](_0x93968b)||[];}[_0x2f642f(0x1ed)](){return this['stats'];}[_0x2f642f(0x1dd)](_0x5bcc92){const _0x58220e=_0x2f642f;this['barHistory'][_0x58220e(0x1e4)](_0x5bcc92,[]),this['priceBuffer']['set'](_0x5bcc92,[]),this['volumeBuffer']['set'](_0x5bcc92,[]),this[_0x58220e(0x1da)][_0x58220e(0x1e4)](_0x5bcc92,[]),this['kalmanStates']['set'](_0x5bcc92,{'estimate':0x0,'errorCovariance':0x1}),this[_0x58220e(0x1e3)]('log',{'type':'info','message':'[HQX-UltraScalping]\x20Reset\x20state\x20for\x20'+_0x5bcc92});}}class UltraScalpingStrategy extends EventEmitter{constructor(_0x1c68b9={}){const _0x27786d=_0x2f642f;super(),this['config']=_0x1c68b9,this[_0x27786d(0x211)]=new HQXUltraScalping(_0x1c68b9),this['strategy']['on'](_0x27786d(0x229),_0x26640d=>this['emit'](_0x27786d(0x229),_0x26640d)),this['strategy']['on']('log',_0x24647b=>this['emit']('log',_0x24647b));}[_0x2f642f(0x1e7)](_0x43265a){const _0x1c2d27=_0x2f642f;return this[_0x1c2d27(0x211)][_0x1c2d27(0x1e7)](_0x43265a);}['onTick'](_0x3d1505){return this['strategy']['onTick'](_0x3d1505);}['onTrade'](_0x4b9f05){const _0x62a743=_0x2f642f;return this[_0x62a743(0x211)][_0x62a743(0x1c3)](_0x4b9f05);}['processBar'](_0xfb06fb,_0x5935b6){return this['strategy']['processBar'](_0xfb06fb,_0x5935b6);}['initialize'](_0x38e2e1,_0x4aea8e,_0x3d4b0f){const _0x1997da=_0x2f642f;return this['strategy'][_0x1997da(0x212)](_0x38e2e1,_0x4aea8e,_0x3d4b0f);}[_0x2f642f(0x1ef)](_0x366f26,_0x32c33d){const _0x5074bc=_0x2f642f;return this[_0x5074bc(0x211)][_0x5074bc(0x1ef)](_0x366f26,_0x32c33d);}['recordTradeResult'](_0x1c8b45){const _0x49a1ad=_0x2f642f;return this[_0x49a1ad(0x211)]['recordTradeResult'](_0x1c8b45);}[_0x2f642f(0x1dd)](_0x5b64d8){const _0x250714=_0x2f642f;return this['strategy'][_0x250714(0x1dd)](_0x5b64d8);}['getStats'](){const _0x31780e=_0x2f642f;return this[_0x31780e(0x211)][_0x31780e(0x1ed)]();}['getBarHistory'](_0x48fbb3){const _0x40b812=_0x2f642f;return this[_0x40b812(0x211)][_0x40b812(0x1c6)](_0x48fbb3);}[_0x2f642f(0x226)](_0x3120e1){const _0x1c5a1e=_0x2f642f;return this['strategy'][_0x1c5a1e(0x226)](_0x3120e1);}['shouldExitByZScore'](_0x572f72){const _0x4a0aa1=_0x2f642f;return this['strategy'][_0x4a0aa1(0x1e1)](_0x572f72);}[_0x2f642f(0x1e9)](_0x1df7f7){return null;}}module['exports']={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};function _0x48c6(){const _0x147040=['reset','uuid','\x20|\x20Conf:','close','shouldExitByZScore','BID','emit','set',',\x20VPIN=','_generateSignal','processTick','abs','generateSignal','LOSS','10eDFdqK','tickValue','getStats','_computeOrderFlowImbalance','getAnalysisState','zscoreExitThreshold','pnl','HQX_ULTRA_SCALPING_6MODELS','min','signals','kalmanStates','toFixed','processBar','zscoreEntryThreshold','42OUKcWP','ofiLookback','info','_detectVolatilityRegime','normal','756384ICUZpV','%\x20OFI:','sell','slice','push','shift','baseStopTicks','targetMultiplier','Collecting\x20data...\x20','breakevenTicks','MODERATE','2JHluhv','1314171KXLtHF','round','_computeKyleLambda','trades','kyleLambda','volume','high','strategy','initialize','confidenceBonus','volatilityLookback','%,\x20cf=','ofi','buy','stats','length','reduce','profitLockPct','log','long','%\x20Kyle:','get','open','14929277lhfYna','1563010cOsStZ','short','estimate','tickSize','getModelValues',',\x20value=','volumeBuffer','signal','_computeZScore','vpinWindow','recentTrades','losses','baseTargetTicks',':\x20tick=','430726yXGdiw','ASK','onTrade','_applyKalmanFilter','6icBfld','getBarHistory','lossStreak','[HQX]\x20Trade\x20result:\x20',',\x20streak:\x20','kalmanMeasurementNoise','low','zscore','749528SyvYql','_computeVPIN','weights','composite','volatility','cooldownMs','312126MTruvf','now','lastSignalTime','barHistory','minConfidence','zscoreThreshold','errorCovariance','atrHistory','recordTradeResult','priceBuffer'];_0x48c6=function(){return _0x147040;};return _0x48c6();}