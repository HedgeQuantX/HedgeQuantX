function _0x3345(_0x56629d,_0x322f3d){_0x56629d=_0x56629d-0x66;const _0x174987=_0x1749();let _0x33452d=_0x174987[_0x56629d];return _0x33452d;}function _0x1749(){const _0x1a5cc1=['stats','filter','low','kalman','getAnalysisState','round','getBarHistory','zscoreThreshold','getStats','/50\x20bars','breakevenTicks','long','3754849HJrzQG','signal','symbol','_computeKyleLambda','recordTradeResult','exports','2283596BrBbVD','get','recentTrades','8IvRMqH','_computeZScore','onTrade','4900508ddAIRv','baseTargetTicks','tickSize','info','VERY_STRONG','\x20|\x20Z:','timestamp',',\x20value=','processTick','shift','slice','confidenceBonus','volumeBuffer','vpin','tickValue','push','_detectVolatilityRegime','22597452BnaAGL','close','volatility','set','HQX_ULTRA_SCALPING_6MODELS','shouldExitByZScore','volume','LOSS','generateSignal','ofi','errorCovariance','186557gzHayF','max','reset','vpinWindow','minConfidence','WIN','price','composite','log','abs','_computeVPIN','\x20@\x20','kalmanMeasurementNoise','buy','kalmanProcessNoise','5IljWaD','strategy','atrHistory','pow','minHoldTimeMs','side','length','barHistory','pnl','lossStreak','reduce','%,\x20OFI=','estimate','kalmanStates','7764024allXzL','weights','high','zscoreExitThreshold','priceBuffer','STRONG','open','37374tZlrfZ','uuid','processBar','_generateSignal','zscore','[HQX]\x20SIGNAL:\x20','toFixed','cooldownMs','normal','min','onTick','now','signals','emit','toUpperCase','winStreak','initialize','[HQX-UltraScalping]\x20Reset\x20state\x20for\x20','profitLockPct'];_0x1749=function(){return _0x1a5cc1;};return _0x1749();}const _0x4ef43a=_0x3345;(function(_0x4dc972,_0xabcca7){const _0x4a3fc9=_0x3345,_0x48b6f6=_0x4dc972();while(!![]){try{const _0x451fe6=parseInt(_0x4a3fc9(0x97))/0x1+parseInt(_0x4a3fc9(0x75))/0x2+-parseInt(_0x4a3fc9(0xbb))/0x3+parseInt(_0x4a3fc9(0x7b))/0x4*(parseInt(_0x4a3fc9(0xa6))/0x5)+parseInt(_0x4a3fc9(0xb4))/0x6+-parseInt(_0x4a3fc9(0x6f))/0x7+parseInt(_0x4a3fc9(0x78))/0x8*(-parseInt(_0x4a3fc9(0x8c))/0x9);if(_0x451fe6===_0xabcca7)break;else _0x48b6f6['push'](_0x48b6f6['shift']());}catch(_0x5a2b14){_0x48b6f6['push'](_0x48b6f6['shift']());}}}(_0x1749,0xc0551));const EventEmitter=require('events'),{v4:uuidv4}=require(_0x4ef43a(0xbc)),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4};class HQXUltraScalping extends EventEmitter{constructor(_0x4ad112={}){const _0x284b93=_0x4ef43a;super(),this[_0x284b93(0x7d)]=_0x4ad112['tickSize']||0.25,this[_0x284b93(0x89)]=_0x4ad112[_0x284b93(0x89)]||0x5,this['zscoreEntryThreshold']=1.5,this[_0x284b93(0xb7)]=0.5,this['vpinWindow']=0x32,this['vpinToxicThreshold']=0.7,this[_0x284b93(0xa5)]=0.01,this[_0x284b93(0xa3)]=0.1,this['volatilityLookback']=0x64,this['ofiLookback']=0x14,this['baseStopTicks']=0x8,this['baseTargetTicks']=0x10,this['breakevenTicks']=0x4,this[_0x284b93(0xcd)]=0.5,this[_0x284b93(0x9b)]=0.55,this['weights']={'zscore':0.3,'ofi':0.2,'vpin':0.15,'kalman':0.15,'kyleLambda':0.1,'volatility':0.1},this[_0x284b93(0xad)]=new Map(),this[_0x284b93(0xb8)]=new Map(),this['volumeBuffer']=new Map(),this['kalmanStates']=new Map(),this[_0x284b93(0xa8)]=new Map(),this['recentTrades']=[],this[_0x284b93(0xca)]=0x0,this['lossStreak']=0x0,this['lastSignalTime']=0x0,this[_0x284b93(0xc2)]=0x7530,this[_0x284b93(0xaa)]=0x2710,this['stats']={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0};}['initialize'](_0x53ddf5,_0x92cc51=0.25,_0x527d53=0x5){const _0x38d11e=_0x4ef43a;this[_0x38d11e(0x7d)]=_0x92cc51,this['tickValue']=_0x527d53,this[_0x38d11e(0xad)]['set'](_0x53ddf5,[]),this['priceBuffer']['set'](_0x53ddf5,[]),this['volumeBuffer']['set'](_0x53ddf5,[]),this[_0x38d11e(0xa8)][_0x38d11e(0x8f)](_0x53ddf5,[]),this['kalmanStates']['set'](_0x53ddf5,{'estimate':0x0,'errorCovariance':0x1}),this[_0x38d11e(0xc8)](_0x38d11e(0x9f),{'type':_0x38d11e(0x7e),'message':'[HQX-UltraScalping]\x20Initialized\x20for\x20'+_0x53ddf5+':\x20tick='+_0x92cc51+_0x38d11e(0x82)+_0x527d53}),this['emit'](_0x38d11e(0x9f),{'type':_0x38d11e(0x7e),'message':'[HQX-UltraScalping]\x206\x20Models:\x20Z-Score(30%),\x20OFI(20%),\x20VPIN(15%),\x20Kalman(15%),\x20Kyle(10%),\x20Vol(10%)'});}[_0x4ef43a(0x83)](_0x56ae0a){const _0x2c5c98=_0x4ef43a,{contractId:_0x4eb987,price:_0x2048f5,volume:_0x4b4e07,side:_0x1f44d4,timestamp:_0x4dc3b8}=_0x56ae0a,_0x4a137b={'timestamp':_0x4dc3b8||Date[_0x2c5c98(0xc6)](),'open':_0x2048f5,'high':_0x2048f5,'low':_0x2048f5,'close':_0x2048f5,'volume':_0x4b4e07||0x1};return this['processBar'](_0x4eb987,_0x4a137b);}[_0x4ef43a(0xc5)](_0x221c55){const _0x5cefb9=_0x4ef43a;return this[_0x5cefb9(0x83)](_0x221c55);}[_0x4ef43a(0x7a)](_0xda68b6){const _0x197f2c=_0x4ef43a;return this[_0x197f2c(0x83)]({'contractId':_0xda68b6['contractId']||_0xda68b6[_0x197f2c(0x71)],'price':_0xda68b6[_0x197f2c(0x9d)],'volume':_0xda68b6['size']||_0xda68b6['volume']||0x1,'side':_0xda68b6[_0x197f2c(0xab)],'timestamp':_0xda68b6[_0x197f2c(0x81)]||Date['now']()});}[_0x4ef43a(0xbd)](_0x4c94cb,_0x30f1b3){const _0xaafdc5=_0x4ef43a;let _0x1c8cb0=this['barHistory'][_0xaafdc5(0x76)](_0x4c94cb);!_0x1c8cb0&&(this[_0xaafdc5(0xcb)](_0x4c94cb),_0x1c8cb0=this[_0xaafdc5(0xad)][_0xaafdc5(0x76)](_0x4c94cb));_0x1c8cb0[_0xaafdc5(0x8a)](_0x30f1b3);if(_0x1c8cb0[_0xaafdc5(0xac)]>0x1f4)_0x1c8cb0['shift']();const _0x4ad596=this[_0xaafdc5(0xb8)][_0xaafdc5(0x76)](_0x4c94cb);_0x4ad596[_0xaafdc5(0x8a)](_0x30f1b3[_0xaafdc5(0x8d)]);if(_0x4ad596[_0xaafdc5(0xac)]>0xc8)_0x4ad596[_0xaafdc5(0x84)]();const _0x42c94b=this[_0xaafdc5(0x87)][_0xaafdc5(0x76)](_0x4c94cb),_0x558fed=_0x30f1b3[_0xaafdc5(0xb6)]-_0x30f1b3[_0xaafdc5(0xd0)];let _0x2e9b86=_0x30f1b3[_0xaafdc5(0x92)]*0.5,_0x3dd352=_0x30f1b3[_0xaafdc5(0x92)]*0.5;if(_0x558fed>0x0){const _0xd8c0b5=(_0x30f1b3[_0xaafdc5(0x8d)]-_0x30f1b3['low'])/_0x558fed;_0x2e9b86=_0x30f1b3[_0xaafdc5(0x92)]*_0xd8c0b5,_0x3dd352=_0x30f1b3[_0xaafdc5(0x92)]*(0x1-_0xd8c0b5);}_0x42c94b[_0xaafdc5(0x8a)]({'buy':_0x2e9b86,'sell':_0x3dd352});if(_0x42c94b[_0xaafdc5(0xac)]>0x64)_0x42c94b['shift']();if(_0x1c8cb0[_0xaafdc5(0xac)]<0x32)return null;const _0x552d05=this[_0xaafdc5(0x79)](_0x4ad596),_0x20d691=this[_0xaafdc5(0xa1)](_0x42c94b),_0xf28454=this['_computeKyleLambda'](_0x1c8cb0),_0x53b925=this['_applyKalmanFilter'](_0x4c94cb,_0x30f1b3[_0xaafdc5(0x8d)]),{regime:_0x48fe4f,params:_0x55fc9d}=this['_detectVolatilityRegime'](_0x4c94cb,_0x1c8cb0),_0x18dfd1=this['_computeOrderFlowImbalance'](_0x1c8cb0);return this[_0xaafdc5(0xbe)](_0x4c94cb,_0x30f1b3[_0xaafdc5(0x8d)],_0x552d05,_0x20d691,_0xf28454,_0x53b925,_0x48fe4f,_0x55fc9d,_0x18dfd1,_0x1c8cb0);}[_0x4ef43a(0x79)](_0xbbb256,_0x3162b7=0x32){const _0x1bbc6e=_0x4ef43a;if(_0xbbb256[_0x1bbc6e(0xac)]<_0x3162b7)return 0x0;const _0x2ae192=_0xbbb256['slice'](-_0x3162b7),_0xedab8=_0x2ae192['reduce']((_0x291c86,_0xef5c39)=>_0x291c86+_0xef5c39,0x0)/_0x3162b7,_0x208c69=_0x2ae192[_0x1bbc6e(0xb0)]((_0x2523f8,_0x398dd7)=>_0x2523f8+Math['pow'](_0x398dd7-_0xedab8,0x2),0x0)/_0x3162b7,_0x36a76d=Math['sqrt'](_0x208c69);if(_0x36a76d<0.0001)return 0x0;const _0x3baeca=_0xbbb256[_0xbbb256[_0x1bbc6e(0xac)]-0x1];return(_0x3baeca-_0xedab8)/_0x36a76d;}[_0x4ef43a(0xa1)](_0x2b1b43){const _0x4a4f3b=_0x4ef43a;if(_0x2b1b43['length']<this[_0x4a4f3b(0x9a)])return 0.5;const _0x21cc6d=_0x2b1b43['slice'](-this['vpinWindow']);let _0x1411b6=0x0,_0x447808=0x0;for(const _0x5b7299 of _0x21cc6d){_0x1411b6+=_0x5b7299[_0x4a4f3b(0xa4)],_0x447808+=_0x5b7299['sell'];}const _0x25879f=_0x1411b6+_0x447808;if(_0x25879f<0x1)return 0.5;return Math['abs'](_0x1411b6-_0x447808)/_0x25879f;}[_0x4ef43a(0x72)](_0x27a809){const _0x1c39de=_0x4ef43a;if(_0x27a809['length']<0x14)return 0x0;const _0x12be04=_0x27a809['slice'](-0x14),_0x40daf5=[],_0x337ef1=[];for(let _0x571c4c=0x1;_0x571c4c<_0x12be04['length'];_0x571c4c++){_0x40daf5['push'](_0x12be04[_0x571c4c]['close']-_0x12be04[_0x571c4c-0x1]['close']),_0x337ef1['push'](_0x12be04[_0x571c4c]['volume']);}const _0x58aaf9=_0x40daf5[_0x1c39de(0xb0)]((_0x16c838,_0x24e596)=>_0x16c838+_0x24e596,0x0)/_0x40daf5[_0x1c39de(0xac)],_0x4e1dc9=_0x337ef1[_0x1c39de(0xb0)]((_0x317d87,_0x46ee99)=>_0x317d87+_0x46ee99,0x0)/_0x337ef1[_0x1c39de(0xac)];let _0x111030=0x0,_0x2cca54=0x0;for(let _0x5789f5=0x0;_0x5789f5<_0x40daf5['length'];_0x5789f5++){_0x111030+=(_0x40daf5[_0x5789f5]-_0x58aaf9)*(_0x337ef1[_0x5789f5]-_0x4e1dc9),_0x2cca54+=Math[_0x1c39de(0xa9)](_0x337ef1[_0x5789f5]-_0x4e1dc9,0x2);}_0x111030/=_0x40daf5[_0x1c39de(0xac)],_0x2cca54/=_0x40daf5[_0x1c39de(0xac)];if(_0x2cca54<0.0001)return 0x0;return Math['abs'](_0x111030/_0x2cca54);}['_applyKalmanFilter'](_0x5cd40c,_0x2625a8){const _0x46c4fb=_0x4ef43a;let _0x56c246=this['kalmanStates'][_0x46c4fb(0x76)](_0x5cd40c);if(!_0x56c246)return _0x56c246={'estimate':_0x2625a8,'errorCovariance':0x1},this[_0x46c4fb(0xb3)]['set'](_0x5cd40c,_0x56c246),_0x2625a8;const _0x412093=_0x56c246['estimate'],_0x4320a2=_0x56c246['errorCovariance']+this[_0x46c4fb(0xa5)],_0x55b2b8=_0x4320a2/(_0x4320a2+this['kalmanMeasurementNoise']),_0x42e39a=_0x412093+_0x55b2b8*(_0x2625a8-_0x412093),_0x447455=(0x1-_0x55b2b8)*_0x4320a2;return _0x56c246[_0x46c4fb(0xb2)]=_0x42e39a,_0x56c246[_0x46c4fb(0x96)]=_0x447455,_0x42e39a;}[_0x4ef43a(0x8b)](_0x3f3eac,_0x2b9300){const _0x40ecee=_0x4ef43a,_0x5e925e=this['_calculateATR'](_0x2b9300),_0x2056e9=_0x5e925e/this['tickSize'];let _0x240aae=this[_0x40ecee(0xa8)]['get'](_0x3f3eac);!_0x240aae&&(_0x240aae=[],this[_0x40ecee(0xa8)]['set'](_0x3f3eac,_0x240aae));_0x240aae[_0x40ecee(0x8a)](_0x5e925e);if(_0x240aae[_0x40ecee(0xac)]>0x1f4)_0x240aae['shift']();let _0x5d3642=0.5;_0x240aae['length']>=0x14&&(_0x5d3642=_0x240aae[_0x40ecee(0xcf)](_0x4be640=>_0x4be640<=_0x5e925e)[_0x40ecee(0xac)]/_0x240aae[_0x40ecee(0xac)]);let _0x42ef13,_0x597f99;if(_0x5d3642<0.25)_0x42ef13=_0x40ecee(0xd0),_0x597f99={'stopMultiplier':0.8,'targetMultiplier':0.9,'zscoreThreshold':1.2,'confidenceBonus':0.05};else _0x5d3642<0.75?(_0x42ef13=_0x40ecee(0xc3),_0x597f99={'stopMultiplier':0x1,'targetMultiplier':0x1,'zscoreThreshold':1.5,'confidenceBonus':0x0}):(_0x42ef13='high',_0x597f99={'stopMultiplier':1.3,'targetMultiplier':1.2,'zscoreThreshold':0x2,'confidenceBonus':-0.05});return{'regime':_0x42ef13,'params':_0x597f99};}['_calculateATR'](_0x1162c2,_0x3ca5fd=0xe){const _0x31b723=_0x4ef43a;if(_0x1162c2['length']<_0x3ca5fd+0x1)return 2.5;const _0x25010f=[];for(let _0x14cc6a=_0x1162c2[_0x31b723(0xac)]-_0x3ca5fd;_0x14cc6a<_0x1162c2['length'];_0x14cc6a++){const _0x48867e=_0x1162c2[_0x14cc6a],_0x340a50=_0x1162c2[_0x14cc6a-0x1]['close'],_0x506341=Math['max'](_0x48867e['high']-_0x48867e['low'],Math[_0x31b723(0xa0)](_0x48867e[_0x31b723(0xb6)]-_0x340a50),Math[_0x31b723(0xa0)](_0x48867e['low']-_0x340a50));_0x25010f['push'](_0x506341);}return _0x25010f[_0x31b723(0xb0)]((_0x392c99,_0x4ee4d6)=>_0x392c99+_0x4ee4d6,0x0)/_0x25010f[_0x31b723(0xac)];}['_computeOrderFlowImbalance'](_0x37f53c){const _0x334246=_0x4ef43a;if(_0x37f53c[_0x334246(0xac)]<this['ofiLookback'])return 0x0;const _0x16427c=_0x37f53c[_0x334246(0x85)](-this['ofiLookback']);let _0x4a7638=0x0,_0x4a1973=0x0;for(const _0x3fdc64 of _0x16427c){const _0xeac481=_0x3fdc64[_0x334246(0xb6)]-_0x3fdc64[_0x334246(0xd0)];if(_0xeac481>0x0){const _0x23490d=(_0x3fdc64['close']-_0x3fdc64['low'])/_0xeac481;_0x4a7638+=_0x23490d*_0x3fdc64['volume'],_0x4a1973+=(0x1-_0x23490d)*_0x3fdc64[_0x334246(0x92)];}}const _0x33dc50=_0x4a7638+_0x4a1973;if(_0x33dc50<0x1)return 0x0;return(_0x4a7638-_0x4a1973)/_0x33dc50;}['_generateSignal'](_0x4359a6,_0x277d7f,_0x30e87a,_0x5a94e3,_0x2fe327,_0x9f43fb,_0x50cfb3,_0xf27a12,_0x5c808d,_0x24e541){const _0x599819=_0x4ef43a,_0x27ddc4=Math[_0x599819(0xa0)](_0x30e87a);if(_0x27ddc4<_0xf27a12['zscoreThreshold'])return null;if(_0x5a94e3>this['vpinToxicThreshold'])return null;let _0x27a2de;if(_0x30e87a<-_0xf27a12[_0x599819(0x6a)])_0x27a2de='long';else{if(_0x30e87a>_0xf27a12[_0x599819(0x6a)])_0x27a2de='short';else return null;}const _0x575132=_0x27a2de===_0x599819(0x6e)&&_0x5c808d>0.1||_0x27a2de==='short'&&_0x5c808d<-0.1,_0x574ea2=_0x277d7f-_0x9f43fb,_0x39c00d=_0x27a2de==='long'&&_0x574ea2<0x0||_0x27a2de==='short'&&_0x574ea2>0x0,_0x17d6d5={'zscore':Math[_0x599819(0xc4)](0x1,_0x27ddc4/0x4),'vpin':0x1-_0x5a94e3,'kyleLambda':_0x2fe327>0.001?0.5:0.8,'kalman':_0x39c00d?0.8:0.4,'volatility':_0x50cfb3===_0x599819(0xc3)?0.8:_0x50cfb3==='low'?0.7:0.6,'ofi':_0x575132?0.9:0.5,'composite':0x0};_0x17d6d5[_0x599819(0x9e)]=_0x17d6d5['zscore']*this['weights'][_0x599819(0xbf)]+_0x17d6d5[_0x599819(0x88)]*this['weights'][_0x599819(0x88)]+_0x17d6d5['kyleLambda']*this['weights']['kyleLambda']+_0x17d6d5[_0x599819(0x66)]*this['weights']['kalman']+_0x17d6d5['volatility']*this[_0x599819(0xb5)][_0x599819(0x8e)]+_0x17d6d5['ofi']*this[_0x599819(0xb5)][_0x599819(0x95)];const _0x2c2e0b=Math[_0x599819(0xc4)](0x1,_0x17d6d5[_0x599819(0x9e)]+_0xf27a12[_0x599819(0x86)]);if(_0x2c2e0b<this['minConfidence'])return null;if(Date[_0x599819(0xc6)]()-this['lastSignalTime']<this['cooldownMs'])return null;const _0x3b0e0d=Math[_0x599819(0x68)](this['baseStopTicks']*_0xf27a12['stopMultiplier']),_0x134055=Math[_0x599819(0x68)](this[_0x599819(0x7c)]*_0xf27a12['targetMultiplier']),_0x4b1088=Math[_0x599819(0x98)](0x6,Math['min'](0xc,_0x3b0e0d)),_0x3cc662=Math['max'](_0x4b1088*1.5,Math['min'](0x18,_0x134055));let _0x9a9a31,_0x577126,_0x469ecc,_0x3571f9;_0x27a2de==='long'?(_0x9a9a31=_0x277d7f-_0x4b1088*this[_0x599819(0x7d)],_0x577126=_0x277d7f+_0x3cc662*this[_0x599819(0x7d)],_0x469ecc=_0x277d7f+this[_0x599819(0x6d)]*this['tickSize'],_0x3571f9=_0x277d7f+_0x3cc662*this['profitLockPct']*this[_0x599819(0x7d)]):(_0x9a9a31=_0x277d7f+_0x4b1088*this['tickSize'],_0x577126=_0x277d7f-_0x3cc662*this['tickSize'],_0x469ecc=_0x277d7f-this['breakevenTicks']*this['tickSize'],_0x3571f9=_0x277d7f-_0x3cc662*this['profitLockPct']*this['tickSize']);const _0x5dd24d=_0x3cc662/_0x4b1088,_0x2ef93d=Math[_0x599819(0x68)](_0x3cc662*0.5),_0x9abe1d=Math[_0x599819(0x68)](_0x4b1088*0.4);let _0x44dbd2=SignalStrength['MODERATE'];if(_0x2c2e0b>=0.85)_0x44dbd2=SignalStrength[_0x599819(0x7f)];else{if(_0x2c2e0b>=0.75)_0x44dbd2=SignalStrength[_0x599819(0xb9)];else{if(_0x2c2e0b<0.6)_0x44dbd2=SignalStrength['WEAK'];}}const _0x11baa1=0.5+(_0x2c2e0b-0.5)*0.4,_0x389b0d=_0x11baa1*Math[_0x599819(0xa0)](_0x577126-_0x277d7f)-(0x1-_0x11baa1)*Math[_0x599819(0xa0)](_0x277d7f-_0x9a9a31);this['lastSignalTime']=Date['now'](),this['stats'][_0x599819(0xc7)]++;const _0x53adc9={'id':uuidv4(),'timestamp':Date['now'](),'symbol':_0x4359a6['split']('.')[0x0]||_0x4359a6,'contractId':_0x4359a6,'side':_0x27a2de===_0x599819(0x6e)?OrderSide['BID']:OrderSide['ASK'],'direction':_0x27a2de,'strategy':_0x599819(0x90),'strength':_0x44dbd2,'edge':_0x389b0d,'confidence':_0x2c2e0b,'entry':_0x277d7f,'entryPrice':_0x277d7f,'stopLoss':_0x9a9a31,'takeProfit':_0x577126,'riskReward':_0x5dd24d,'stopTicks':_0x4b1088,'targetTicks':_0x3cc662,'trailTriggerTicks':_0x2ef93d,'trailDistanceTicks':_0x9abe1d,'beBreakeven':_0x469ecc,'profitLockLevel':_0x3571f9,'zScore':_0x30e87a,'zScoreExit':this[_0x599819(0xb7)],'vpinValue':_0x5a94e3,'kyleLambda':_0x2fe327,'kalmanEstimate':_0x9f43fb,'volatilityRegime':_0x50cfb3,'ofiValue':_0x5c808d,'models':_0x17d6d5,'orderFlowConfirmed':_0x575132,'kalmanConfirmed':_0x39c00d,'expires':Date['now']()+0xea60};return this['emit']('signal',{'side':_0x27a2de==='long'?_0x599819(0xa4):'sell','action':_0x599819(0xba),'reason':'Z='+_0x30e87a[_0x599819(0xc1)](0x2)+',\x20VPIN='+(_0x5a94e3*0x64)['toFixed'](0x0)+_0x599819(0xb1)+(_0x5c808d*0x64)['toFixed'](0x0)+'%,\x20cf='+(_0x2c2e0b*0x64)['toFixed'](0x0)+'%',..._0x53adc9}),this[_0x599819(0xc8)](_0x599819(0x9f),{'type':'info','message':_0x599819(0xc0)+_0x27a2de[_0x599819(0xc9)]()+_0x599819(0xa2)+_0x277d7f['toFixed'](0x2)+_0x599819(0x80)+_0x30e87a[_0x599819(0xc1)](0x2)+'\x20VPIN:'+(_0x5a94e3*0x64)[_0x599819(0xc1)](0x0)+'%\x20OFI:'+(_0x5c808d*0x64)['toFixed'](0x0)+'%\x20Kyle:'+_0x2fe327['toFixed'](0x5)+'\x20Regime:'+_0x50cfb3+'\x20|\x20Conf:'+(_0x2c2e0b*0x64)[_0x599819(0xc1)](0x0)+'%'}),_0x53adc9;}[_0x4ef43a(0x91)](_0x26cd1c){const _0x5ee9d0=_0x4ef43a,_0x3abdd7=this['priceBuffer']['get'](_0x26cd1c);if(!_0x3abdd7||_0x3abdd7[_0x5ee9d0(0xac)]<0x32)return![];const _0x5234f1=this['_computeZScore'](_0x3abdd7);return Math[_0x5ee9d0(0xa0)](_0x5234f1)<this[_0x5ee9d0(0xb7)];}['getModelValues'](_0x100ad6){const _0x72c1a9=_0x4ef43a,_0x498e03=this['priceBuffer']['get'](_0x100ad6),_0x1df52e=this[_0x72c1a9(0x87)]['get'](_0x100ad6),_0x2fcdbb=this[_0x72c1a9(0xad)]['get'](_0x100ad6);if(!_0x498e03||!_0x1df52e||!_0x2fcdbb||_0x2fcdbb[_0x72c1a9(0xac)]<0x32)return null;const _0x58a68a=this[_0x72c1a9(0x79)](_0x498e03),_0x92f79f=this['_computeVPIN'](_0x1df52e),_0x40de93=this['_computeKyleLambda'](_0x2fcdbb),_0x2f710b=this['_computeOrderFlowImbalance'](_0x2fcdbb);return{'zscore':Math[_0x72c1a9(0xc4)](0x1,Math['abs'](_0x58a68a)/0x4),'vpin':0x1-_0x92f79f,'kyleLambda':_0x40de93>0.001?0.5:0.8,'kalman':0.7,'volatility':0.7,'ofi':Math['abs'](_0x2f710b)>0.1?0.8:0.5,'composite':0.7,'raw':{'zscore':_0x58a68a,'vpin':_0x92f79f,'kyleLambda':_0x40de93,'ofi':_0x2f710b}};}['getAnalysisState'](_0x4ce2b0,_0x316d29){const _0x5a30cd=_0x4ef43a,_0x4d69d4=this['barHistory'][_0x5a30cd(0x76)](_0x4ce2b0)||[];if(_0x4d69d4[_0x5a30cd(0xac)]<0x32)return{'ready':![],'message':'Collecting\x20data...\x20'+_0x4d69d4[_0x5a30cd(0xac)]+_0x5a30cd(0x6c)};const _0x1ca627=this[_0x5a30cd(0xb8)][_0x5a30cd(0x76)](_0x4ce2b0)||[],_0x21297c=this['volumeBuffer']['get'](_0x4ce2b0)||[],_0x95eb25=this['_computeZScore'](_0x1ca627),_0x592c7b=this[_0x5a30cd(0xa1)](_0x21297c),_0x509d43=this['_computeOrderFlowImbalance'](_0x4d69d4),_0x4985ff=this[_0x5a30cd(0x72)](_0x4d69d4),{regime:_0x85649c,params:_0x481443}=this[_0x5a30cd(0x8b)](_0x4ce2b0,_0x4d69d4);return{'ready':!![],'zScore':_0x95eb25,'vpin':_0x592c7b,'ofi':_0x509d43,'kyleLambda':_0x4985ff,'regime':_0x85649c,'stopTicks':Math[_0x5a30cd(0x68)](this['baseStopTicks']*_0x481443['stopMultiplier']),'targetTicks':Math[_0x5a30cd(0x68)](this[_0x5a30cd(0x7c)]*_0x481443['targetMultiplier']),'threshold':_0x481443[_0x5a30cd(0x6a)],'barsProcessed':_0x4d69d4[_0x5a30cd(0xac)],'models':'6\x20(Z-Score,\x20VPIN,\x20Kyle,\x20Kalman,\x20Vol,\x20OFI)'};}[_0x4ef43a(0x73)](_0x4697d4){const _0x5aed51=_0x4ef43a;this[_0x5aed51(0x77)][_0x5aed51(0x8a)]({'netPnl':_0x4697d4,'timestamp':Date[_0x5aed51(0xc6)]()});if(this[_0x5aed51(0x77)][_0x5aed51(0xac)]>0x64)this[_0x5aed51(0x77)]['shift']();_0x4697d4>0x0?(this[_0x5aed51(0xca)]++,this[_0x5aed51(0xaf)]=0x0,this[_0x5aed51(0xce)]['wins']++):(this[_0x5aed51(0xaf)]++,this['winStreak']=0x0,this['stats']['losses']++),this['stats']['trades']++,this[_0x5aed51(0xce)][_0x5aed51(0xae)]+=_0x4697d4,this[_0x5aed51(0xc8)]('log',{'type':'debug','message':'[HQX]\x20Trade\x20result:\x20'+(_0x4697d4>0x0?_0x5aed51(0x9c):_0x5aed51(0x93))+'\x20$'+_0x4697d4['toFixed'](0x2)+',\x20streak:\x20'+(_0x4697d4>0x0?this[_0x5aed51(0xca)]:-this['lossStreak'])});}[_0x4ef43a(0x69)](_0x2ce69e){const _0x2d6ea3=_0x4ef43a;return this['barHistory'][_0x2d6ea3(0x76)](_0x2ce69e)||[];}['getStats'](){return this['stats'];}[_0x4ef43a(0x99)](_0x41adc0){const _0x183b0d=_0x4ef43a;this[_0x183b0d(0xad)][_0x183b0d(0x8f)](_0x41adc0,[]),this['priceBuffer'][_0x183b0d(0x8f)](_0x41adc0,[]),this['volumeBuffer'][_0x183b0d(0x8f)](_0x41adc0,[]),this['atrHistory'][_0x183b0d(0x8f)](_0x41adc0,[]),this['kalmanStates'][_0x183b0d(0x8f)](_0x41adc0,{'estimate':0x0,'errorCovariance':0x1}),this['emit']('log',{'type':_0x183b0d(0x7e),'message':_0x183b0d(0xcc)+_0x41adc0});}}class UltraScalpingStrategy extends EventEmitter{constructor(_0x46e0c0={}){const _0xd0678e=_0x4ef43a;super(),this['config']=_0x46e0c0,this[_0xd0678e(0xa7)]=new HQXUltraScalping(_0x46e0c0),this['strategy']['on']('signal',_0x474537=>this[_0xd0678e(0xc8)](_0xd0678e(0x70),_0x474537)),this['strategy']['on']('log',_0x70e918=>this[_0xd0678e(0xc8)](_0xd0678e(0x9f),_0x70e918));}['processTick'](_0x3efffa){const _0x313177=_0x4ef43a;return this['strategy'][_0x313177(0x83)](_0x3efffa);}[_0x4ef43a(0xc5)](_0x3f7186){const _0x31dc6c=_0x4ef43a;return this[_0x31dc6c(0xa7)]['onTick'](_0x3f7186);}['onTrade'](_0x975762){const _0x661b68=_0x4ef43a;return this[_0x661b68(0xa7)][_0x661b68(0x7a)](_0x975762);}['processBar'](_0x696d58,_0x22131b){const _0x492215=_0x4ef43a;return this[_0x492215(0xa7)][_0x492215(0xbd)](_0x696d58,_0x22131b);}['initialize'](_0x2857f7,_0x150854,_0x5351a2){const _0x725959=_0x4ef43a;return this[_0x725959(0xa7)]['initialize'](_0x2857f7,_0x150854,_0x5351a2);}[_0x4ef43a(0x67)](_0x1237ca,_0x387bc3){const _0x5ad357=_0x4ef43a;return this['strategy'][_0x5ad357(0x67)](_0x1237ca,_0x387bc3);}[_0x4ef43a(0x73)](_0x2e2f31){const _0x3a74bf=_0x4ef43a;return this[_0x3a74bf(0xa7)]['recordTradeResult'](_0x2e2f31);}[_0x4ef43a(0x99)](_0x4e01ef){const _0x450d1e=_0x4ef43a;return this['strategy'][_0x450d1e(0x99)](_0x4e01ef);}[_0x4ef43a(0x6b)](){const _0x325341=_0x4ef43a;return this[_0x325341(0xa7)]['getStats']();}[_0x4ef43a(0x69)](_0x21a9b2){return this['strategy']['getBarHistory'](_0x21a9b2);}['getModelValues'](_0x47590e){return this['strategy']['getModelValues'](_0x47590e);}[_0x4ef43a(0x91)](_0x50e997){const _0x13b852=_0x4ef43a;return this[_0x13b852(0xa7)]['shouldExitByZScore'](_0x50e997);}[_0x4ef43a(0x94)](_0x32664f){return null;}}module[_0x4ef43a(0x74)]={'HQXUltraScalping':HQXUltraScalping,'UltraScalpingStrategy':UltraScalpingStrategy,'M1':UltraScalpingStrategy,'S1':HQXUltraScalping,'OrderSide':OrderSide,'SignalStrength':SignalStrength};