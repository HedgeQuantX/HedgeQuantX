const _0x183474=_0xa0d7;function _0xa0d7(_0x603741,_0x487671){_0x603741=_0x603741-0xb7;const _0x1fe0b1=_0x1fe0();let _0xa0d7ea=_0x1fe0b1[_0x603741];return _0xa0d7ea;}function _0x1fe0(){const _0x5362e2=['isDST','startTime','isWithinSession','RESISTANCE','_detectSweep','cooldownBars','811560xmeNET','push','maxDurationBars','exitBarIndex','session','open','_updateZones',',\x20TF=1min','isValid','Collecting\x20data...\x20','execution','onTrade','liquidityZones','now','[HQX-2B]\x20Params:\x20Stop=','info','breakevenTicks','pnl','maxZoneDistanceTicks','losses','targetTicks','28448910SsjWLs','strength','extremePrice','t\x20|\x20Vol:','\x20|\x20Pen:','sweepType','priceHigh','4000653PuitKT','sell','map','symbol','MODERATE','117235CAEGgI','debug','volumeRatio','find','stats','entryBarIndex','high','tickValue','[HQX-2B]\x20Preload\x20complete:\x20','low','short','log','min','1tQzsIO','split','tickSize','swing','object','priceLow','_generateSignal','maxPenetrationTicks','SUPPORT','getLevel','_mergeConfig','onTick','signal','processTick','zone','currentBar','stopTicks','enabled','clusterToleranceTicks','buy','sweptAt','distance','lastSignalTime','initialize','createdAt','get','[2B]\x20NEW\x20SWING\x20','_getVolumeRatio','lookbackBars','activeSweeps','HIGH_SWEEP','max','\x20|\x20Total:\x20','trades','LOSS','preloadBars','recordTradeResult','\x20|\x20Pen:\x20','touches','\x20bars,\x20','\x20@\x20','_detectSwings','t\x20|\x20Q:\x20','delete','[HQX-2B]\x20','timestamp','7MmcEyw','config','getBarHistory','7781496IBGcLi','set','trailTriggerTicks','\x20historical\x20signals\x20detected\x20(ignored)','minPenetrationTicks','type','toFixed','swingPoints','generateSignal','WEAK','[HQX-2B]\x20Initialized\x20for\x20','volume','price','floor','strategy','lastUsedBarIndex','[2B]\x20SWEEP\x20','durationBars','toUpperCase','_scoreSweep','qualityScore','\x20zones',',\x20value=','getFullYear','penetrationTicks','VERY_STRONG','resistance','processBar','getAnalysisState','has','long','BID','\x20|\x20Valid:\x20','barIndex','1213746dXecYN','barHistory','support','ASK','recentTrades','getTimezoneOffset','length','200HwALzf','shift','1488962xYcTRT','abs','reset','LOW_SWEEP','emit','close'];_0x1fe0=function(){return _0x5362e2;};return _0x1fe0();}(function(_0x1f217b,_0x27b1fa){const _0x31f12a=_0xa0d7,_0x5304b0=_0x1f217b();while(!![]){try{const _0x1d1bbf=parseInt(_0x31f12a(0xca))/0x1*(parseInt(_0x31f12a(0x126))/0x2)+-parseInt(_0x31f12a(0x11d))/0x3+-parseInt(_0x31f12a(0x124))/0x4*(parseInt(_0x31f12a(0xbd))/0x5)+parseInt(_0x31f12a(0x132))/0x6+parseInt(_0x31f12a(0xf8))/0x7*(-parseInt(_0x31f12a(0xfb))/0x8)+-parseInt(_0x31f12a(0xb8))/0x9+parseInt(_0x31f12a(0x147))/0xa;if(_0x1d1bbf===_0x27b1fa)break;else _0x5304b0['push'](_0x5304b0['shift']());}catch(_0x3ae918){_0x5304b0['push'](_0x5304b0['shift']());}}}(_0x1fe0,0xb2580));const EventEmitter=require('events'),{v4:uuidv4}=require('uuid'),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4},SweepType={'HIGH_SWEEP':_0x183474(0xc3),'LOW_SWEEP':_0x183474(0xc6)},ZoneType={'RESISTANCE':_0x183474(0x115),'SUPPORT':_0x183474(0x11f)},DEFAULT_CONFIG={'tickSize':0.25,'tickValue':0x5,'swing':{'lookbackBars':0x1,'minStrength':0x1,'confirmationBars':0x1},'zone':{'clusterToleranceTicks':0x8,'minTouches':0x1,'maxZoneAgeBars':0x1f4,'maxZoneDistanceTicks':0x50,'cooldownBars':0x3},'sweep':{'minPenetrationTicks':0.5,'maxPenetrationTicks':0x14,'maxDurationBars':0xa,'minQualityScore':0.2,'minVolumeRatio':0.5,'minBodyRatio':0.1},'execution':{'stopTicks':0xa,'targetTicks':0x28,'breakevenTicks':0x4,'trailTriggerTicks':0x8,'trailDistanceTicks':0x4,'cooldownMs':0x3a98,'minHoldTimeMs':0x1388,'slippageTicks':0x1,'commissionPerSide':0x2},'session':{'enabled':!![],'startHour':0x9,'startMinute':0x1e,'endHour':0x10,'endMinute':0x0,'timezone':'America/New_York'}};class SwingPoint{constructor(_0x1103eb,_0xc92303,_0x5f5708,_0x2c1e3c,_0x14682b=0x1){this['type']=_0x1103eb,this['price']=_0xc92303,this['barIndex']=_0x5f5708,this['timestamp']=_0x2c1e3c,this['strength']=_0x14682b;}}class LiquidityZone{constructor(_0xdfc396,_0x17e55e,_0x1ecdc7,_0x15ae41,_0x44cfe7){const _0x571717=_0x183474;this['id']=uuidv4(),this[_0x571717(0x100)]=_0xdfc396,this['priceHigh']=_0x17e55e,this['priceLow']=_0x1ecdc7,this[_0x571717(0xe2)]=_0x15ae41,this[_0x571717(0x11c)]=_0x44cfe7,this[_0x571717(0xf0)]=0x1,this['swept']=![],this['sweptAt']=null,this[_0x571717(0x10a)]=-0x3e7,this['qualityScore']=0.5;}['containsPrice'](_0x54c83b,_0x1bb25c,_0x46950d){const _0x395a18=_0x183474,_0x51b03d=_0x1bb25c*_0x46950d;return _0x54c83b>=this[_0x395a18(0xcf)]-_0x51b03d&&_0x54c83b<=this[_0x395a18(0xb7)]+_0x51b03d;}['getLevel'](){const _0x14d7d1=_0x183474;return(this[_0x14d7d1(0xb7)]+this['priceLow'])/0x2;}}class SweepEvent{constructor(_0x1b137b,_0x18b8ae,_0x4e4a8c,_0x4b741b,_0x138da8){const _0xa4cd4e=_0x183474;this[_0xa4cd4e(0x14c)]=_0x1b137b,this['zone']=_0x18b8ae,this[_0xa4cd4e(0xc2)]=_0x4e4a8c,this['extremeBarIndex']=_0x4b741b,this[_0xa4cd4e(0x149)]=_0x138da8,this['exitBarIndex']=null,this[_0xa4cd4e(0x13a)]=![],this['qualityScore']=0x0,this['penetrationTicks']=0x0,this['durationBars']=0x0,this['volumeRatio']=0x1;}}class HQX2BLiquiditySweep extends EventEmitter{constructor(_0x2c3245={}){const _0x49ac6a=_0x183474;super(),this['config']=this[_0x49ac6a(0xd4)](DEFAULT_CONFIG,_0x2c3245),this[_0x49ac6a(0xcc)]=this[_0x49ac6a(0xf9)][_0x49ac6a(0xcc)],this[_0x49ac6a(0xc4)]=this['config']['tickValue'],this['barHistory']=new Map(),this['swingPoints']=new Map(),this['liquidityZones']=new Map(),this[_0x49ac6a(0xe7)]=new Map(),this[_0x49ac6a(0xd9)]=new Map(),this['barIntervalMs']=0xea60,this[_0x49ac6a(0xe0)]=0x0,this['stats']={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0},this[_0x49ac6a(0x121)]=[];}['_mergeConfig'](_0x1c2002,_0x5e145a){const _0x2d9f6f=_0x183474,_0x40b63d={..._0x1c2002};for(const _0x28c5e4 in _0x5e145a){typeof _0x5e145a[_0x28c5e4]===_0x2d9f6f(0xce)&&!Array['isArray'](_0x5e145a[_0x28c5e4])?_0x40b63d[_0x28c5e4]={..._0x1c2002[_0x28c5e4],..._0x5e145a[_0x28c5e4]}:_0x40b63d[_0x28c5e4]=_0x5e145a[_0x28c5e4];}return _0x40b63d;}[_0x183474(0x12e)](_0x33e3cf){const _0x1cf77b=_0x183474;if(!this[_0x1cf77b(0xf9)]['session'][_0x1cf77b(0xdb)])return!![];const _0x54cd77=new Date(_0x33e3cf),_0x967318=this[_0x1cf77b(0x12c)](_0x54cd77)?-0x4:-0x5,_0x5909dd=_0x54cd77['getUTCHours'](),_0x33ed02=_0x54cd77['getUTCMinutes'](),_0x3d7ea0=(_0x5909dd+_0x967318+0x18)%0x18,{startHour:_0x1af91a,startMinute:_0x37f7e0,endHour:_0x37b0b2,endMinute:_0x42aeb8}=this['config'][_0x1cf77b(0x136)],_0x1bdffd=_0x3d7ea0*0x3c+_0x33ed02,_0xd28341=_0x1af91a*0x3c+_0x37f7e0,_0x18990e=_0x37b0b2*0x3c+_0x42aeb8;return _0x1bdffd>=_0xd28341&&_0x1bdffd<_0x18990e;}[_0x183474(0x12c)](_0x3b61fa){const _0x4e7f02=_0x183474,_0x498628=new Date(_0x3b61fa['getFullYear'](),0x0,0x1),_0x429d98=new Date(_0x3b61fa[_0x4e7f02(0x112)](),0x6,0x1),_0x1d1f0f=Math['max'](_0x498628['getTimezoneOffset'](),_0x429d98[_0x4e7f02(0x122)]());return _0x3b61fa[_0x4e7f02(0x122)]()<_0x1d1f0f;}[_0x183474(0xe1)](_0x2adcff,_0x2b81de=0.25,_0x2e9d01=0x5){const _0x45660b=_0x183474;this['tickSize']=_0x2b81de,this['tickValue']=_0x2e9d01,this['config'][_0x45660b(0xcc)]=_0x2b81de,this['config']['tickValue']=_0x2e9d01,this['barHistory']['set'](_0x2adcff,[]),this[_0x45660b(0x102)][_0x45660b(0xfc)](_0x2adcff,[]),this['liquidityZones'][_0x45660b(0xfc)](_0x2adcff,[]),this[_0x45660b(0xe7)]['set'](_0x2adcff,[]),this['currentBar'][_0x45660b(0xf5)](_0x2adcff),this['emit'](_0x45660b(0xc8),{'type':'info','message':_0x45660b(0x105)+_0x2adcff+':\x20tick='+_0x2b81de+_0x45660b(0x111)+_0x2e9d01+_0x45660b(0x139)}),this[_0x45660b(0x12a)](_0x45660b(0xc8),{'type':_0x45660b(0x141),'message':_0x45660b(0x140)+this['config']['execution'][_0x45660b(0xda)]+'t,\x20Target='+this[_0x45660b(0xf9)][_0x45660b(0x13c)][_0x45660b(0x146)]+'t,\x20BE='+this[_0x45660b(0xf9)]['execution'][_0x45660b(0x142)]+'t,\x20Trail='+this[_0x45660b(0xf9)]['execution'][_0x45660b(0xfd)]+'/'+this[_0x45660b(0xf9)]['execution']['trailDistanceTicks']});}['processTick'](_0xbe9b39){const _0x1f5b3e=_0x183474,{contractId:_0x4bb910,price:_0x4f2757,volume:_0x161cad,timestamp:_0x9eaa3a}=_0xbe9b39,_0x5b010b=_0x9eaa3a||Date[_0x1f5b3e(0x13f)](),_0x3358b6=_0x161cad||0x1;if(!this[_0x1f5b3e(0x12e)](_0x5b010b))return null;let _0x352786=this['currentBar'][_0x1f5b3e(0xe3)](_0x4bb910);const _0x1e8dc5=Math['floor'](_0x5b010b/this['barIntervalMs'])*this['barIntervalMs'];if(!_0x352786||_0x352786['startTime']!==_0x1e8dc5){if(_0x352786){const _0x5a6c07={'timestamp':_0x352786[_0x1f5b3e(0x12d)],'open':_0x352786[_0x1f5b3e(0x137)],'high':_0x352786[_0x1f5b3e(0xc3)],'low':_0x352786[_0x1f5b3e(0xc6)],'close':_0x352786[_0x1f5b3e(0x12b)],'volume':_0x352786['volume']},_0x2b885f=this['processBar'](_0x4bb910,_0x5a6c07);return this[_0x1f5b3e(0xd9)]['set'](_0x4bb910,{'startTime':_0x1e8dc5,'open':_0x4f2757,'high':_0x4f2757,'low':_0x4f2757,'close':_0x4f2757,'volume':_0x3358b6}),_0x2b885f;}else return this['currentBar'][_0x1f5b3e(0xfc)](_0x4bb910,{'startTime':_0x1e8dc5,'open':_0x4f2757,'high':_0x4f2757,'low':_0x4f2757,'close':_0x4f2757,'volume':_0x3358b6}),null;}else return _0x352786[_0x1f5b3e(0xc3)]=Math['max'](_0x352786['high'],_0x4f2757),_0x352786['low']=Math['min'](_0x352786['low'],_0x4f2757),_0x352786['close']=_0x4f2757,_0x352786['volume']+=_0x3358b6,null;}[_0x183474(0xd5)](_0x22080b){return this['processTick'](_0x22080b);}[_0x183474(0x13d)](_0x177772){const _0x18557b=_0x183474;return this['processTick']({'contractId':_0x177772['contractId']||_0x177772[_0x18557b(0xbb)],'price':_0x177772[_0x18557b(0x107)],'volume':_0x177772['size']||_0x177772['volume']||0x1,'timestamp':_0x177772[_0x18557b(0xf7)]||Date['now']()});}['processBar'](_0x3977b3,_0x4a411c){const _0x227711=_0x183474;let _0x25519b=this[_0x227711(0x11e)][_0x227711(0xe3)](_0x3977b3);!_0x25519b&&(this[_0x227711(0xe1)](_0x3977b3),_0x25519b=this[_0x227711(0x11e)][_0x227711(0xe3)](_0x3977b3));_0x25519b['push'](_0x4a411c);if(_0x25519b[_0x227711(0x123)]>0x1f4)_0x25519b[_0x227711(0x125)]();const _0x5bba1c=_0x25519b['length']-0x1;if(_0x25519b['length']<this['config'][_0x227711(0xcd)][_0x227711(0xe6)]*0x3)return null;const _0x420fbf=this['swingPoints']['get'](_0x3977b3)['length'];this[_0x227711(0xf3)](_0x3977b3,_0x25519b,_0x5bba1c);const _0x931204=this[_0x227711(0x102)][_0x227711(0xe3)](_0x3977b3);if(_0x931204['length']>_0x420fbf){const _0x144706=_0x931204[_0x931204['length']-0x1];this[_0x227711(0x12a)]('log',{'type':'debug','message':_0x227711(0xe4)+_0x144706[_0x227711(0x100)][_0x227711(0x10d)]()+'\x20@\x20'+_0x144706[_0x227711(0x107)][_0x227711(0x101)](0x2)+'\x20|\x20Total:\x20'+_0x931204[_0x227711(0x123)]});}const _0x3d72c8=this['liquidityZones'][_0x227711(0xe3)](_0x3977b3)[_0x227711(0x123)];this[_0x227711(0x138)](_0x3977b3,_0x5bba1c);const _0x48b8ba=this['liquidityZones']['get'](_0x3977b3);if(_0x48b8ba['length']>_0x3d72c8){const _0x9a4f93=_0x48b8ba[_0x48b8ba['length']-0x1];this['emit']('log',{'type':_0x227711(0xbe),'message':'[2B]\x20NEW\x20ZONE\x20'+_0x9a4f93['type']['toUpperCase']()+_0x227711(0xf2)+_0x9a4f93[_0x227711(0xd3)]()[_0x227711(0x101)](0x2)+_0x227711(0xea)+_0x48b8ba['length']});}const _0x34f389=this[_0x227711(0x130)](_0x3977b3,_0x25519b,_0x5bba1c);_0x34f389&&this['emit']('log',{'type':'debug','message':_0x227711(0x10b)+_0x34f389[_0x227711(0x14c)]+_0x227711(0x11b)+_0x34f389[_0x227711(0x13a)]+_0x227711(0xef)+_0x34f389['penetrationTicks']['toFixed'](0x1)+_0x227711(0xf4)+(_0x34f389[_0x227711(0x10f)]*0x64)[_0x227711(0x101)](0x0)+'%'});if(_0x34f389&&_0x34f389['isValid'])return this['_generateSignal'](_0x3977b3,_0x4a411c,_0x5bba1c,_0x34f389);return null;}[_0x183474(0xf3)](_0x4a995b,_0x1bc89c,_0x4833cc){const _0x3e5900=_0x183474,_0x43f547=this['config']['swing'][_0x3e5900(0xe6)],_0x43aebd=this[_0x3e5900(0xf9)][_0x3e5900(0xcd)]['minStrength'];if(_0x4833cc<_0x43f547*0x2)return;const _0x67c516=this['swingPoints']['get'](_0x4a995b),_0xb2cc55=_0x4833cc-_0x43f547,_0x2f6c0f=_0x1bc89c[_0xb2cc55];let _0x5e720f=!![],_0x381755=0x0;for(let _0x54a70c=_0xb2cc55-_0x43f547;_0x54a70c<=_0xb2cc55+_0x43f547;_0x54a70c++){if(_0x54a70c===_0xb2cc55||_0x54a70c<0x0||_0x54a70c>=_0x1bc89c[_0x3e5900(0x123)])continue;if(_0x1bc89c[_0x54a70c]['high']>=_0x2f6c0f[_0x3e5900(0xc3)]){_0x5e720f=![];break;}_0x381755++;}if(_0x5e720f&&_0x381755>=_0x43aebd){const _0x583636=_0x67c516[_0x3e5900(0xc0)](_0x147398=>_0x147398['barIndex']===_0xb2cc55&&_0x147398['type']===_0x3e5900(0xc3));!_0x583636&&_0x67c516['push'](new SwingPoint(_0x3e5900(0xc3),_0x2f6c0f['high'],_0xb2cc55,_0x2f6c0f[_0x3e5900(0xf7)],_0x381755));}let _0x4883ca=!![],_0x42e1d0=0x0;for(let _0x224db5=_0xb2cc55-_0x43f547;_0x224db5<=_0xb2cc55+_0x43f547;_0x224db5++){if(_0x224db5===_0xb2cc55||_0x224db5<0x0||_0x224db5>=_0x1bc89c['length'])continue;if(_0x1bc89c[_0x224db5]['low']<=_0x2f6c0f['low']){_0x4883ca=![];break;}_0x42e1d0++;}if(_0x4883ca&&_0x42e1d0>=_0x43aebd){const _0x2cc678=_0x67c516[_0x3e5900(0xc0)](_0x58ffa9=>_0x58ffa9['barIndex']===_0xb2cc55&&_0x58ffa9['type']===_0x3e5900(0xc6));!_0x2cc678&&_0x67c516['push'](new SwingPoint('low',_0x2f6c0f['low'],_0xb2cc55,_0x2f6c0f['timestamp'],_0x42e1d0));}const _0x28e4b8=this[_0x3e5900(0xf9)]['zone']['maxZoneAgeBars'];while(_0x67c516[_0x3e5900(0x123)]>0x0&&_0x67c516[0x0][_0x3e5900(0x11c)]<_0x4833cc-_0x28e4b8){_0x67c516[_0x3e5900(0x125)]();}}[_0x183474(0x138)](_0x38c13c,_0x3b5476){const _0x194197=_0x183474,_0x2f63f7=this['swingPoints']['get'](_0x38c13c),_0x584679=this['liquidityZones']['get'](_0x38c13c),_0x54d398=this['config']['zone'][_0x194197(0xdc)]*this[_0x194197(0xcc)],_0x50a32a=this[_0x194197(0xf9)][_0x194197(0xd8)]['maxZoneAgeBars'];for(let _0x2b9967=_0x584679[_0x194197(0x123)]-0x1;_0x2b9967>=0x0;_0x2b9967--){_0x3b5476-_0x584679[_0x2b9967]['barIndex']>_0x50a32a&&_0x584679['splice'](_0x2b9967,0x1);}for(const _0x20b283 of _0x2f63f7){let _0x4a01ed=null;for(const _0x57e4e8 of _0x584679){if(_0x57e4e8['containsPrice'](_0x20b283[_0x194197(0x107)],this[_0x194197(0xf9)]['zone']['clusterToleranceTicks'],this['tickSize'])){_0x4a01ed=_0x57e4e8;break;}}if(_0x4a01ed){_0x4a01ed['touches']++;if(_0x20b283[_0x194197(0x107)]>_0x4a01ed['priceHigh'])_0x4a01ed[_0x194197(0xb7)]=_0x20b283[_0x194197(0x107)];if(_0x20b283['price']<_0x4a01ed['priceLow'])_0x4a01ed[_0x194197(0xcf)]=_0x20b283['price'];_0x4a01ed['qualityScore']=Math['min'](0x1,0.3+_0x4a01ed['touches']*0.15);}else{const _0x57e59b=_0x20b283[_0x194197(0x100)]==='high'?ZoneType[_0x194197(0x12f)]:ZoneType[_0x194197(0xd2)],_0x55a5ef=new LiquidityZone(_0x57e59b,_0x20b283[_0x194197(0x107)]+_0x54d398/0x2,_0x20b283['price']-_0x54d398/0x2,_0x20b283[_0x194197(0xf7)],_0x20b283[_0x194197(0x11c)]);_0x55a5ef[_0x194197(0x10f)]=0.3+_0x20b283[_0x194197(0x148)]*0.1,_0x584679['push'](_0x55a5ef);}}}[_0x183474(0x130)](_0x20a56b,_0x3aae9e,_0x390300){const _0x5f49c4=_0x183474,_0x54fd84=this['liquidityZones'][_0x5f49c4(0xe3)](_0x20a56b),_0x32299c=_0x3aae9e[_0x390300],_0x323274=_0x32299c[_0x5f49c4(0x12b)],_0x54084e=this[_0x5f49c4(0xf9)]['sweep'],_0x4564a6=this['config']['zone'];for(const _0x25fcfa of _0x54fd84){if(_0x25fcfa[_0x5f49c4(0x10a)]>=0x0&&_0x390300-_0x25fcfa['lastUsedBarIndex']<_0x4564a6[_0x5f49c4(0x131)])continue;const _0x3f92e1=_0x25fcfa[_0x5f49c4(0xd3)](),_0x16d650=Math['abs'](_0x323274-_0x3f92e1)/this['tickSize'];if(_0x16d650>_0x4564a6[_0x5f49c4(0x144)])continue;const _0x5016eb=Math[_0x5f49c4(0xe9)](0x0,_0x390300-_0x54084e[_0x5f49c4(0x134)]*0x2);for(let _0x272a00=_0x5016eb;_0x272a00<_0x390300;_0x272a00++){const _0x411304=_0x3aae9e[_0x272a00];if(_0x25fcfa[_0x5f49c4(0x100)]===ZoneType[_0x5f49c4(0x12f)]){const _0x59b9f4=(_0x411304['high']-_0x25fcfa['priceHigh'])/this['tickSize'];if(_0x59b9f4>=_0x54084e['minPenetrationTicks']&&_0x59b9f4<=_0x54084e[_0x5f49c4(0xd1)]){if(_0x323274<_0x25fcfa['priceHigh']){const _0x553b90=_0x411304[_0x5f49c4(0xc3)]-_0x411304[_0x5f49c4(0xc6)],_0x4bd58b=Math[_0x5f49c4(0x127)](_0x411304[_0x5f49c4(0x12b)]-_0x411304['open']),_0x30930c=_0x553b90>0x0?_0x4bd58b/_0x553b90:0x0;if(_0x30930c>=_0x54084e['minBodyRatio']){const _0xa6607e=this['_getVolumeRatio'](_0x3aae9e,_0x272a00,0x14);if(_0xa6607e>=_0x54084e['minVolumeRatio']){const _0x231bd4=new SweepEvent(SweepType[_0x5f49c4(0xe8)],_0x25fcfa,_0x272a00,_0x272a00,_0x411304[_0x5f49c4(0xc3)]);_0x231bd4[_0x5f49c4(0x135)]=_0x390300,_0x231bd4[_0x5f49c4(0x113)]=_0x59b9f4,_0x231bd4[_0x5f49c4(0x10c)]=_0x390300-_0x272a00,_0x231bd4[_0x5f49c4(0xbf)]=_0xa6607e,_0x231bd4['qualityScore']=this['_scoreSweep'](_0x231bd4,_0x30930c),_0x231bd4['isValid']=_0x231bd4[_0x5f49c4(0x10f)]>=_0x54084e['minQualityScore'];if(_0x231bd4['isValid'])return _0x231bd4;}}}}}if(_0x25fcfa['type']===ZoneType[_0x5f49c4(0xd2)]){const _0x44b985=(_0x25fcfa[_0x5f49c4(0xcf)]-_0x411304['low'])/this[_0x5f49c4(0xcc)];if(_0x44b985>=_0x54084e[_0x5f49c4(0xff)]&&_0x44b985<=_0x54084e[_0x5f49c4(0xd1)]){if(_0x323274>_0x25fcfa['priceLow']){const _0x55e9b0=_0x411304[_0x5f49c4(0xc3)]-_0x411304['low'],_0x22210d=Math[_0x5f49c4(0x127)](_0x411304['close']-_0x411304[_0x5f49c4(0x137)]),_0x476b39=_0x55e9b0>0x0?_0x22210d/_0x55e9b0:0x0;if(_0x476b39>=_0x54084e['minBodyRatio']){const _0x5e3786=this[_0x5f49c4(0xe5)](_0x3aae9e,_0x272a00,0x14);if(_0x5e3786>=_0x54084e['minVolumeRatio']){const _0x1c8e66=new SweepEvent(SweepType[_0x5f49c4(0x129)],_0x25fcfa,_0x272a00,_0x272a00,_0x411304[_0x5f49c4(0xc6)]);_0x1c8e66['exitBarIndex']=_0x390300,_0x1c8e66[_0x5f49c4(0x113)]=_0x44b985,_0x1c8e66['durationBars']=_0x390300-_0x272a00,_0x1c8e66['volumeRatio']=_0x5e3786,_0x1c8e66['qualityScore']=this[_0x5f49c4(0x10e)](_0x1c8e66,_0x476b39),_0x1c8e66[_0x5f49c4(0x13a)]=_0x1c8e66[_0x5f49c4(0x10f)]>=_0x54084e['minQualityScore'];if(_0x1c8e66[_0x5f49c4(0x13a)])return _0x1c8e66;}}}}}}}return null;}['_getVolumeRatio'](_0x7831ab,_0x570a7d,_0x5f06b8){const _0x442402=_0x183474,_0x56af5c=Math[_0x442402(0xe9)](0x0,_0x570a7d-_0x5f06b8),_0x51ac8a=_0x7831ab['slice'](_0x56af5c,_0x570a7d);if(_0x51ac8a['length']===0x0)return 0x1;const _0x5ae545=_0x51ac8a[_0x442402(0xba)](_0x937266=>_0x937266[_0x442402(0x106)])['sort']((_0x170ed0,_0x27f300)=>_0x170ed0-_0x27f300),_0x260e90=Math[_0x442402(0x108)](_0x5ae545[_0x442402(0x123)]/0x2),_0x48b4bc=_0x5ae545[_0x260e90]||0x1;return _0x7831ab[_0x570a7d]['volume']/_0x48b4bc;}[_0x183474(0x10e)](_0x3025fc,_0x53f7bc){const _0x1ddc35=_0x183474;let _0x1801f0=0x0;const _0x2f9522=0x4,_0x3a126c=Math['abs'](_0x3025fc['penetrationTicks']-_0x2f9522);return _0x1801f0+=Math[_0x1ddc35(0xe9)](0x0,0.3-_0x3a126c*0.03),_0x1801f0+=Math[_0x1ddc35(0xe9)](0x0,0.25-_0x3025fc['durationBars']*0.05),_0x1801f0+=Math[_0x1ddc35(0xc9)](0.25,_0x3025fc['volumeRatio']*0.1),_0x1801f0+=Math[_0x1ddc35(0xc9)](0.2,_0x53f7bc*0.4),Math['min'](0x1,_0x1801f0);}[_0x183474(0xd0)](_0x51be2f,_0x40ff3f,_0xe0f10d,_0x32eaca){const _0x593a88=_0x183474;if(Date[_0x593a88(0x13f)]()-this[_0x593a88(0xe0)]<this[_0x593a88(0xf9)][_0x593a88(0x13c)]['cooldownMs'])return null;const _0x336686=this[_0x593a88(0xf9)]['execution'],_0x2f3793=_0x40ff3f[_0x593a88(0x12b)],_0x1cdc77=_0x32eaca[_0x593a88(0x14c)]===SweepType['HIGH_SWEEP']?_0x593a88(0xc7):'long';let _0x481f42,_0x2cfd8b,_0x4a4ca2,_0x2659bd;_0x1cdc77===_0x593a88(0x119)?(_0x481f42=_0x2f3793-_0x336686[_0x593a88(0xda)]*this[_0x593a88(0xcc)],_0x2cfd8b=_0x2f3793+_0x336686[_0x593a88(0x146)]*this[_0x593a88(0xcc)],_0x4a4ca2=_0x2f3793+_0x336686[_0x593a88(0x142)]*this[_0x593a88(0xcc)],_0x2659bd=_0x2f3793+_0x336686[_0x593a88(0xfd)]*this['tickSize']):(_0x481f42=_0x2f3793+_0x336686['stopTicks']*this['tickSize'],_0x2cfd8b=_0x2f3793-_0x336686['targetTicks']*this['tickSize'],_0x4a4ca2=_0x2f3793-_0x336686['breakevenTicks']*this[_0x593a88(0xcc)],_0x2659bd=_0x2f3793-_0x336686[_0x593a88(0xfd)]*this[_0x593a88(0xcc)]);const _0x1250f5=_0x336686[_0x593a88(0x146)]/_0x336686[_0x593a88(0xda)],_0x7dbf18=Math[_0x593a88(0xc9)](0x1,_0x32eaca[_0x593a88(0x10f)]*0.5+_0x32eaca[_0x593a88(0xd8)]['qualityScore']*0.3+(_0x32eaca[_0x593a88(0xbf)]>1.5?0.2:_0x32eaca[_0x593a88(0xbf)]*0.1));let _0x39b2f0=SignalStrength[_0x593a88(0xbc)];if(_0x7dbf18>=0.8)_0x39b2f0=SignalStrength[_0x593a88(0x114)];else{if(_0x7dbf18>=0.65)_0x39b2f0=SignalStrength['STRONG'];else{if(_0x7dbf18<0.5)_0x39b2f0=SignalStrength[_0x593a88(0x104)];}}const _0x5b3304=0.5+(_0x7dbf18-0.5)*0.4,_0x4b96de=_0x5b3304*Math['abs'](_0x2cfd8b-_0x2f3793)-(0x1-_0x5b3304)*Math[_0x593a88(0x127)](_0x2f3793-_0x481f42);_0x32eaca['zone'][_0x593a88(0x10a)]=_0xe0f10d,_0x32eaca[_0x593a88(0xd8)]['swept']=!![],_0x32eaca['zone'][_0x593a88(0xde)]=new Date(_0x40ff3f['timestamp']),this['lastSignalTime']=Date['now'](),this['stats']['signals']++;const _0x45a29b={'id':uuidv4(),'timestamp':Date[_0x593a88(0x13f)](),'symbol':_0x51be2f[_0x593a88(0xcb)]('.')[0x0]||_0x51be2f,'contractId':_0x51be2f,'side':_0x1cdc77===_0x593a88(0x119)?OrderSide[_0x593a88(0x11a)]:OrderSide[_0x593a88(0x120)],'direction':_0x1cdc77,'strategy':'HQX_2B_LIQUIDITY_SWEEP','strength':_0x39b2f0,'edge':_0x4b96de,'confidence':_0x7dbf18,'entry':_0x2f3793,'entryPrice':_0x2f3793,'stopLoss':_0x481f42,'takeProfit':_0x2cfd8b,'riskReward':_0x1250f5,'stopTicks':_0x336686['stopTicks'],'targetTicks':_0x336686[_0x593a88(0x146)],'breakevenTicks':_0x336686['breakevenTicks'],'trailTriggerTicks':_0x336686['trailTriggerTicks'],'trailDistanceTicks':_0x336686['trailDistanceTicks'],'beLevel':_0x4a4ca2,'trailTrigger':_0x2659bd,'sweepType':_0x32eaca[_0x593a88(0x14c)],'penetrationTicks':_0x32eaca[_0x593a88(0x113)],'sweepDurationBars':_0x32eaca['durationBars'],'sweepQuality':_0x32eaca[_0x593a88(0x10f)],'volumeRatio':_0x32eaca['volumeRatio'],'zoneType':_0x32eaca['zone'][_0x593a88(0x100)],'zoneLevel':_0x32eaca['zone']['getLevel'](),'zoneTouches':_0x32eaca[_0x593a88(0xd8)]['touches'],'zoneQuality':_0x32eaca['zone']['qualityScore'],'expires':Date[_0x593a88(0x13f)]()+0xea60};return this['emit'](_0x593a88(0xd6),{'side':_0x1cdc77===_0x593a88(0x119)?_0x593a88(0xdd):_0x593a88(0xb9),'action':_0x593a88(0x137),'reason':'2B\x20'+_0x32eaca['sweepType']+'\x20|\x20Pen:'+_0x32eaca[_0x593a88(0x113)]['toFixed'](0x1)+_0x593a88(0x14a)+_0x32eaca['volumeRatio']['toFixed'](0x1)+'x\x20|\x20Q:'+(_0x32eaca['qualityScore']*0x64)[_0x593a88(0x101)](0x0)+'%',..._0x45a29b}),this['emit']('log',{'type':'info','message':'[HQX-2B]\x20SIGNAL:\x20'+_0x1cdc77[_0x593a88(0x10d)]()+'\x20@\x20'+_0x2f3793[_0x593a88(0x101)](0x2)+'\x20|\x20'+_0x32eaca[_0x593a88(0x14c)]+_0x593a88(0x14b)+_0x32eaca['penetrationTicks']['toFixed'](0x1)+'t\x20Vol:'+_0x32eaca[_0x593a88(0xbf)]['toFixed'](0x1)+'x\x20|\x20Conf:'+(_0x7dbf18*0x64)[_0x593a88(0x101)](0x0)+'%'}),_0x45a29b;}['getAnalysisState'](_0x4f4fed,_0x17d1c9){const _0x1e3c2e=_0x183474,_0x4dcbd8=this[_0x1e3c2e(0x11e)]['get'](_0x4f4fed)||[],_0x14689b=this['liquidityZones'][_0x1e3c2e(0xe3)](_0x4f4fed)||[],_0x2065e8=this['swingPoints']['get'](_0x4f4fed)||[];if(_0x4dcbd8[_0x1e3c2e(0x123)]<0x5)return{'ready':![],'message':_0x1e3c2e(0x13b)+_0x4dcbd8['length']+'/5\x20bars'};const _0x5f152b=_0x14689b[_0x1e3c2e(0xba)](_0x3e5841=>({'zone':_0x3e5841,'distance':Math[_0x1e3c2e(0x127)](_0x17d1c9-_0x3e5841['getLevel']())}))['sort']((_0x472fc5,_0x1f8dbe)=>_0x472fc5[_0x1e3c2e(0xdf)]-_0x1f8dbe[_0x1e3c2e(0xdf)]),_0x371c94=_0x5f152b[_0x1e3c2e(0xc0)](_0x102ab5=>_0x102ab5['zone']['type']===ZoneType[_0x1e3c2e(0x12f)]),_0xbee416=_0x5f152b[_0x1e3c2e(0xc0)](_0x228c5c=>_0x228c5c['zone']['type']===ZoneType['SUPPORT']);return{'ready':!![],'barsProcessed':_0x4dcbd8[_0x1e3c2e(0x123)],'swingsDetected':_0x2065e8[_0x1e3c2e(0x123)],'activeZones':_0x14689b['length'],'nearestResistance':_0x371c94?_0x371c94[_0x1e3c2e(0xd8)][_0x1e3c2e(0xd3)]():null,'nearestSupport':_0xbee416?_0xbee416[_0x1e3c2e(0xd8)][_0x1e3c2e(0xd3)]():null,'stopTicks':this['config']['execution'][_0x1e3c2e(0xda)],'targetTicks':this['config'][_0x1e3c2e(0x13c)]['targetTicks'],'strategy':'HQX-2B\x20Liquidity\x20Sweep\x20(Optimized)'};}['recordTradeResult'](_0x4dbb62){const _0x10e3f5=_0x183474;this[_0x10e3f5(0x121)][_0x10e3f5(0x133)]({'netPnl':_0x4dbb62,'timestamp':Date['now']()});if(this[_0x10e3f5(0x121)]['length']>0x64)this[_0x10e3f5(0x121)]['shift']();_0x4dbb62>0x0?this['stats']['wins']++:this[_0x10e3f5(0xc1)][_0x10e3f5(0x145)]++,this[_0x10e3f5(0xc1)][_0x10e3f5(0xeb)]++,this['stats'][_0x10e3f5(0x143)]+=_0x4dbb62,this[_0x10e3f5(0x12a)](_0x10e3f5(0xc8),{'type':_0x10e3f5(0xbe),'message':'[HQX-2B]\x20Trade\x20result:\x20'+(_0x4dbb62>0x0?'WIN':_0x10e3f5(0xec))+'\x20$'+_0x4dbb62['toFixed'](0x2)});}[_0x183474(0xfa)](_0x5820ea){const _0x4df593=_0x183474;return this[_0x4df593(0x11e)][_0x4df593(0xe3)](_0x5820ea)||[];}['getStats'](){return this['stats'];}['reset'](_0x3c4e85){const _0x7f9bcb=_0x183474;this[_0x7f9bcb(0x11e)]['set'](_0x3c4e85,[]),this[_0x7f9bcb(0x102)][_0x7f9bcb(0xfc)](_0x3c4e85,[]),this[_0x7f9bcb(0x13e)]['set'](_0x3c4e85,[]),this[_0x7f9bcb(0xe7)]['set'](_0x3c4e85,[]),this[_0x7f9bcb(0xd9)][_0x7f9bcb(0xf5)](_0x3c4e85),this['emit'](_0x7f9bcb(0xc8),{'type':'info','message':'[HQX-2B]\x20Reset\x20state\x20for\x20'+_0x3c4e85});}[_0x183474(0xed)](_0x1fffc4,_0x351c9d){const _0x3c77f7=_0x183474;if(!_0x351c9d||_0x351c9d['length']===0x0){this[_0x3c77f7(0x12a)]('log',{'type':_0x3c77f7(0xbe),'message':'[HQX-2B]\x20No\x20historical\x20bars\x20to\x20preload'});return;}!this[_0x3c77f7(0x11e)][_0x3c77f7(0x118)](_0x1fffc4)&&this[_0x3c77f7(0xe1)](_0x1fffc4);const _0x50f2de=[..._0x351c9d]['sort']((_0x3b69a4,_0x2d35d0)=>_0x3b69a4[_0x3c77f7(0xf7)]-_0x2d35d0[_0x3c77f7(0xf7)]);this[_0x3c77f7(0x12a)]('log',{'type':'info','message':'[HQX-2B]\x20Preloading\x20'+_0x50f2de['length']+'\x20historical\x20bars...'});let _0x350b6f=0x0;for(const _0x4880c6 of _0x50f2de){const _0x12ffe8=this['processBar'](_0x1fffc4,_0x4880c6);if(_0x12ffe8)_0x350b6f++;}const _0x14e32c=this[_0x3c77f7(0x11e)]['get'](_0x1fffc4)||[],_0x12344c=this['swingPoints'][_0x3c77f7(0xe3)](_0x1fffc4)||[],_0x3e039b=this[_0x3c77f7(0x13e)][_0x3c77f7(0xe3)](_0x1fffc4)||[];this[_0x3c77f7(0x12a)]('log',{'type':_0x3c77f7(0x141),'message':_0x3c77f7(0xc5)+_0x14e32c[_0x3c77f7(0x123)]+_0x3c77f7(0xf1)+_0x12344c[_0x3c77f7(0x123)]+'\x20swings,\x20'+_0x3e039b[_0x3c77f7(0x123)]+_0x3c77f7(0x110)}),_0x350b6f>0x0&&this[_0x3c77f7(0x12a)]('log',{'type':'debug','message':_0x3c77f7(0xf6)+_0x350b6f+_0x3c77f7(0xfe)}),this['lastSignalTime']=0x0;}}class HQX2BStrategy extends EventEmitter{constructor(_0x38bdaf={}){const _0x2dcd7a=_0x183474;super(),this['config']=_0x38bdaf,this['strategy']=new HQX2BLiquiditySweep(_0x38bdaf),this[_0x2dcd7a(0x109)]['on']('signal',_0x405b46=>this['emit']('signal',_0x405b46)),this[_0x2dcd7a(0x109)]['on']('log',_0x2a6106=>this['emit']('log',_0x2a6106));}['processTick'](_0x45b7b5){const _0x59da87=_0x183474;return this[_0x59da87(0x109)][_0x59da87(0xd7)](_0x45b7b5);}['onTick'](_0x33842f){return this['strategy']['onTick'](_0x33842f);}['onTrade'](_0x23dcda){const _0x10c336=_0x183474;return this['strategy'][_0x10c336(0x13d)](_0x23dcda);}[_0x183474(0x116)](_0x389b1e,_0x381e23){const _0x4fa113=_0x183474;return this[_0x4fa113(0x109)]['processBar'](_0x389b1e,_0x381e23);}['initialize'](_0x5ee17e,_0x107058,_0x51ecff){const _0x2c0844=_0x183474;return this['strategy'][_0x2c0844(0xe1)](_0x5ee17e,_0x107058,_0x51ecff);}[_0x183474(0x117)](_0x2e94cd,_0x3dc562){const _0x3806d9=_0x183474;return this['strategy'][_0x3806d9(0x117)](_0x2e94cd,_0x3dc562);}[_0x183474(0xee)](_0x16d9eb){const _0x32aa62=_0x183474;return this[_0x32aa62(0x109)]['recordTradeResult'](_0x16d9eb);}[_0x183474(0x128)](_0x32870d){const _0x456d6f=_0x183474;return this[_0x456d6f(0x109)]['reset'](_0x32870d);}['getStats'](){return this['strategy']['getStats']();}['getBarHistory'](_0x378e93){return this['strategy']['getBarHistory'](_0x378e93);}['preloadBars'](_0x31a9ec,_0x2f4948){const _0x58f029=_0x183474;return this[_0x58f029(0x109)][_0x58f029(0xed)](_0x31a9ec,_0x2f4948);}[_0x183474(0x103)](_0x4c4775){return null;}}module['exports']={'HQX2BLiquiditySweep':HQX2BLiquiditySweep,'HQX2BStrategy':HQX2BStrategy,'M2':HQX2BStrategy,'S2':HQX2BLiquiditySweep,'OrderSide':OrderSide,'SignalStrength':SignalStrength,'SweepType':SweepType,'ZoneType':ZoneType,'DEFAULT_CONFIG':DEFAULT_CONFIG};