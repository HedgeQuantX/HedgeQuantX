const _0xe9f20f=_0x4ccb;(function(_0x165b9b,_0x1bb239){const _0x204a55=_0x4ccb,_0x3a7f1f=_0x165b9b();while(!![]){try{const _0x304b4d=parseInt(_0x204a55(0xfe))/0x1*(-parseInt(_0x204a55(0x13b))/0x2)+-parseInt(_0x204a55(0x10f))/0x3+parseInt(_0x204a55(0x134))/0x4*(parseInt(_0x204a55(0x10a))/0x5)+parseInt(_0x204a55(0x164))/0x6+parseInt(_0x204a55(0x106))/0x7*(parseInt(_0x204a55(0xeb))/0x8)+-parseInt(_0x204a55(0xe8))/0x9*(parseInt(_0x204a55(0xe2))/0xa)+parseInt(_0x204a55(0x132))/0xb*(-parseInt(_0x204a55(0x139))/0xc);if(_0x304b4d===_0x1bb239)break;else _0x3a7f1f['push'](_0x3a7f1f['shift']());}catch(_0x4a47aa){_0x3a7f1f['push'](_0x3a7f1f['shift']());}}}(_0x30a4,0x5ebc6));const EventEmitter=require('events'),{v4:uuidv4}=require('uuid'),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4},SweepType={'HIGH_SWEEP':_0xe9f20f(0x15e),'LOW_SWEEP':_0xe9f20f(0x116)},ZoneType={'RESISTANCE':_0xe9f20f(0xf3),'SUPPORT':_0xe9f20f(0xe0)},DEFAULT_CONFIG={'tickSize':0.25,'tickValue':0x5,'swing':{'lookbackBars':0x1,'minStrength':0x1,'confirmationBars':0x1},'zone':{'clusterToleranceTicks':0x8,'minTouches':0x1,'maxZoneAgeBars':0x1f4,'maxZoneDistanceTicks':0x50,'cooldownBars':0x3},'sweep':{'minPenetrationTicks':0.25,'maxPenetrationTicks':0x14,'maxDurationBars':0xa,'minQualityScore':0.1,'minVolumeRatio':0.3,'minBodyRatio':0.05},'execution':{'stopTicks':0xa,'targetTicks':0x28,'breakevenTicks':0x4,'trailTriggerTicks':0x8,'trailDistanceTicks':0x4,'cooldownMs':0x1388,'minHoldTimeMs':0x1388,'slippageTicks':0x1,'commissionPerSide':0x2},'session':{'enabled':![],'startHour':0x9,'startMinute':0x1e,'endHour':0x10,'endMinute':0x0,'timezone':_0xe9f20f(0x14f)}};class SwingPoint{constructor(_0x2b01a7,_0x5e9e29,_0x55f916,_0x3bf14d,_0x26e76a=0x1){const _0x248d38=_0xe9f20f;this['type']=_0x2b01a7,this[_0x248d38(0x102)]=_0x5e9e29,this['barIndex']=_0x55f916,this[_0x248d38(0x141)]=_0x3bf14d,this[_0x248d38(0x13d)]=_0x26e76a;}}function _0x30a4(){const _0x529bb6=['\x20bars,\x20','getAnalysisState','support','symbol','4090odtSXM','getUTCHours','has','processTick','x\x20|\x20Q:','_generateSignal','17037cRazoI','maxZoneAgeBars','size','351664HqcynT','volumeRatio','stats','emit','isValid','[HQX-2B]\x20SIGNAL:\x20','floor','createdAt','resistance','open','[HQX-2B]\x20No\x20historical\x20bars\x20to\x20preload','info','tickCount','barHistory','reset','lookbackBars','close','toUpperCase','penetrationTicks','121QVtERm','_updateZones','map','maxDurationBars','price','minBodyRatio','onTick','length','91euWRqR','\x20zones','object','getBarHistory','5puwMet','distance','now','entryBarIndex','liquidityZones','527376evCsSD','_detectSweep','tickValue','_scoreSweep','LOSS','trailDistanceTicks','trailTriggerTicks','low','\x20swings,\x20','sweptAt','targetTicks',':\x20tick=','zone','RESISTANCE','LOW_SWEEP','SUPPORT','tickSize','/5\x20bars','shift','preloadBars','ASK','[2B]\x20SWEEP\x20','[HQX-2B]\x20Trade\x20result:\x20','lastSignalTime','barIntervalMs','type','currentBar','isDST','getHealthStatus','generateSignal','config','lastUsedBarIndex','set','getFullYear','touches','22968rylGpH','processBar','2795516mqSmMf','swingPoints','push','\x20|\x20','toFixed','1812xBvQSD','_getVolumeRatio','868pURVsV','maxZoneDistanceTicks','strength','containsPrice','short','clusterToleranceTicks','timestamp','t,\x20Target=','abs','cooldownMs','minPenetrationTicks','t,\x20Trail=','log','max','find','signal','long','\x20|\x20Total:\x20','priceLow','initialize','America/New_York','minQualityScore',',\x20TF=1min','\x20historical\x20bars...','t\x20Vol:','priceHigh','sort','enabled','MODERATE','trades','getTimezoneOffset','debug','stopTicks','\x20@\x20','contractId','high','recordTradeResult','sweepType','strategy','get','extremeBarIndex','2613216kvByLI','maxPenetrationTicks','[HQX-2B]\x20Preloading\x20','volume','swing','exitBarIndex','delete','2B\x20','execution','BID','Collecting\x20data...\x20','swept','\x20|\x20Pen:','min','_detectSwings','barIndex','breakevenTicks','[HQX-2B]\x20Preload\x20complete:\x20','qualityScore','getLevel','filter'];_0x30a4=function(){return _0x529bb6;};return _0x30a4();}class LiquidityZone{constructor(_0x224987,_0x12a1b2,_0x140203,_0x45f4ce,_0x41ed22){const _0x270a8b=_0xe9f20f;this['id']=uuidv4(),this['type']=_0x224987,this['priceHigh']=_0x12a1b2,this[_0x270a8b(0x14d)]=_0x140203,this[_0x270a8b(0xf2)]=_0x45f4ce,this['barIndex']=_0x41ed22,this['touches']=0x1,this[_0x270a8b(0xd4)]=![],this['sweptAt']=null,this[_0x270a8b(0x12e)]=-0x3e7,this[_0x270a8b(0xdb)]=0.5;}['containsPrice'](_0x22241f,_0x1cf8da,_0x4cd927){const _0x16ce21=_0xe9f20f,_0x2d4332=_0x1cf8da*_0x4cd927;return _0x22241f>=this[_0x16ce21(0x14d)]-_0x2d4332&&_0x22241f<=this['priceHigh']+_0x2d4332;}['getLevel'](){const _0x496d1e=_0xe9f20f;return(this[_0x496d1e(0x154)]+this[_0x496d1e(0x14d)])/0x2;}}function _0x4ccb(_0x1f907e,_0x2377e2){_0x1f907e=_0x1f907e-0xce;const _0x30a4dc=_0x30a4();let _0x4ccbe1=_0x30a4dc[_0x1f907e];return _0x4ccbe1;}class SweepEvent{constructor(_0x512a48,_0x35f462,_0x302d38,_0x29edd5,_0x4e058a){const _0x5c9c12=_0xe9f20f;this[_0x5c9c12(0x160)]=_0x512a48,this['zone']=_0x35f462,this[_0x5c9c12(0x10d)]=_0x302d38,this[_0x5c9c12(0x163)]=_0x29edd5,this['extremePrice']=_0x4e058a,this[_0x5c9c12(0xce)]=null,this[_0x5c9c12(0xef)]=![],this[_0x5c9c12(0xdb)]=0x0,this[_0x5c9c12(0xfd)]=0x0,this['durationBars']=0x0,this[_0x5c9c12(0xec)]=0x1;}}class HQX2BLiquiditySweep extends EventEmitter{constructor(_0x20d856={}){const _0x3ac472=_0xe9f20f;super(),this[_0x3ac472(0x12d)]=this['_mergeConfig'](DEFAULT_CONFIG,_0x20d856),this[_0x3ac472(0x11f)]=this[_0x3ac472(0x12d)][_0x3ac472(0x11f)],this['tickValue']=this[_0x3ac472(0x12d)]['tickValue'],this['barHistory']=new Map(),this[_0x3ac472(0x135)]=new Map(),this[_0x3ac472(0x10e)]=new Map(),this['activeSweeps']=new Map(),this[_0x3ac472(0x129)]=new Map(),this['barIntervalMs']=0xea60,this[_0x3ac472(0x126)]=0x0,this['startTime']=Date['now'](),this[_0x3ac472(0xed)]={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0},this['recentTrades']=[];}['_mergeConfig'](_0xd30c84,_0x2216b9){const _0x190ef8=_0xe9f20f,_0x239fed={..._0xd30c84};for(const _0x5e7ede in _0x2216b9){typeof _0x2216b9[_0x5e7ede]===_0x190ef8(0x108)&&!Array['isArray'](_0x2216b9[_0x5e7ede])?_0x239fed[_0x5e7ede]={..._0xd30c84[_0x5e7ede],..._0x2216b9[_0x5e7ede]}:_0x239fed[_0x5e7ede]=_0x2216b9[_0x5e7ede];}return _0x239fed;}['isWithinSession'](_0x253744){const _0x19d91a=_0xe9f20f;if(!this['config']['session'][_0x19d91a(0x156)])return!![];const _0x2ac9fc=new Date(_0x253744),_0x2c22e2=this[_0x19d91a(0x12a)](_0x2ac9fc)?-0x4:-0x5,_0x29fb6d=_0x2ac9fc[_0x19d91a(0xe3)](),_0x325e0f=_0x2ac9fc['getUTCMinutes'](),_0x4686ad=(_0x29fb6d+_0x2c22e2+0x18)%0x18,{startHour:_0x45c59f,startMinute:_0x355263,endHour:_0x4b0bde,endMinute:_0x130fd5}=this['config']['session'],_0x427537=_0x4686ad*0x3c+_0x325e0f,_0x12b3cd=_0x45c59f*0x3c+_0x355263,_0x4a5d10=_0x4b0bde*0x3c+_0x130fd5;return _0x427537>=_0x12b3cd&&_0x427537<_0x4a5d10;}['isDST'](_0x424abc){const _0x5f5813=_0xe9f20f,_0x4e2213=new Date(_0x424abc['getFullYear'](),0x0,0x1),_0x3239fc=new Date(_0x424abc[_0x5f5813(0x130)](),0x6,0x1),_0x5d0925=Math['max'](_0x4e2213['getTimezoneOffset'](),_0x3239fc[_0x5f5813(0x159)]());return _0x424abc[_0x5f5813(0x159)]()<_0x5d0925;}['initialize'](_0x13251c,_0x581d44=0.25,_0x36336b=0x5){const _0x1c6944=_0xe9f20f;this['tickSize']=_0x581d44,this[_0x1c6944(0x111)]=_0x36336b,this[_0x1c6944(0x12d)]['tickSize']=_0x581d44,this['config'][_0x1c6944(0x111)]=_0x36336b,this[_0x1c6944(0xf8)][_0x1c6944(0x12f)](_0x13251c,[]),this[_0x1c6944(0x135)]['set'](_0x13251c,[]),this['liquidityZones'][_0x1c6944(0x12f)](_0x13251c,[]),this['activeSweeps']['set'](_0x13251c,[]),this[_0x1c6944(0x129)][_0x1c6944(0xcf)](_0x13251c),this['emit']('log',{'type':_0x1c6944(0xf6),'message':'[HQX-2B]\x20Initialized\x20for\x20'+_0x13251c+_0x1c6944(0x11a)+_0x581d44+',\x20value='+_0x36336b+_0x1c6944(0x151)}),this['emit']('log',{'type':'info','message':'[HQX-2B]\x20Params:\x20Stop='+this[_0x1c6944(0x12d)]['execution']['stopTicks']+_0x1c6944(0x142)+this[_0x1c6944(0x12d)]['execution'][_0x1c6944(0x119)]+'t,\x20BE='+this[_0x1c6944(0x12d)][_0x1c6944(0xd1)][_0x1c6944(0xd9)]+_0x1c6944(0x146)+this['config'][_0x1c6944(0xd1)]['trailTriggerTicks']+'/'+this['config'][_0x1c6944(0xd1)]['trailDistanceTicks']});}[_0xe9f20f(0xe5)](_0x5665f6){const _0x361c9a=_0xe9f20f,{contractId:_0x5d3781,price:_0x57110c,volume:_0x31f961,timestamp:_0x51a452}=_0x5665f6,_0x4bd6e8=_0x51a452||Date['now'](),_0x597f7b=_0x31f961||0x1;if(!this['isWithinSession'](_0x4bd6e8))return null;let _0x2f6a76=this[_0x361c9a(0x129)]['get'](_0x5d3781);const _0x474f27=Math['floor'](_0x4bd6e8/this[_0x361c9a(0x127)])*this['barIntervalMs'];if(!_0x2f6a76||_0x2f6a76['startTime']!==_0x474f27){if(_0x2f6a76){const _0x511231={'timestamp':_0x2f6a76['startTime'],'open':_0x2f6a76['open'],'high':_0x2f6a76[_0x361c9a(0x15e)],'low':_0x2f6a76[_0x361c9a(0x116)],'close':_0x2f6a76['close'],'volume':_0x2f6a76['volume']},_0x467bac=this[_0x361c9a(0x133)](_0x5d3781,_0x511231);return this[_0x361c9a(0x129)][_0x361c9a(0x12f)](_0x5d3781,{'startTime':_0x474f27,'open':_0x57110c,'high':_0x57110c,'low':_0x57110c,'close':_0x57110c,'volume':_0x597f7b}),_0x467bac;}else return this[_0x361c9a(0x129)][_0x361c9a(0x12f)](_0x5d3781,{'startTime':_0x474f27,'open':_0x57110c,'high':_0x57110c,'low':_0x57110c,'close':_0x57110c,'volume':_0x597f7b}),null;}else return _0x2f6a76[_0x361c9a(0x15e)]=Math['max'](_0x2f6a76[_0x361c9a(0x15e)],_0x57110c),_0x2f6a76[_0x361c9a(0x116)]=Math['min'](_0x2f6a76['low'],_0x57110c),_0x2f6a76[_0x361c9a(0xfb)]=_0x57110c,_0x2f6a76['volume']+=_0x597f7b,null;}['onTick'](_0x5d5df0){const _0x476dce=_0xe9f20f;return this[_0x476dce(0xe5)](_0x5d5df0);}['onTrade'](_0x37f14a){const _0x36231f=_0xe9f20f;return this[_0x36231f(0xe5)]({'contractId':_0x37f14a[_0x36231f(0x15d)]||_0x37f14a[_0x36231f(0xe1)],'price':_0x37f14a[_0x36231f(0x102)],'volume':_0x37f14a[_0x36231f(0xea)]||_0x37f14a[_0x36231f(0x167)]||0x1,'timestamp':_0x37f14a['timestamp']||Date[_0x36231f(0x10c)]()});}[_0xe9f20f(0x133)](_0x1c4dec,_0x3b443c){const _0x3df781=_0xe9f20f;let _0x4a76e4=this['barHistory'][_0x3df781(0x162)](_0x1c4dec);!_0x4a76e4&&(this['initialize'](_0x1c4dec),_0x4a76e4=this['barHistory']['get'](_0x1c4dec));_0x4a76e4['push'](_0x3b443c);if(_0x4a76e4[_0x3df781(0x105)]>0x1f4)_0x4a76e4[_0x3df781(0x121)]();const _0x4990be=_0x4a76e4[_0x3df781(0x105)]-0x1;if(_0x4a76e4[_0x3df781(0x105)]<this['config']['swing'][_0x3df781(0xfa)]*0x3)return null;const _0x1e91b4=this[_0x3df781(0x135)]['get'](_0x1c4dec)[_0x3df781(0x105)];this[_0x3df781(0xd7)](_0x1c4dec,_0x4a76e4,_0x4990be);const _0xbd0d81=this[_0x3df781(0x135)]['get'](_0x1c4dec);if(_0xbd0d81['length']>_0x1e91b4){const _0x5b3bd5=_0xbd0d81[_0xbd0d81['length']-0x1];this[_0x3df781(0xee)](_0x3df781(0x147),{'type':'debug','message':'[2B]\x20NEW\x20SWING\x20'+_0x5b3bd5[_0x3df781(0x128)]['toUpperCase']()+_0x3df781(0x15c)+_0x5b3bd5['price']['toFixed'](0x2)+_0x3df781(0x14c)+_0xbd0d81['length']});}const _0x158b31=this[_0x3df781(0x10e)][_0x3df781(0x162)](_0x1c4dec)['length'];this['_updateZones'](_0x1c4dec,_0x4990be);const _0x567f32=this['liquidityZones']['get'](_0x1c4dec);if(_0x567f32['length']>_0x158b31){const _0x386fbc=_0x567f32[_0x567f32[_0x3df781(0x105)]-0x1];this['emit'](_0x3df781(0x147),{'type':'debug','message':'[2B]\x20NEW\x20ZONE\x20'+_0x386fbc[_0x3df781(0x128)]['toUpperCase']()+'\x20@\x20'+_0x386fbc['getLevel']()['toFixed'](0x2)+'\x20|\x20Total:\x20'+_0x567f32[_0x3df781(0x105)]});}const _0x440e9c=this['_detectSweep'](_0x1c4dec,_0x4a76e4,_0x4990be);_0x440e9c&&this[_0x3df781(0xee)](_0x3df781(0x147),{'type':'debug','message':_0x3df781(0x124)+_0x440e9c[_0x3df781(0x160)]+'\x20|\x20Valid:\x20'+_0x440e9c[_0x3df781(0xef)]+'\x20|\x20Pen:\x20'+_0x440e9c[_0x3df781(0xfd)][_0x3df781(0x138)](0x1)+'t\x20|\x20Q:\x20'+(_0x440e9c['qualityScore']*0x64)['toFixed'](0x0)+'%'});if(_0x440e9c&&_0x440e9c['isValid'])return this['_generateSignal'](_0x1c4dec,_0x3b443c,_0x4990be,_0x440e9c);return null;}[_0xe9f20f(0xd7)](_0x1eb7bc,_0x5282ff,_0x1f6151){const _0xc911f1=_0xe9f20f,_0x19e887=this['config']['swing']['lookbackBars'],_0x48d834=this[_0xc911f1(0x12d)][_0xc911f1(0x168)]['minStrength'];if(_0x1f6151<_0x19e887*0x2)return;const _0x594eff=this[_0xc911f1(0x135)]['get'](_0x1eb7bc),_0x5a9fd3=_0x1f6151-_0x19e887,_0x26d00b=_0x5282ff[_0x5a9fd3];let _0x97b5d9=!![],_0x30b7dd=0x0;for(let _0x28497b=_0x5a9fd3-_0x19e887;_0x28497b<=_0x5a9fd3+_0x19e887;_0x28497b++){if(_0x28497b===_0x5a9fd3||_0x28497b<0x0||_0x28497b>=_0x5282ff['length'])continue;if(_0x5282ff[_0x28497b]['high']>=_0x26d00b['high']){_0x97b5d9=![];break;}_0x30b7dd++;}if(_0x97b5d9&&_0x30b7dd>=_0x48d834){const _0x47f1b9=_0x594eff['find'](_0x80a7de=>_0x80a7de[_0xc911f1(0xd8)]===_0x5a9fd3&&_0x80a7de[_0xc911f1(0x128)]===_0xc911f1(0x15e));!_0x47f1b9&&_0x594eff['push'](new SwingPoint(_0xc911f1(0x15e),_0x26d00b['high'],_0x5a9fd3,_0x26d00b[_0xc911f1(0x141)],_0x30b7dd));}let _0x54ad94=!![],_0x1ff924=0x0;for(let _0x11915c=_0x5a9fd3-_0x19e887;_0x11915c<=_0x5a9fd3+_0x19e887;_0x11915c++){if(_0x11915c===_0x5a9fd3||_0x11915c<0x0||_0x11915c>=_0x5282ff[_0xc911f1(0x105)])continue;if(_0x5282ff[_0x11915c][_0xc911f1(0x116)]<=_0x26d00b[_0xc911f1(0x116)]){_0x54ad94=![];break;}_0x1ff924++;}if(_0x54ad94&&_0x1ff924>=_0x48d834){const _0xf012a6=_0x594eff[_0xc911f1(0x149)](_0x25a953=>_0x25a953[_0xc911f1(0xd8)]===_0x5a9fd3&&_0x25a953['type']==='low');!_0xf012a6&&_0x594eff[_0xc911f1(0x136)](new SwingPoint('low',_0x26d00b[_0xc911f1(0x116)],_0x5a9fd3,_0x26d00b['timestamp'],_0x1ff924));}const _0x803395=this[_0xc911f1(0x12d)]['zone'][_0xc911f1(0xe9)];while(_0x594eff[_0xc911f1(0x105)]>0x0&&_0x594eff[0x0][_0xc911f1(0xd8)]<_0x1f6151-_0x803395){_0x594eff['shift']();}}[_0xe9f20f(0xff)](_0x17c7f9,_0x4339cf){const _0x2198da=_0xe9f20f,_0x11b15b=this['swingPoints']['get'](_0x17c7f9),_0x23550f=this['liquidityZones']['get'](_0x17c7f9),_0x4560ca=this[_0x2198da(0x12d)]['zone'][_0x2198da(0x140)]*this[_0x2198da(0x11f)],_0x4aed86=this['config']['zone']['maxZoneAgeBars'];for(let _0x3ceedb=_0x23550f[_0x2198da(0x105)]-0x1;_0x3ceedb>=0x0;_0x3ceedb--){_0x4339cf-_0x23550f[_0x3ceedb][_0x2198da(0xd8)]>_0x4aed86&&_0x23550f['splice'](_0x3ceedb,0x1);}for(const _0x32d4a7 of _0x11b15b){let _0x48c417=null;for(const _0x2981dd of _0x23550f){if(_0x2981dd[_0x2198da(0x13e)](_0x32d4a7[_0x2198da(0x102)],this[_0x2198da(0x12d)][_0x2198da(0x11b)][_0x2198da(0x140)],this[_0x2198da(0x11f)])){_0x48c417=_0x2981dd;break;}}if(_0x48c417){_0x48c417['touches']++;if(_0x32d4a7['price']>_0x48c417[_0x2198da(0x154)])_0x48c417['priceHigh']=_0x32d4a7['price'];if(_0x32d4a7['price']<_0x48c417['priceLow'])_0x48c417['priceLow']=_0x32d4a7[_0x2198da(0x102)];_0x48c417[_0x2198da(0xdb)]=Math[_0x2198da(0xd6)](0x1,0.3+_0x48c417[_0x2198da(0x131)]*0.15);}else{const _0x405218=_0x32d4a7[_0x2198da(0x128)]==='high'?ZoneType[_0x2198da(0x11c)]:ZoneType['SUPPORT'],_0x41bcea=new LiquidityZone(_0x405218,_0x32d4a7[_0x2198da(0x102)]+_0x4560ca/0x2,_0x32d4a7['price']-_0x4560ca/0x2,_0x32d4a7['timestamp'],_0x32d4a7[_0x2198da(0xd8)]);_0x41bcea['qualityScore']=0.3+_0x32d4a7['strength']*0.1,_0x23550f['push'](_0x41bcea);}}}[_0xe9f20f(0x110)](_0x33c591,_0x3dd663,_0x42754b){const _0x5e0543=_0xe9f20f,_0x347eeb=this['liquidityZones'][_0x5e0543(0x162)](_0x33c591),_0x9bf91f=_0x3dd663[_0x42754b],_0x3aa74b=_0x9bf91f['close'],_0x4d106f=this['config']['sweep'],_0x308030=this[_0x5e0543(0x12d)][_0x5e0543(0x11b)];for(const _0x116804 of _0x347eeb){if(_0x116804['lastUsedBarIndex']>=0x0&&_0x42754b-_0x116804['lastUsedBarIndex']<_0x308030['cooldownBars'])continue;const _0x4b4f65=_0x116804['getLevel'](),_0x5410b5=Math['abs'](_0x3aa74b-_0x4b4f65)/this[_0x5e0543(0x11f)];if(_0x5410b5>_0x308030[_0x5e0543(0x13c)])continue;const _0x2bf3f0=Math[_0x5e0543(0x148)](0x0,_0x42754b-_0x4d106f[_0x5e0543(0x101)]*0x2);for(let _0x264c8f=_0x2bf3f0;_0x264c8f<_0x42754b;_0x264c8f++){const _0x31ff71=_0x3dd663[_0x264c8f];if(_0x116804['type']===ZoneType['RESISTANCE']){const _0x599f59=(_0x31ff71['high']-_0x116804['priceHigh'])/this['tickSize'];if(_0x599f59>=_0x4d106f[_0x5e0543(0x145)]&&_0x599f59<=_0x4d106f[_0x5e0543(0x165)]){if(_0x3aa74b<_0x116804[_0x5e0543(0x154)]){const _0x30f63d=_0x31ff71['high']-_0x31ff71['low'],_0xc0a1c3=Math[_0x5e0543(0x143)](_0x31ff71['close']-_0x31ff71['open']),_0x458c86=_0x30f63d>0x0?_0xc0a1c3/_0x30f63d:0x0;if(_0x458c86>=_0x4d106f[_0x5e0543(0x103)]){const _0x2f6e10=this[_0x5e0543(0x13a)](_0x3dd663,_0x264c8f,0x14);if(_0x2f6e10>=_0x4d106f['minVolumeRatio']){const _0x1056ba=new SweepEvent(SweepType['HIGH_SWEEP'],_0x116804,_0x264c8f,_0x264c8f,_0x31ff71[_0x5e0543(0x15e)]);_0x1056ba['exitBarIndex']=_0x42754b,_0x1056ba['penetrationTicks']=_0x599f59,_0x1056ba['durationBars']=_0x42754b-_0x264c8f,_0x1056ba['volumeRatio']=_0x2f6e10,_0x1056ba['qualityScore']=this['_scoreSweep'](_0x1056ba,_0x458c86),_0x1056ba['isValid']=_0x1056ba['qualityScore']>=_0x4d106f['minQualityScore'];if(_0x1056ba[_0x5e0543(0xef)])return _0x1056ba;}}}}}if(_0x116804[_0x5e0543(0x128)]===ZoneType['SUPPORT']){const _0x4da648=(_0x116804['priceLow']-_0x31ff71['low'])/this['tickSize'];if(_0x4da648>=_0x4d106f[_0x5e0543(0x145)]&&_0x4da648<=_0x4d106f[_0x5e0543(0x165)]){if(_0x3aa74b>_0x116804['priceLow']){const _0x8d387d=_0x31ff71[_0x5e0543(0x15e)]-_0x31ff71['low'],_0x351997=Math[_0x5e0543(0x143)](_0x31ff71[_0x5e0543(0xfb)]-_0x31ff71[_0x5e0543(0xf4)]),_0x69c9cf=_0x8d387d>0x0?_0x351997/_0x8d387d:0x0;if(_0x69c9cf>=_0x4d106f['minBodyRatio']){const _0x1553c0=this[_0x5e0543(0x13a)](_0x3dd663,_0x264c8f,0x14);if(_0x1553c0>=_0x4d106f['minVolumeRatio']){const _0x568bb4=new SweepEvent(SweepType[_0x5e0543(0x11d)],_0x116804,_0x264c8f,_0x264c8f,_0x31ff71[_0x5e0543(0x116)]);_0x568bb4[_0x5e0543(0xce)]=_0x42754b,_0x568bb4['penetrationTicks']=_0x4da648,_0x568bb4['durationBars']=_0x42754b-_0x264c8f,_0x568bb4[_0x5e0543(0xec)]=_0x1553c0,_0x568bb4[_0x5e0543(0xdb)]=this[_0x5e0543(0x112)](_0x568bb4,_0x69c9cf),_0x568bb4['isValid']=_0x568bb4[_0x5e0543(0xdb)]>=_0x4d106f[_0x5e0543(0x150)];if(_0x568bb4['isValid'])return _0x568bb4;}}}}}}}return null;}[_0xe9f20f(0x13a)](_0x5af0cf,_0x24f08f,_0x13e0fc){const _0x107a8f=_0xe9f20f,_0x1bd95e=Math['max'](0x0,_0x24f08f-_0x13e0fc),_0x2fa2c2=_0x5af0cf['slice'](_0x1bd95e,_0x24f08f);if(_0x2fa2c2[_0x107a8f(0x105)]===0x0)return 0x1;const _0x317a15=_0x2fa2c2['map'](_0x32d43e=>_0x32d43e[_0x107a8f(0x167)])['sort']((_0x35b99c,_0x34801e)=>_0x35b99c-_0x34801e),_0x260e99=Math[_0x107a8f(0xf1)](_0x317a15['length']/0x2),_0x4f7e52=_0x317a15[_0x260e99]||0x1;return _0x5af0cf[_0x24f08f]['volume']/_0x4f7e52;}['_scoreSweep'](_0x715217,_0x2c7e1a){const _0x168cc8=_0xe9f20f;let _0x53f151=0x0;const _0x3ecb65=0x4,_0x308a5e=Math[_0x168cc8(0x143)](_0x715217['penetrationTicks']-_0x3ecb65);return _0x53f151+=Math['max'](0x0,0.3-_0x308a5e*0.03),_0x53f151+=Math[_0x168cc8(0x148)](0x0,0.25-_0x715217['durationBars']*0.05),_0x53f151+=Math[_0x168cc8(0xd6)](0.25,_0x715217['volumeRatio']*0.1),_0x53f151+=Math['min'](0.2,_0x2c7e1a*0.4),Math[_0x168cc8(0xd6)](0x1,_0x53f151);}[_0xe9f20f(0xe7)](_0x459bf3,_0xa9cc83,_0x25eb8c,_0x54b92b){const _0x445bec=_0xe9f20f;if(Date['now']()-this[_0x445bec(0x126)]<this['config'][_0x445bec(0xd1)][_0x445bec(0x144)])return null;const _0x52797c=this[_0x445bec(0x12d)][_0x445bec(0xd1)],_0x3c5bbf=_0xa9cc83['close'],_0x2e0a89=_0x54b92b[_0x445bec(0x160)]===SweepType['HIGH_SWEEP']?_0x445bec(0x13f):_0x445bec(0x14b);let _0x130a6a,_0x2a6fb8,_0x113cb0,_0x3b35d0;_0x2e0a89==='long'?(_0x130a6a=_0x3c5bbf-_0x52797c[_0x445bec(0x15b)]*this[_0x445bec(0x11f)],_0x2a6fb8=_0x3c5bbf+_0x52797c[_0x445bec(0x119)]*this[_0x445bec(0x11f)],_0x113cb0=_0x3c5bbf+_0x52797c[_0x445bec(0xd9)]*this['tickSize'],_0x3b35d0=_0x3c5bbf+_0x52797c[_0x445bec(0x115)]*this['tickSize']):(_0x130a6a=_0x3c5bbf+_0x52797c['stopTicks']*this['tickSize'],_0x2a6fb8=_0x3c5bbf-_0x52797c['targetTicks']*this['tickSize'],_0x113cb0=_0x3c5bbf-_0x52797c['breakevenTicks']*this[_0x445bec(0x11f)],_0x3b35d0=_0x3c5bbf-_0x52797c['trailTriggerTicks']*this[_0x445bec(0x11f)]);const _0x35c96e=_0x52797c['targetTicks']/_0x52797c[_0x445bec(0x15b)],_0x21d93c=Math['min'](0x1,_0x54b92b[_0x445bec(0xdb)]*0.5+_0x54b92b['zone']['qualityScore']*0.3+(_0x54b92b[_0x445bec(0xec)]>1.5?0.2:_0x54b92b[_0x445bec(0xec)]*0.1));let _0x53685e=SignalStrength[_0x445bec(0x157)];if(_0x21d93c>=0.8)_0x53685e=SignalStrength['VERY_STRONG'];else{if(_0x21d93c>=0.65)_0x53685e=SignalStrength['STRONG'];else{if(_0x21d93c<0.5)_0x53685e=SignalStrength['WEAK'];}}const _0xd274c6=0.5+(_0x21d93c-0.5)*0.4,_0x5d3f10=_0xd274c6*Math[_0x445bec(0x143)](_0x2a6fb8-_0x3c5bbf)-(0x1-_0xd274c6)*Math[_0x445bec(0x143)](_0x3c5bbf-_0x130a6a);_0x54b92b[_0x445bec(0x11b)][_0x445bec(0x12e)]=_0x25eb8c,_0x54b92b[_0x445bec(0x11b)][_0x445bec(0xd4)]=!![],_0x54b92b[_0x445bec(0x11b)][_0x445bec(0x118)]=new Date(_0xa9cc83[_0x445bec(0x141)]),this[_0x445bec(0x126)]=Date[_0x445bec(0x10c)](),this['stats']['signals']++;const _0x3d224a={'id':uuidv4(),'timestamp':Date['now'](),'symbol':_0x459bf3['split']('.')[0x0]||_0x459bf3,'contractId':_0x459bf3,'side':_0x2e0a89===_0x445bec(0x14b)?OrderSide[_0x445bec(0xd2)]:OrderSide[_0x445bec(0x123)],'direction':_0x2e0a89,'strategy':'HQX_2B_LIQUIDITY_SWEEP','strength':_0x53685e,'edge':_0x5d3f10,'confidence':_0x21d93c,'entry':_0x3c5bbf,'entryPrice':_0x3c5bbf,'stopLoss':_0x130a6a,'takeProfit':_0x2a6fb8,'riskReward':_0x35c96e,'stopTicks':_0x52797c['stopTicks'],'targetTicks':_0x52797c['targetTicks'],'breakevenTicks':_0x52797c[_0x445bec(0xd9)],'trailTriggerTicks':_0x52797c[_0x445bec(0x115)],'trailDistanceTicks':_0x52797c[_0x445bec(0x114)],'beLevel':_0x113cb0,'trailTrigger':_0x3b35d0,'sweepType':_0x54b92b[_0x445bec(0x160)],'penetrationTicks':_0x54b92b['penetrationTicks'],'sweepDurationBars':_0x54b92b['durationBars'],'sweepQuality':_0x54b92b[_0x445bec(0xdb)],'volumeRatio':_0x54b92b[_0x445bec(0xec)],'zoneType':_0x54b92b[_0x445bec(0x11b)]['type'],'zoneLevel':_0x54b92b['zone'][_0x445bec(0xdc)](),'zoneTouches':_0x54b92b[_0x445bec(0x11b)][_0x445bec(0x131)],'zoneQuality':_0x54b92b['zone'][_0x445bec(0xdb)],'expires':Date[_0x445bec(0x10c)]()+0xea60};return this[_0x445bec(0xee)](_0x445bec(0x14a),{'side':_0x2e0a89===_0x445bec(0x14b)?'buy':'sell','action':_0x445bec(0xf4),'reason':_0x445bec(0xd0)+_0x54b92b['sweepType']+'\x20|\x20Pen:'+_0x54b92b[_0x445bec(0xfd)]['toFixed'](0x1)+'t\x20|\x20Vol:'+_0x54b92b[_0x445bec(0xec)]['toFixed'](0x1)+_0x445bec(0xe6)+(_0x54b92b['qualityScore']*0x64)['toFixed'](0x0)+'%',..._0x3d224a}),this['emit']('log',{'type':_0x445bec(0xf6),'message':_0x445bec(0xf0)+_0x2e0a89[_0x445bec(0xfc)]()+'\x20@\x20'+_0x3c5bbf[_0x445bec(0x138)](0x2)+_0x445bec(0x137)+_0x54b92b['sweepType']+_0x445bec(0xd5)+_0x54b92b['penetrationTicks'][_0x445bec(0x138)](0x1)+_0x445bec(0x153)+_0x54b92b[_0x445bec(0xec)]['toFixed'](0x1)+'x\x20|\x20Conf:'+(_0x21d93c*0x64)['toFixed'](0x0)+'%'}),_0x3d224a;}['getAnalysisState'](_0x117c91,_0x353eb0){const _0x592b55=_0xe9f20f,_0x523a54=this['barHistory']['get'](_0x117c91)||[],_0x4fa58c=this['liquidityZones'][_0x592b55(0x162)](_0x117c91)||[],_0xaabaad=this['swingPoints'][_0x592b55(0x162)](_0x117c91)||[];if(_0x523a54[_0x592b55(0x105)]<0x5)return{'ready':![],'message':_0x592b55(0xd3)+_0x523a54[_0x592b55(0x105)]+_0x592b55(0x120)};const _0x4ee45c=_0x4fa58c[_0x592b55(0x100)](_0x9d3f1e=>({'zone':_0x9d3f1e,'distance':Math[_0x592b55(0x143)](_0x353eb0-_0x9d3f1e['getLevel']())}))[_0x592b55(0x155)]((_0x247322,_0x185170)=>_0x247322[_0x592b55(0x10b)]-_0x185170['distance']),_0xb3f821=_0x4ee45c[_0x592b55(0x149)](_0x4746ed=>_0x4746ed['zone']['type']===ZoneType['RESISTANCE']),_0x14355a=_0x4ee45c[_0x592b55(0x149)](_0xc6444b=>_0xc6444b['zone']['type']===ZoneType[_0x592b55(0x11e)]);return{'ready':!![],'barsProcessed':_0x523a54[_0x592b55(0x105)],'swingsDetected':_0xaabaad[_0x592b55(0x105)],'activeZones':_0x4fa58c[_0x592b55(0x105)],'nearestResistance':_0xb3f821?_0xb3f821[_0x592b55(0x11b)]['getLevel']():null,'nearestSupport':_0x14355a?_0x14355a['zone'][_0x592b55(0xdc)]():null,'stopTicks':this['config']['execution'][_0x592b55(0x15b)],'targetTicks':this[_0x592b55(0x12d)]['execution'][_0x592b55(0x119)],'strategy':'HQX-2B\x20Liquidity\x20Sweep\x20(Optimized)'};}['recordTradeResult'](_0x3fa498){const _0xfb4c45=_0xe9f20f;this['recentTrades']['push']({'netPnl':_0x3fa498,'timestamp':Date[_0xfb4c45(0x10c)]()});if(this['recentTrades'][_0xfb4c45(0x105)]>0x64)this['recentTrades'][_0xfb4c45(0x121)]();_0x3fa498>0x0?this[_0xfb4c45(0xed)]['wins']++:this['stats']['losses']++,this[_0xfb4c45(0xed)][_0xfb4c45(0x158)]++,this[_0xfb4c45(0xed)]['pnl']+=_0x3fa498,this['emit']('log',{'type':_0xfb4c45(0x15a),'message':_0xfb4c45(0x125)+(_0x3fa498>0x0?'WIN':_0xfb4c45(0x113))+'\x20$'+_0x3fa498['toFixed'](0x2)});}['getBarHistory'](_0x4a4ef4){return this['barHistory']['get'](_0x4a4ef4)||[];}['getStats'](){const _0x27458c=_0xe9f20f;return this[_0x27458c(0xed)];}['getHealthStatus'](_0x22046a){const _0x50a630=_0xe9f20f,_0x4e14a4=this['barHistory']['get'](_0x22046a)||[],_0x5f00d7=this['liquidityZones']['get'](_0x22046a)||[],_0x94637a=this[_0x50a630(0x135)]['get'](_0x22046a)||[],_0x5d9f9=this[_0x50a630(0x129)]['get'](_0x22046a),_0x442c6a=_0x4e14a4[_0x4e14a4['length']-0x1],_0x27dd93=_0x442c6a?Date[_0x50a630(0x10c)]()-_0x442c6a[_0x50a630(0x141)]:null,_0xa06375=_0x5f00d7['filter'](_0x4b71fd=>_0x4b71fd[_0x50a630(0x128)]===ZoneType['RESISTANCE'])['length'],_0x3b0605=_0x5f00d7['filter'](_0x931f3d=>_0x931f3d['type']===ZoneType['SUPPORT'])['length'];return{'healthy':_0x4e14a4[_0x50a630(0x105)]>=0x5,'barsTotal':_0x4e14a4['length'],'barsLast5Min':_0x4e14a4[_0x50a630(0xdd)](_0x5959b1=>Date[_0x50a630(0x10c)]()-_0x5959b1[_0x50a630(0x141)]<0x5*0x3c*0x3e8)[_0x50a630(0x105)],'swingsTotal':_0x94637a['length'],'zonesResistance':_0xa06375,'zonesSupport':_0x3b0605,'zonesTotal':_0x5f00d7[_0x50a630(0x105)],'currentBarTicks':_0x5d9f9?_0x5d9f9[_0x50a630(0xf7)]:0x0,'isAggregating':_0x5d9f9&&_0x5d9f9['tickCount']>0x0,'timeSinceLastBarMs':_0x27dd93,'lastSignalTime':this[_0x50a630(0x126)],'signalCooldownMs':this['config'][_0x50a630(0xd1)][_0x50a630(0x144)],'uptime':Date[_0x50a630(0x10c)]()-(this['startTime']||Date[_0x50a630(0x10c)]())};}['reset'](_0x4d21e3){const _0x81d339=_0xe9f20f;this['barHistory'][_0x81d339(0x12f)](_0x4d21e3,[]),this[_0x81d339(0x135)]['set'](_0x4d21e3,[]),this['liquidityZones']['set'](_0x4d21e3,[]),this['activeSweeps'][_0x81d339(0x12f)](_0x4d21e3,[]),this[_0x81d339(0x129)][_0x81d339(0xcf)](_0x4d21e3),this[_0x81d339(0xee)](_0x81d339(0x147),{'type':'info','message':'[HQX-2B]\x20Reset\x20state\x20for\x20'+_0x4d21e3});}[_0xe9f20f(0x122)](_0xc696c9,_0x3c9c5c){const _0x51100a=_0xe9f20f;if(!_0x3c9c5c||_0x3c9c5c[_0x51100a(0x105)]===0x0){this[_0x51100a(0xee)]('log',{'type':'debug','message':_0x51100a(0xf5)});return;}!this['barHistory'][_0x51100a(0xe4)](_0xc696c9)&&this[_0x51100a(0x14e)](_0xc696c9);const _0x151797=[..._0x3c9c5c][_0x51100a(0x155)]((_0x2eb83d,_0x248e94)=>_0x2eb83d['timestamp']-_0x248e94[_0x51100a(0x141)]);this[_0x51100a(0xee)](_0x51100a(0x147),{'type':_0x51100a(0xf6),'message':_0x51100a(0x166)+_0x151797[_0x51100a(0x105)]+_0x51100a(0x152)});let _0x2568ca=0x0;for(const _0x555de6 of _0x151797){const _0x2661e4=this[_0x51100a(0x133)](_0xc696c9,_0x555de6);if(_0x2661e4)_0x2568ca++;}const _0x365fcb=this['barHistory']['get'](_0xc696c9)||[],_0x3a7213=this['swingPoints'][_0x51100a(0x162)](_0xc696c9)||[],_0x570063=this[_0x51100a(0x10e)][_0x51100a(0x162)](_0xc696c9)||[];this['emit']('log',{'type':_0x51100a(0xf6),'message':_0x51100a(0xda)+_0x365fcb[_0x51100a(0x105)]+_0x51100a(0xde)+_0x3a7213[_0x51100a(0x105)]+_0x51100a(0x117)+_0x570063[_0x51100a(0x105)]+_0x51100a(0x107)}),_0x2568ca>0x0&&this[_0x51100a(0xee)](_0x51100a(0x147),{'type':'debug','message':'[HQX-2B]\x20'+_0x2568ca+'\x20historical\x20signals\x20detected\x20(ignored)'}),this[_0x51100a(0x126)]=0x0;}}class HQX2BStrategy extends EventEmitter{constructor(_0x1f50df={}){const _0x220419=_0xe9f20f;super(),this['config']=_0x1f50df,this[_0x220419(0x161)]=new HQX2BLiquiditySweep(_0x1f50df),this[_0x220419(0x161)]['on']('signal',_0x2a966f=>this[_0x220419(0xee)](_0x220419(0x14a),_0x2a966f)),this['strategy']['on']('log',_0x4ccb1d=>this['emit']('log',_0x4ccb1d));}[_0xe9f20f(0xe5)](_0x4c941a){const _0x2133c8=_0xe9f20f;return this[_0x2133c8(0x161)][_0x2133c8(0xe5)](_0x4c941a);}[_0xe9f20f(0x104)](_0x5df28d){const _0x21704=_0xe9f20f;return this['strategy'][_0x21704(0x104)](_0x5df28d);}['onTrade'](_0x25ad89){const _0x473f51=_0xe9f20f;return this[_0x473f51(0x161)]['onTrade'](_0x25ad89);}['processBar'](_0x5eb77b,_0x537689){return this['strategy']['processBar'](_0x5eb77b,_0x537689);}[_0xe9f20f(0x14e)](_0x4b323d,_0x407c44,_0x1a10eb){const _0x1bed4c=_0xe9f20f;return this[_0x1bed4c(0x161)]['initialize'](_0x4b323d,_0x407c44,_0x1a10eb);}[_0xe9f20f(0xdf)](_0x2ed4bd,_0x253fd2){const _0x33c5f5=_0xe9f20f;return this[_0x33c5f5(0x161)]['getAnalysisState'](_0x2ed4bd,_0x253fd2);}['recordTradeResult'](_0x358ab5){const _0x39ca76=_0xe9f20f;return this[_0x39ca76(0x161)][_0x39ca76(0x15f)](_0x358ab5);}[_0xe9f20f(0xf9)](_0x34eb0b){return this['strategy']['reset'](_0x34eb0b);}['getStats'](){const _0x5ac039=_0xe9f20f;return this[_0x5ac039(0x161)]['getStats']();}[_0xe9f20f(0x109)](_0x5ac205){const _0x264270=_0xe9f20f;return this[_0x264270(0x161)]['getBarHistory'](_0x5ac205);}[_0xe9f20f(0x122)](_0x4bec42,_0x5291ec){return this['strategy']['preloadBars'](_0x4bec42,_0x5291ec);}['getHealthStatus'](_0x112d40){const _0x503d92=_0xe9f20f;return this[_0x503d92(0x161)][_0x503d92(0x12b)](_0x112d40);}[_0xe9f20f(0x12c)](_0x4f9670){return null;}}module['exports']={'HQX2BLiquiditySweep':HQX2BLiquiditySweep,'HQX2BStrategy':HQX2BStrategy,'M2':HQX2BStrategy,'S2':HQX2BLiquiditySweep,'OrderSide':OrderSide,'SignalStrength':SignalStrength,'SweepType':SweepType,'ZoneType':ZoneType,'DEFAULT_CONFIG':DEFAULT_CONFIG};