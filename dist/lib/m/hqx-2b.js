const _0x6bd883=_0x1b28;(function(_0x7ab99b,_0x14856f){const _0x1c406c=_0x1b28,_0x3f9313=_0x7ab99b();while(!![]){try{const _0x2c5226=parseInt(_0x1c406c(0x13c))/0x1*(parseInt(_0x1c406c(0x17b))/0x2)+-parseInt(_0x1c406c(0x13a))/0x3+parseInt(_0x1c406c(0x187))/0x4*(parseInt(_0x1c406c(0x1ba))/0x5)+-parseInt(_0x1c406c(0x19a))/0x6*(-parseInt(_0x1c406c(0x194))/0x7)+-parseInt(_0x1c406c(0x177))/0x8*(parseInt(_0x1c406c(0x190))/0x9)+parseInt(_0x1c406c(0x17f))/0xa+parseInt(_0x1c406c(0x18a))/0xb*(-parseInt(_0x1c406c(0x148))/0xc);if(_0x2c5226===_0x14856f)break;else _0x3f9313['push'](_0x3f9313['shift']());}catch(_0x56d6e8){_0x3f9313['push'](_0x3f9313['shift']());}}}(_0x2269,0xdf148));const EventEmitter=require('events'),{v4:uuidv4}=require('uuid'),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4},SweepType={'HIGH_SWEEP':_0x6bd883(0x18f),'LOW_SWEEP':_0x6bd883(0x145)},ZoneType={'RESISTANCE':_0x6bd883(0x16c),'SUPPORT':_0x6bd883(0x142)},DEFAULT_CONFIG={'tickSize':0.25,'tickValue':0x5,'swing':{'lookbackBars':0x1,'minStrength':0x1,'confirmationBars':0x1},'zone':{'clusterToleranceTicks':0x8,'minTouches':0x1,'maxZoneAgeBars':0x1f4,'maxZoneDistanceTicks':0x50,'cooldownBars':0x3},'sweep':{'minPenetrationTicks':0.25,'maxPenetrationTicks':0x14,'maxDurationBars':0xa,'minQualityScore':0.1,'minVolumeRatio':0.3,'minBodyRatio':0.05},'execution':{'stopTicks':0xa,'targetTicks':0x28,'breakevenTicks':0x4,'trailTriggerTicks':0x8,'trailDistanceTicks':0x4,'cooldownMs':0x1388,'minHoldTimeMs':0x1388,'slippageTicks':0x1,'commissionPerSide':0x2},'session':{'enabled':![],'startHour':0x9,'startMinute':0x1e,'endHour':0x10,'endMinute':0x0,'timezone':_0x6bd883(0x186)}};function _0x2269(){const _0x1517a6=['minPenetrationTicks','t\x20Vol:','tickSize','get','touches','getUTCMinutes','\x20historical\x20bars...','barHistory','trailTriggerTicks','sweptAt','max','getUTCHours','targetTicks',',\x20value=','\x20|\x20Pen:','_generateSignal','swing','isValid','barIntervalMs','close','minQualityScore','price','VERY_STRONG','extremePrice','activeSweeps','tickValue','strength','zone','x\x20|\x20Q:','t\x20|\x20Q:\x20','volume','_getVolumeRatio','resistance','floor','volumeRatio','cooldownBars','recentTrades','long','push','execution','strategy','clusterToleranceTicks','stats','536WPOSjN','durationBars','maxZoneDistanceTicks','BID','184010qmMxrA','priceHigh','sweepType','STRONG','18143490UrkTOU','slice','getStats','\x20|\x20Pen:\x20','length','sort','trades','America/New_York','8ZWkURE','isWithinSession','lastUsedBarIndex','517IilhXr','[2B]\x20Signal\x20blocked\x20by\x20cooldown\x20(','minVolumeRatio','symbol','\x20|\x20Total:\x20','high','232731zqVsQH','_mergeConfig','onTrade','[2B]\x20NEW\x20SWING\x20','1589emaoEJ','isArray','getBarHistory','min','exitBarIndex','RESISTANCE','32310kNcZxf','processBar','ASK','distance','barIndex','minBodyRatio','swept','type','trailDistanceTicks','stopTicks','\x20swings,\x20','maxZoneAgeBars','timestamp','breakevenTicks','penetrationTicks','lastSignalTime','getLevel','info','_scoreSweep','_updateZones','[HQX-2B]\x20Preloading\x20','swingPoints','HIGH_SWEEP','filter','config','open','abs','\x20@\x20','debug','HQX_2B_LIQUIDITY_SWEEP','delete','/5\x20bars','1391290eqaspJ','initialize','shift','signal','t\x20|\x20Vol:','LOSS','containsPrice','map','[HQX-2B]\x20Reset\x20state\x20for\x20','qualityScore','[2B]\x20SWEEP\x20','priceLow','getAnalysisState','cooldownMs','session','currentBar','_detectSwings','log','extremeBarIndex','onTick','toUpperCase','startTime','4196232xpAIuV','emit','13xnISXy','set','signals','liquidityZones','toFixed','processTick','support','now','isDST','low','object','pnl','190032TqnNRB','recordTradeResult','LOW_SWEEP','getTimezoneOffset'];_0x2269=function(){return _0x1517a6;};return _0x2269();}function _0x1b28(_0x19b825,_0x3e5ece){_0x19b825=_0x19b825-0x128;const _0x22691a=_0x2269();let _0x1b28f3=_0x22691a[_0x19b825];return _0x1b28f3;}class SwingPoint{constructor(_0xd582fe,_0x53f8df,_0x388d79,_0x719249,_0x3fe300=0x1){const _0x57c018=_0x6bd883;this[_0x57c018(0x1a1)]=_0xd582fe,this['price']=_0x53f8df,this[_0x57c018(0x19e)]=_0x388d79,this[_0x57c018(0x1a6)]=_0x719249,this['strength']=_0x3fe300;}}class LiquidityZone{constructor(_0x2094f9,_0x2d3106,_0xbbbadf,_0x19c525,_0x1902bf){const _0x1e7835=_0x6bd883;this['id']=uuidv4(),this['type']=_0x2094f9,this['priceHigh']=_0x2d3106,this['priceLow']=_0xbbbadf,this['createdAt']=_0x19c525,this['barIndex']=_0x1902bf,this[_0x1e7835(0x150)]=0x1,this[_0x1e7835(0x1a0)]=![],this[_0x1e7835(0x155)]=null,this['lastUsedBarIndex']=-0x3e7,this[_0x1e7835(0x12d)]=0.5;}[_0x6bd883(0x12a)](_0x2168fb,_0x2a628a,_0x11c0be){const _0x2154d2=_0x2a628a*_0x11c0be;return _0x2168fb>=this['priceLow']-_0x2154d2&&_0x2168fb<=this['priceHigh']+_0x2154d2;}['getLevel'](){const _0x316529=_0x6bd883;return(this[_0x316529(0x17c)]+this['priceLow'])/0x2;}}class SweepEvent{constructor(_0x2d91ed,_0x3c4faf,_0xe96c46,_0x1a980d,_0x3304e8){const _0x117230=_0x6bd883;this[_0x117230(0x17d)]=_0x2d91ed,this['zone']=_0x3c4faf,this['entryBarIndex']=_0xe96c46,this[_0x117230(0x136)]=_0x1a980d,this[_0x117230(0x163)]=_0x3304e8,this[_0x117230(0x198)]=null,this[_0x117230(0x15d)]=![],this['qualityScore']=0x0,this[_0x117230(0x1a8)]=0x0,this['durationBars']=0x0,this['volumeRatio']=0x1;}}class HQX2BLiquiditySweep extends EventEmitter{constructor(_0x28376d={}){const _0xb0deba=_0x6bd883;super(),this['config']=this['_mergeConfig'](DEFAULT_CONFIG,_0x28376d),this['tickSize']=this['config']['tickSize'],this['tickValue']=this[_0xb0deba(0x1b2)][_0xb0deba(0x165)],this[_0xb0deba(0x153)]=new Map(),this['swingPoints']=new Map(),this[_0xb0deba(0x13f)]=new Map(),this[_0xb0deba(0x164)]=new Map(),this['currentBar']=new Map(),this[_0xb0deba(0x15e)]=0xea60,this['lastSignalTime']=0x0,this['startTime']=Date[_0xb0deba(0x143)](),this['stats']={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0},this[_0xb0deba(0x170)]=[];}[_0x6bd883(0x191)](_0x127c7c,_0x3f8204){const _0x1fd84a=_0x6bd883,_0x6b4413={..._0x127c7c};for(const _0x47d930 in _0x3f8204){typeof _0x3f8204[_0x47d930]===_0x1fd84a(0x146)&&!Array[_0x1fd84a(0x195)](_0x3f8204[_0x47d930])?_0x6b4413[_0x47d930]={..._0x127c7c[_0x47d930],..._0x3f8204[_0x47d930]}:_0x6b4413[_0x47d930]=_0x3f8204[_0x47d930];}return _0x6b4413;}[_0x6bd883(0x188)](_0x2426a5){const _0x26a51a=_0x6bd883;if(!this['config'][_0x26a51a(0x132)]['enabled'])return!![];const _0x405cd3=new Date(_0x2426a5),_0x5b0c56=this['isDST'](_0x405cd3)?-0x4:-0x5,_0x54c6e1=_0x405cd3[_0x26a51a(0x157)](),_0x25e01f=_0x405cd3[_0x26a51a(0x151)](),_0x3dab3c=(_0x54c6e1+_0x5b0c56+0x18)%0x18,{startHour:_0x31dd26,startMinute:_0x26387d,endHour:_0x8ef801,endMinute:_0x23a2cd}=this[_0x26a51a(0x1b2)]['session'],_0x578b23=_0x3dab3c*0x3c+_0x25e01f,_0x35a5c9=_0x31dd26*0x3c+_0x26387d,_0x447a7f=_0x8ef801*0x3c+_0x23a2cd;return _0x578b23>=_0x35a5c9&&_0x578b23<_0x447a7f;}[_0x6bd883(0x144)](_0x85504a){const _0x35f301=_0x6bd883,_0x53109f=new Date(_0x85504a['getFullYear'](),0x0,0x1),_0x2e2fd3=new Date(_0x85504a['getFullYear'](),0x6,0x1),_0x98230d=Math['max'](_0x53109f[_0x35f301(0x14b)](),_0x2e2fd3['getTimezoneOffset']());return _0x85504a['getTimezoneOffset']()<_0x98230d;}[_0x6bd883(0x1bb)](_0x5961fd,_0x2c0456=0.25,_0x241ef0=0x5){const _0x79c2a4=_0x6bd883;this[_0x79c2a4(0x14e)]=_0x2c0456,this[_0x79c2a4(0x165)]=_0x241ef0,this[_0x79c2a4(0x1b2)][_0x79c2a4(0x14e)]=_0x2c0456,this[_0x79c2a4(0x1b2)]['tickValue']=_0x241ef0,this[_0x79c2a4(0x153)]['set'](_0x5961fd,[]),this['swingPoints'][_0x79c2a4(0x13d)](_0x5961fd,[]),this[_0x79c2a4(0x13f)]['set'](_0x5961fd,[]),this['activeSweeps']['set'](_0x5961fd,[]),this[_0x79c2a4(0x133)]['delete'](_0x5961fd),this['emit'](_0x79c2a4(0x135),{'type':_0x79c2a4(0x1ab),'message':'[HQX-2B]\x20Initialized\x20for\x20'+_0x5961fd+':\x20tick='+_0x2c0456+_0x79c2a4(0x159)+_0x241ef0+',\x20TF=1min'}),this['emit']('log',{'type':'info','message':'[HQX-2B]\x20Params:\x20Stop='+this[_0x79c2a4(0x1b2)][_0x79c2a4(0x173)]['stopTicks']+'t,\x20Target='+this['config'][_0x79c2a4(0x173)]['targetTicks']+'t,\x20BE='+this[_0x79c2a4(0x1b2)]['execution'][_0x79c2a4(0x1a7)]+'t,\x20Trail='+this['config']['execution'][_0x79c2a4(0x154)]+'/'+this[_0x79c2a4(0x1b2)]['execution'][_0x79c2a4(0x1a2)]});}['processTick'](_0x4b7d71){const _0x4a2e9e=_0x6bd883,{contractId:_0x1f95ec,price:_0x56480d,volume:_0x40b469,timestamp:_0x521d92}=_0x4b7d71,_0x586627=_0x521d92||Date[_0x4a2e9e(0x143)](),_0x41ba19=_0x40b469||0x1;if(!this[_0x4a2e9e(0x188)](_0x586627))return null;let _0x2815d6=this[_0x4a2e9e(0x133)]['get'](_0x1f95ec);const _0x403614=Math[_0x4a2e9e(0x16d)](_0x586627/this[_0x4a2e9e(0x15e)])*this[_0x4a2e9e(0x15e)];if(!_0x2815d6||_0x2815d6[_0x4a2e9e(0x139)]!==_0x403614){if(_0x2815d6){const _0x32dd47={'timestamp':_0x2815d6['startTime'],'open':_0x2815d6[_0x4a2e9e(0x1b3)],'high':_0x2815d6[_0x4a2e9e(0x18f)],'low':_0x2815d6[_0x4a2e9e(0x145)],'close':_0x2815d6['close'],'volume':_0x2815d6['volume']},_0x516498=this[_0x4a2e9e(0x19b)](_0x1f95ec,_0x32dd47);return this['currentBar']['set'](_0x1f95ec,{'startTime':_0x403614,'open':_0x56480d,'high':_0x56480d,'low':_0x56480d,'close':_0x56480d,'volume':_0x41ba19}),_0x516498;}else return this['currentBar'][_0x4a2e9e(0x13d)](_0x1f95ec,{'startTime':_0x403614,'open':_0x56480d,'high':_0x56480d,'low':_0x56480d,'close':_0x56480d,'volume':_0x41ba19}),null;}else return _0x2815d6['high']=Math[_0x4a2e9e(0x156)](_0x2815d6[_0x4a2e9e(0x18f)],_0x56480d),_0x2815d6[_0x4a2e9e(0x145)]=Math['min'](_0x2815d6['low'],_0x56480d),_0x2815d6['close']=_0x56480d,_0x2815d6[_0x4a2e9e(0x16a)]+=_0x41ba19,null;}['onTick'](_0x238002){return this['processTick'](_0x238002);}['onTrade'](_0x519855){const _0x3ec686=_0x6bd883;return this[_0x3ec686(0x141)]({'contractId':_0x519855['contractId']||_0x519855[_0x3ec686(0x18d)],'price':_0x519855['price'],'volume':_0x519855['size']||_0x519855['volume']||0x1,'timestamp':_0x519855['timestamp']||Date['now']()});}['processBar'](_0x311b64,_0x334a7a){const _0x1cd56a=_0x6bd883;let _0x56b630=this['barHistory']['get'](_0x311b64);!_0x56b630&&(this[_0x1cd56a(0x1bb)](_0x311b64),_0x56b630=this['barHistory']['get'](_0x311b64));_0x56b630['push'](_0x334a7a);if(_0x56b630[_0x1cd56a(0x183)]>0x1f4)_0x56b630[_0x1cd56a(0x1bc)]();const _0x22846c=_0x56b630[_0x1cd56a(0x183)]-0x1;if(_0x56b630['length']<this[_0x1cd56a(0x1b2)]['swing']['lookbackBars']*0x3)return null;const _0x25f6d9=this[_0x1cd56a(0x1af)][_0x1cd56a(0x14f)](_0x311b64)['length'];this[_0x1cd56a(0x134)](_0x311b64,_0x56b630,_0x22846c);const _0x2c535e=this[_0x1cd56a(0x1af)]['get'](_0x311b64);if(_0x2c535e[_0x1cd56a(0x183)]>_0x25f6d9){const _0x526f56=_0x2c535e[_0x2c535e[_0x1cd56a(0x183)]-0x1];this[_0x1cd56a(0x13b)]('log',{'type':'debug','message':_0x1cd56a(0x193)+_0x526f56[_0x1cd56a(0x1a1)][_0x1cd56a(0x138)]()+'\x20@\x20'+_0x526f56['price']['toFixed'](0x2)+_0x1cd56a(0x18e)+_0x2c535e[_0x1cd56a(0x183)]});}const _0x8856c7=this['liquidityZones']['get'](_0x311b64)[_0x1cd56a(0x183)];this[_0x1cd56a(0x1ad)](_0x311b64,_0x22846c);const _0x30e41e=this[_0x1cd56a(0x13f)]['get'](_0x311b64);if(_0x30e41e[_0x1cd56a(0x183)]>_0x8856c7){const _0x582654=_0x30e41e[_0x30e41e['length']-0x1];this['emit'](_0x1cd56a(0x135),{'type':'debug','message':'[2B]\x20NEW\x20ZONE\x20'+_0x582654[_0x1cd56a(0x1a1)]['toUpperCase']()+_0x1cd56a(0x1b5)+_0x582654[_0x1cd56a(0x1aa)]()['toFixed'](0x2)+_0x1cd56a(0x18e)+_0x30e41e['length']});}const _0x256f09=this['_detectSweep'](_0x311b64,_0x56b630,_0x22846c);_0x256f09&&this['emit']('log',{'type':'debug','message':_0x1cd56a(0x12e)+_0x256f09['sweepType']+'\x20|\x20Valid:\x20'+_0x256f09['isValid']+_0x1cd56a(0x182)+_0x256f09['penetrationTicks']['toFixed'](0x1)+_0x1cd56a(0x169)+(_0x256f09[_0x1cd56a(0x12d)]*0x64)[_0x1cd56a(0x140)](0x0)+'%'});if(_0x256f09&&_0x256f09['isValid']){this[_0x1cd56a(0x13b)](_0x1cd56a(0x135),{'type':'debug','message':'[2B]\x20Calling\x20_generateSignal\x20for\x20'+_0x256f09[_0x1cd56a(0x17d)]+'\x20sweep...'});const _0x1c12dc=this[_0x1cd56a(0x15b)](_0x311b64,_0x334a7a,_0x22846c,_0x256f09);return!_0x1c12dc&&this['emit'](_0x1cd56a(0x135),{'type':'debug','message':'[2B]\x20_generateSignal\x20returned\x20null\x20(likely\x20cooldown)'}),_0x1c12dc;}return null;}['_detectSwings'](_0x4d1fae,_0x414a54,_0x59ea16){const _0x6b4d33=_0x6bd883,_0x10390a=this['config'][_0x6b4d33(0x15c)]['lookbackBars'],_0x2f1fc7=this[_0x6b4d33(0x1b2)][_0x6b4d33(0x15c)]['minStrength'];if(_0x59ea16<_0x10390a*0x2)return;const _0x1f4889=this[_0x6b4d33(0x1af)]['get'](_0x4d1fae),_0x15b31d=_0x59ea16-_0x10390a,_0x539cb1=_0x414a54[_0x15b31d];let _0x14fd43=!![],_0x4e3d24=0x0;for(let _0x239f93=_0x15b31d-_0x10390a;_0x239f93<=_0x15b31d+_0x10390a;_0x239f93++){if(_0x239f93===_0x15b31d||_0x239f93<0x0||_0x239f93>=_0x414a54[_0x6b4d33(0x183)])continue;if(_0x414a54[_0x239f93][_0x6b4d33(0x18f)]>=_0x539cb1['high']){_0x14fd43=![];break;}_0x4e3d24++;}if(_0x14fd43&&_0x4e3d24>=_0x2f1fc7){const _0xfcab44=_0x1f4889['find'](_0x55c24b=>_0x55c24b['barIndex']===_0x15b31d&&_0x55c24b[_0x6b4d33(0x1a1)]==='high');!_0xfcab44&&_0x1f4889[_0x6b4d33(0x172)](new SwingPoint('high',_0x539cb1['high'],_0x15b31d,_0x539cb1['timestamp'],_0x4e3d24));}let _0x13a66c=!![],_0x4a29c8=0x0;for(let _0x25d79c=_0x15b31d-_0x10390a;_0x25d79c<=_0x15b31d+_0x10390a;_0x25d79c++){if(_0x25d79c===_0x15b31d||_0x25d79c<0x0||_0x25d79c>=_0x414a54['length'])continue;if(_0x414a54[_0x25d79c][_0x6b4d33(0x145)]<=_0x539cb1['low']){_0x13a66c=![];break;}_0x4a29c8++;}if(_0x13a66c&&_0x4a29c8>=_0x2f1fc7){const _0x2ced81=_0x1f4889['find'](_0x2c47d4=>_0x2c47d4[_0x6b4d33(0x19e)]===_0x15b31d&&_0x2c47d4['type']===_0x6b4d33(0x145));!_0x2ced81&&_0x1f4889[_0x6b4d33(0x172)](new SwingPoint(_0x6b4d33(0x145),_0x539cb1['low'],_0x15b31d,_0x539cb1['timestamp'],_0x4a29c8));}const _0x2b3026=this[_0x6b4d33(0x1b2)][_0x6b4d33(0x167)][_0x6b4d33(0x1a5)];while(_0x1f4889['length']>0x0&&_0x1f4889[0x0]['barIndex']<_0x59ea16-_0x2b3026){_0x1f4889[_0x6b4d33(0x1bc)]();}}[_0x6bd883(0x1ad)](_0x2b8fe6,_0xcc0711){const _0x3712a2=_0x6bd883,_0xe74d36=this[_0x3712a2(0x1af)][_0x3712a2(0x14f)](_0x2b8fe6),_0x3b7994=this[_0x3712a2(0x13f)][_0x3712a2(0x14f)](_0x2b8fe6),_0x550ebb=this[_0x3712a2(0x1b2)][_0x3712a2(0x167)][_0x3712a2(0x175)]*this['tickSize'],_0x11ff82=this['config'][_0x3712a2(0x167)]['maxZoneAgeBars'];for(let _0x4a8f9e=_0x3b7994[_0x3712a2(0x183)]-0x1;_0x4a8f9e>=0x0;_0x4a8f9e--){_0xcc0711-_0x3b7994[_0x4a8f9e]['barIndex']>_0x11ff82&&_0x3b7994['splice'](_0x4a8f9e,0x1);}for(const _0x48b474 of _0xe74d36){let _0x4c7363=null;for(const _0x38e8d1 of _0x3b7994){if(_0x38e8d1[_0x3712a2(0x12a)](_0x48b474[_0x3712a2(0x161)],this['config']['zone']['clusterToleranceTicks'],this[_0x3712a2(0x14e)])){_0x4c7363=_0x38e8d1;break;}}if(_0x4c7363){_0x4c7363['touches']++;if(_0x48b474['price']>_0x4c7363[_0x3712a2(0x17c)])_0x4c7363['priceHigh']=_0x48b474[_0x3712a2(0x161)];if(_0x48b474['price']<_0x4c7363[_0x3712a2(0x12f)])_0x4c7363[_0x3712a2(0x12f)]=_0x48b474[_0x3712a2(0x161)];_0x4c7363[_0x3712a2(0x12d)]=Math[_0x3712a2(0x197)](0x1,0.3+_0x4c7363['touches']*0.15);}else{const _0x29d502=_0x48b474[_0x3712a2(0x1a1)]===_0x3712a2(0x18f)?ZoneType['RESISTANCE']:ZoneType['SUPPORT'],_0x227d3b=new LiquidityZone(_0x29d502,_0x48b474[_0x3712a2(0x161)]+_0x550ebb/0x2,_0x48b474[_0x3712a2(0x161)]-_0x550ebb/0x2,_0x48b474[_0x3712a2(0x1a6)],_0x48b474[_0x3712a2(0x19e)]);_0x227d3b['qualityScore']=0.3+_0x48b474[_0x3712a2(0x166)]*0.1,_0x3b7994[_0x3712a2(0x172)](_0x227d3b);}}}['_detectSweep'](_0x3f80a4,_0x2efa83,_0x559316){const _0x77f2d6=_0x6bd883,_0x30f620=this[_0x77f2d6(0x13f)][_0x77f2d6(0x14f)](_0x3f80a4),_0xb4ab52=_0x2efa83[_0x559316],_0x2493b2=_0xb4ab52[_0x77f2d6(0x15f)],_0x27aba8=this[_0x77f2d6(0x1b2)]['sweep'],_0x35ee20=this['config']['zone'];for(const _0x5797a3 of _0x30f620){if(_0x5797a3[_0x77f2d6(0x189)]>=0x0&&_0x559316-_0x5797a3[_0x77f2d6(0x189)]<_0x35ee20[_0x77f2d6(0x16f)])continue;const _0x4a97f1=_0x5797a3['getLevel'](),_0x5b53bc=Math[_0x77f2d6(0x1b4)](_0x2493b2-_0x4a97f1)/this['tickSize'];if(_0x5b53bc>_0x35ee20[_0x77f2d6(0x179)])continue;const _0x4045e4=Math['max'](0x0,_0x559316-_0x27aba8['maxDurationBars']*0x2);for(let _0x598eac=_0x4045e4;_0x598eac<_0x559316;_0x598eac++){const _0x4c545e=_0x2efa83[_0x598eac];if(_0x5797a3['type']===ZoneType[_0x77f2d6(0x199)]){const _0x5d0513=(_0x4c545e['high']-_0x5797a3['priceHigh'])/this[_0x77f2d6(0x14e)];if(_0x5d0513>=_0x27aba8[_0x77f2d6(0x14c)]&&_0x5d0513<=_0x27aba8['maxPenetrationTicks']){if(_0x2493b2<_0x5797a3['priceHigh']){const _0x253cbd=_0x4c545e['high']-_0x4c545e[_0x77f2d6(0x145)],_0x40f2d0=Math[_0x77f2d6(0x1b4)](_0x4c545e['close']-_0x4c545e[_0x77f2d6(0x1b3)]),_0x2eca35=_0x253cbd>0x0?_0x40f2d0/_0x253cbd:0x0;if(_0x2eca35>=_0x27aba8['minBodyRatio']){const _0x380879=this['_getVolumeRatio'](_0x2efa83,_0x598eac,0x14);if(_0x380879>=_0x27aba8['minVolumeRatio']){const _0x5b9744=new SweepEvent(SweepType[_0x77f2d6(0x1b0)],_0x5797a3,_0x598eac,_0x598eac,_0x4c545e['high']);_0x5b9744['exitBarIndex']=_0x559316,_0x5b9744[_0x77f2d6(0x1a8)]=_0x5d0513,_0x5b9744['durationBars']=_0x559316-_0x598eac,_0x5b9744[_0x77f2d6(0x16e)]=_0x380879,_0x5b9744['qualityScore']=this['_scoreSweep'](_0x5b9744,_0x2eca35),_0x5b9744[_0x77f2d6(0x15d)]=_0x5b9744['qualityScore']>=_0x27aba8[_0x77f2d6(0x160)];if(_0x5b9744[_0x77f2d6(0x15d)])return _0x5b9744;}}}}}if(_0x5797a3[_0x77f2d6(0x1a1)]===ZoneType['SUPPORT']){const _0x523546=(_0x5797a3['priceLow']-_0x4c545e['low'])/this[_0x77f2d6(0x14e)];if(_0x523546>=_0x27aba8[_0x77f2d6(0x14c)]&&_0x523546<=_0x27aba8['maxPenetrationTicks']){if(_0x2493b2>_0x5797a3[_0x77f2d6(0x12f)]){const _0x593a96=_0x4c545e[_0x77f2d6(0x18f)]-_0x4c545e['low'],_0x56e581=Math[_0x77f2d6(0x1b4)](_0x4c545e['close']-_0x4c545e[_0x77f2d6(0x1b3)]),_0x5d4341=_0x593a96>0x0?_0x56e581/_0x593a96:0x0;if(_0x5d4341>=_0x27aba8[_0x77f2d6(0x19f)]){const _0x2f53f4=this[_0x77f2d6(0x16b)](_0x2efa83,_0x598eac,0x14);if(_0x2f53f4>=_0x27aba8[_0x77f2d6(0x18c)]){const _0x3c8605=new SweepEvent(SweepType[_0x77f2d6(0x14a)],_0x5797a3,_0x598eac,_0x598eac,_0x4c545e[_0x77f2d6(0x145)]);_0x3c8605[_0x77f2d6(0x198)]=_0x559316,_0x3c8605[_0x77f2d6(0x1a8)]=_0x523546,_0x3c8605['durationBars']=_0x559316-_0x598eac,_0x3c8605['volumeRatio']=_0x2f53f4,_0x3c8605['qualityScore']=this[_0x77f2d6(0x1ac)](_0x3c8605,_0x5d4341),_0x3c8605[_0x77f2d6(0x15d)]=_0x3c8605[_0x77f2d6(0x12d)]>=_0x27aba8['minQualityScore'];if(_0x3c8605[_0x77f2d6(0x15d)])return _0x3c8605;}}}}}}}return null;}['_getVolumeRatio'](_0x36c5da,_0x2a5286,_0x5da978){const _0x1118f0=_0x6bd883,_0x23cbc4=Math['max'](0x0,_0x2a5286-_0x5da978),_0x2be2de=_0x36c5da[_0x1118f0(0x180)](_0x23cbc4,_0x2a5286);if(_0x2be2de['length']===0x0)return 0x1;const _0x4929c2=_0x2be2de[_0x1118f0(0x12b)](_0x30fb0b=>_0x30fb0b[_0x1118f0(0x16a)])[_0x1118f0(0x184)]((_0x45c64f,_0x1ecda5)=>_0x45c64f-_0x1ecda5),_0x5895aa=Math[_0x1118f0(0x16d)](_0x4929c2[_0x1118f0(0x183)]/0x2),_0x43b6c1=_0x4929c2[_0x5895aa]||0x1;return _0x36c5da[_0x2a5286]['volume']/_0x43b6c1;}['_scoreSweep'](_0x2044bb,_0x56d79f){const _0xbd538a=_0x6bd883;let _0x39b248=0x0;const _0x9a8e86=0x4,_0x589c59=Math['abs'](_0x2044bb['penetrationTicks']-_0x9a8e86);return _0x39b248+=Math['max'](0x0,0.3-_0x589c59*0.03),_0x39b248+=Math[_0xbd538a(0x156)](0x0,0.25-_0x2044bb['durationBars']*0.05),_0x39b248+=Math[_0xbd538a(0x197)](0.25,_0x2044bb['volumeRatio']*0.1),_0x39b248+=Math[_0xbd538a(0x197)](0.2,_0x56d79f*0.4),Math[_0xbd538a(0x197)](0x1,_0x39b248);}['_generateSignal'](_0x5c2233,_0x3c2b17,_0x4c2d7b,_0x4f605a){const _0x418ea4=_0x6bd883,_0x2c19bc=Date['now']()-this['lastSignalTime'];if(_0x2c19bc<this['config']['execution']['cooldownMs'])return this[_0x418ea4(0x13b)](_0x418ea4(0x135),{'type':'debug','message':_0x418ea4(0x18b)+(_0x2c19bc/0x3e8)['toFixed'](0x1)+'s\x20<\x20'+this['config'][_0x418ea4(0x173)]['cooldownMs']/0x3e8+'s)'}),null;const _0x111684=this['config']['execution'],_0x5ed780=_0x3c2b17['close'],_0x4905d7=_0x4f605a['sweepType']===SweepType[_0x418ea4(0x1b0)]?'short':'long';let _0x446789,_0x4bc9ee,_0x2e6dcf,_0x463b60;_0x4905d7===_0x418ea4(0x171)?(_0x446789=_0x5ed780-_0x111684[_0x418ea4(0x1a3)]*this[_0x418ea4(0x14e)],_0x4bc9ee=_0x5ed780+_0x111684[_0x418ea4(0x158)]*this['tickSize'],_0x2e6dcf=_0x5ed780+_0x111684['breakevenTicks']*this[_0x418ea4(0x14e)],_0x463b60=_0x5ed780+_0x111684['trailTriggerTicks']*this[_0x418ea4(0x14e)]):(_0x446789=_0x5ed780+_0x111684[_0x418ea4(0x1a3)]*this['tickSize'],_0x4bc9ee=_0x5ed780-_0x111684['targetTicks']*this[_0x418ea4(0x14e)],_0x2e6dcf=_0x5ed780-_0x111684['breakevenTicks']*this[_0x418ea4(0x14e)],_0x463b60=_0x5ed780-_0x111684[_0x418ea4(0x154)]*this[_0x418ea4(0x14e)]);const _0xa95765=_0x111684[_0x418ea4(0x158)]/_0x111684[_0x418ea4(0x1a3)],_0x19aea1=Math[_0x418ea4(0x197)](0x1,_0x4f605a[_0x418ea4(0x12d)]*0.5+_0x4f605a[_0x418ea4(0x167)][_0x418ea4(0x12d)]*0.3+(_0x4f605a[_0x418ea4(0x16e)]>1.5?0.2:_0x4f605a[_0x418ea4(0x16e)]*0.1));let _0x289a65=SignalStrength['MODERATE'];if(_0x19aea1>=0.8)_0x289a65=SignalStrength[_0x418ea4(0x162)];else{if(_0x19aea1>=0.65)_0x289a65=SignalStrength[_0x418ea4(0x17e)];else{if(_0x19aea1<0.5)_0x289a65=SignalStrength['WEAK'];}}const _0x473d71=0.5+(_0x19aea1-0.5)*0.4,_0x4e3a6e=_0x473d71*Math[_0x418ea4(0x1b4)](_0x4bc9ee-_0x5ed780)-(0x1-_0x473d71)*Math[_0x418ea4(0x1b4)](_0x5ed780-_0x446789);_0x4f605a[_0x418ea4(0x167)]['lastUsedBarIndex']=_0x4c2d7b,_0x4f605a['zone'][_0x418ea4(0x1a0)]=!![],_0x4f605a[_0x418ea4(0x167)]['sweptAt']=new Date(_0x3c2b17[_0x418ea4(0x1a6)]),this[_0x418ea4(0x1a9)]=Date['now'](),this[_0x418ea4(0x176)][_0x418ea4(0x13e)]++;const _0x463c2a={'id':uuidv4(),'timestamp':Date['now'](),'symbol':_0x5c2233['split']('.')[0x0]||_0x5c2233,'contractId':_0x5c2233,'side':_0x4905d7===_0x418ea4(0x171)?OrderSide[_0x418ea4(0x17a)]:OrderSide[_0x418ea4(0x19c)],'direction':_0x4905d7,'strategy':_0x418ea4(0x1b7),'strength':_0x289a65,'edge':_0x4e3a6e,'confidence':_0x19aea1,'entry':_0x5ed780,'entryPrice':_0x5ed780,'stopLoss':_0x446789,'takeProfit':_0x4bc9ee,'riskReward':_0xa95765,'stopTicks':_0x111684[_0x418ea4(0x1a3)],'targetTicks':_0x111684['targetTicks'],'breakevenTicks':_0x111684[_0x418ea4(0x1a7)],'trailTriggerTicks':_0x111684[_0x418ea4(0x154)],'trailDistanceTicks':_0x111684['trailDistanceTicks'],'beLevel':_0x2e6dcf,'trailTrigger':_0x463b60,'sweepType':_0x4f605a['sweepType'],'penetrationTicks':_0x4f605a[_0x418ea4(0x1a8)],'sweepDurationBars':_0x4f605a[_0x418ea4(0x178)],'sweepQuality':_0x4f605a['qualityScore'],'volumeRatio':_0x4f605a[_0x418ea4(0x16e)],'zoneType':_0x4f605a[_0x418ea4(0x167)]['type'],'zoneLevel':_0x4f605a['zone']['getLevel'](),'zoneTouches':_0x4f605a['zone']['touches'],'zoneQuality':_0x4f605a['zone'][_0x418ea4(0x12d)],'expires':Date['now']()+0xea60};return this['emit'](_0x418ea4(0x1bd),{'side':_0x4905d7===_0x418ea4(0x171)?'buy':'sell','action':_0x418ea4(0x1b3),'reason':'2B\x20'+_0x4f605a[_0x418ea4(0x17d)]+'\x20|\x20Pen:'+_0x4f605a['penetrationTicks']['toFixed'](0x1)+_0x418ea4(0x128)+_0x4f605a[_0x418ea4(0x16e)]['toFixed'](0x1)+_0x418ea4(0x168)+(_0x4f605a['qualityScore']*0x64)['toFixed'](0x0)+'%',..._0x463c2a}),this['emit'](_0x418ea4(0x135),{'type':_0x418ea4(0x1ab),'message':'[HQX-2B]\x20SIGNAL:\x20'+_0x4905d7[_0x418ea4(0x138)]()+_0x418ea4(0x1b5)+_0x5ed780['toFixed'](0x2)+'\x20|\x20'+_0x4f605a['sweepType']+_0x418ea4(0x15a)+_0x4f605a[_0x418ea4(0x1a8)]['toFixed'](0x1)+_0x418ea4(0x14d)+_0x4f605a['volumeRatio'][_0x418ea4(0x140)](0x1)+'x\x20|\x20Conf:'+(_0x19aea1*0x64)['toFixed'](0x0)+'%'}),_0x463c2a;}[_0x6bd883(0x130)](_0x2225e1,_0x180094){const _0x2c129a=_0x6bd883,_0x2af404=this[_0x2c129a(0x153)][_0x2c129a(0x14f)](_0x2225e1)||[],_0x1f3cee=this[_0x2c129a(0x13f)]['get'](_0x2225e1)||[],_0x189d80=this[_0x2c129a(0x1af)]['get'](_0x2225e1)||[];if(_0x2af404['length']<0x5)return{'ready':![],'message':'Collecting\x20data...\x20'+_0x2af404['length']+_0x2c129a(0x1b9)};const _0x27f432=_0x1f3cee[_0x2c129a(0x12b)](_0x50b506=>({'zone':_0x50b506,'distance':Math[_0x2c129a(0x1b4)](_0x180094-_0x50b506['getLevel']())}))[_0x2c129a(0x184)]((_0x2d6138,_0x194817)=>_0x2d6138[_0x2c129a(0x19d)]-_0x194817['distance']),_0x273b03=_0x27f432['find'](_0x38f0ea=>_0x38f0ea['zone']['type']===ZoneType['RESISTANCE']),_0x5ee4ed=_0x27f432['find'](_0x146b3d=>_0x146b3d['zone'][_0x2c129a(0x1a1)]===ZoneType['SUPPORT']);return{'ready':!![],'barsProcessed':_0x2af404[_0x2c129a(0x183)],'swingsDetected':_0x189d80['length'],'activeZones':_0x1f3cee['length'],'nearestResistance':_0x273b03?_0x273b03[_0x2c129a(0x167)]['getLevel']():null,'nearestSupport':_0x5ee4ed?_0x5ee4ed[_0x2c129a(0x167)]['getLevel']():null,'stopTicks':this[_0x2c129a(0x1b2)]['execution']['stopTicks'],'targetTicks':this['config']['execution'][_0x2c129a(0x158)],'strategy':'HQX-2B\x20Liquidity\x20Sweep\x20(Optimized)'};}[_0x6bd883(0x149)](_0x23e5f1){const _0x1a17f8=_0x6bd883;this[_0x1a17f8(0x170)][_0x1a17f8(0x172)]({'netPnl':_0x23e5f1,'timestamp':Date['now']()});if(this[_0x1a17f8(0x170)]['length']>0x64)this[_0x1a17f8(0x170)][_0x1a17f8(0x1bc)]();_0x23e5f1>0x0?this['stats']['wins']++:this[_0x1a17f8(0x176)]['losses']++,this['stats'][_0x1a17f8(0x185)]++,this[_0x1a17f8(0x176)][_0x1a17f8(0x147)]+=_0x23e5f1,this[_0x1a17f8(0x13b)]('log',{'type':_0x1a17f8(0x1b6),'message':'[HQX-2B]\x20Trade\x20result:\x20'+(_0x23e5f1>0x0?'WIN':_0x1a17f8(0x129))+'\x20$'+_0x23e5f1['toFixed'](0x2)});}[_0x6bd883(0x196)](_0x2a56a5){const _0x2e5271=_0x6bd883;return this[_0x2e5271(0x153)][_0x2e5271(0x14f)](_0x2a56a5)||[];}[_0x6bd883(0x181)](){const _0x490317=_0x6bd883;return this[_0x490317(0x176)];}['getHealthStatus'](_0x1e5605){const _0x54482f=_0x6bd883,_0x18d252=this['barHistory']['get'](_0x1e5605)||[],_0x5221b3=this['liquidityZones']['get'](_0x1e5605)||[],_0x177d37=this['swingPoints'][_0x54482f(0x14f)](_0x1e5605)||[],_0x139f92=this[_0x54482f(0x133)][_0x54482f(0x14f)](_0x1e5605),_0x5321dd=_0x18d252[_0x18d252[_0x54482f(0x183)]-0x1],_0x755d0d=_0x5321dd?Date['now']()-_0x5321dd[_0x54482f(0x1a6)]:null,_0x3198f3=_0x5221b3['filter'](_0x39e347=>_0x39e347[_0x54482f(0x1a1)]===ZoneType['RESISTANCE'])['length'],_0x4a4bf5=_0x5221b3['filter'](_0x2b170c=>_0x2b170c['type']===ZoneType['SUPPORT'])[_0x54482f(0x183)];return{'healthy':_0x18d252[_0x54482f(0x183)]>=0x5,'barsTotal':_0x18d252['length'],'barsLast5Min':_0x18d252[_0x54482f(0x1b1)](_0x196b4e=>Date[_0x54482f(0x143)]()-_0x196b4e[_0x54482f(0x1a6)]<0x5*0x3c*0x3e8)['length'],'swingsTotal':_0x177d37[_0x54482f(0x183)],'zonesResistance':_0x3198f3,'zonesSupport':_0x4a4bf5,'zonesTotal':_0x5221b3[_0x54482f(0x183)],'currentBarTicks':_0x139f92?_0x139f92['tickCount']:0x0,'isAggregating':_0x139f92&&_0x139f92['tickCount']>0x0,'timeSinceLastBarMs':_0x755d0d,'lastSignalTime':this['lastSignalTime'],'signalCooldownMs':this[_0x54482f(0x1b2)]['execution'][_0x54482f(0x131)],'uptime':Date[_0x54482f(0x143)]()-(this[_0x54482f(0x139)]||Date['now']())};}['reset'](_0x3469ea){const _0x3a64f4=_0x6bd883;this[_0x3a64f4(0x153)][_0x3a64f4(0x13d)](_0x3469ea,[]),this['swingPoints']['set'](_0x3469ea,[]),this[_0x3a64f4(0x13f)]['set'](_0x3469ea,[]),this[_0x3a64f4(0x164)]['set'](_0x3469ea,[]),this[_0x3a64f4(0x133)][_0x3a64f4(0x1b8)](_0x3469ea),this['emit']('log',{'type':_0x3a64f4(0x1ab),'message':_0x3a64f4(0x12c)+_0x3469ea});}['preloadBars'](_0x37e8a0,_0x10004e){const _0x553c60=_0x6bd883;if(!_0x10004e||_0x10004e[_0x553c60(0x183)]===0x0){this[_0x553c60(0x13b)]('log',{'type':'debug','message':'[HQX-2B]\x20No\x20historical\x20bars\x20to\x20preload'});return;}!this[_0x553c60(0x153)]['has'](_0x37e8a0)&&this[_0x553c60(0x1bb)](_0x37e8a0);const _0x5d0fce=[..._0x10004e]['sort']((_0x12f85d,_0x529d3e)=>_0x12f85d[_0x553c60(0x1a6)]-_0x529d3e['timestamp']);this[_0x553c60(0x13b)](_0x553c60(0x135),{'type':'info','message':_0x553c60(0x1ae)+_0x5d0fce[_0x553c60(0x183)]+_0x553c60(0x152)});let _0x5b4c16=0x0;for(const _0x400832 of _0x5d0fce){const _0x433146=this['processBar'](_0x37e8a0,_0x400832);if(_0x433146)_0x5b4c16++;}const _0x3a76ee=this['barHistory'][_0x553c60(0x14f)](_0x37e8a0)||[],_0x4107d1=this[_0x553c60(0x1af)][_0x553c60(0x14f)](_0x37e8a0)||[],_0x539a70=this['liquidityZones']['get'](_0x37e8a0)||[];this['emit'](_0x553c60(0x135),{'type':_0x553c60(0x1ab),'message':'[HQX-2B]\x20Preload\x20complete:\x20'+_0x3a76ee[_0x553c60(0x183)]+'\x20bars,\x20'+_0x4107d1[_0x553c60(0x183)]+_0x553c60(0x1a4)+_0x539a70['length']+'\x20zones'}),_0x5b4c16>0x0&&this['emit']('log',{'type':'debug','message':'[HQX-2B]\x20'+_0x5b4c16+'\x20historical\x20signals\x20detected\x20(ignored)'}),this['lastSignalTime']=0x0;}}class HQX2BStrategy extends EventEmitter{constructor(_0x4e9476={}){const _0x59b944=_0x6bd883;super(),this[_0x59b944(0x1b2)]=_0x4e9476,this['strategy']=new HQX2BLiquiditySweep(_0x4e9476),this[_0x59b944(0x174)]['on'](_0x59b944(0x1bd),_0x27e551=>this['emit'](_0x59b944(0x1bd),_0x27e551)),this[_0x59b944(0x174)]['on'](_0x59b944(0x135),_0x32868c=>this[_0x59b944(0x13b)](_0x59b944(0x135),_0x32868c));}[_0x6bd883(0x141)](_0x2fc9b3){const _0x4599cd=_0x6bd883;return this[_0x4599cd(0x174)][_0x4599cd(0x141)](_0x2fc9b3);}['onTick'](_0x5b4ed2){const _0x4d6142=_0x6bd883;return this[_0x4d6142(0x174)][_0x4d6142(0x137)](_0x5b4ed2);}[_0x6bd883(0x192)](_0x584f36){const _0x2cd319=_0x6bd883;return this[_0x2cd319(0x174)][_0x2cd319(0x192)](_0x584f36);}[_0x6bd883(0x19b)](_0x54ee63,_0x14d266){const _0x68ea79=_0x6bd883;return this[_0x68ea79(0x174)][_0x68ea79(0x19b)](_0x54ee63,_0x14d266);}['initialize'](_0x441735,_0xb7564a,_0x4a944e){const _0x13f056=_0x6bd883;return this[_0x13f056(0x174)][_0x13f056(0x1bb)](_0x441735,_0xb7564a,_0x4a944e);}[_0x6bd883(0x130)](_0x2c52a2,_0x4ec048){const _0x548c83=_0x6bd883;return this[_0x548c83(0x174)]['getAnalysisState'](_0x2c52a2,_0x4ec048);}[_0x6bd883(0x149)](_0x58414d){const _0x2dceb6=_0x6bd883;return this[_0x2dceb6(0x174)][_0x2dceb6(0x149)](_0x58414d);}['reset'](_0x539dfa){const _0x2cb79a=_0x6bd883;return this[_0x2cb79a(0x174)]['reset'](_0x539dfa);}['getStats'](){return this['strategy']['getStats']();}['getBarHistory'](_0x3ff480){return this['strategy']['getBarHistory'](_0x3ff480);}['preloadBars'](_0x363dfb,_0x5624cd){return this['strategy']['preloadBars'](_0x363dfb,_0x5624cd);}['getHealthStatus'](_0xe079ed){return this['strategy']['getHealthStatus'](_0xe079ed);}['generateSignal'](_0x16bf39){return null;}}module['exports']={'HQX2BLiquiditySweep':HQX2BLiquiditySweep,'HQX2BStrategy':HQX2BStrategy,'M2':HQX2BStrategy,'S2':HQX2BLiquiditySweep,'OrderSide':OrderSide,'SignalStrength':SignalStrength,'SweepType':SweepType,'ZoneType':ZoneType,'DEFAULT_CONFIG':DEFAULT_CONFIG};