const _0x42d110=_0x3be2;(function(_0x1e7907,_0x949076){const _0x59dfca=_0x3be2,_0xeb804b=_0x1e7907();while(!![]){try{const _0x5e7a71=-parseInt(_0x59dfca(0x23a))/0x1*(-parseInt(_0x59dfca(0x22c))/0x2)+parseInt(_0x59dfca(0x257))/0x3+parseInt(_0x59dfca(0x256))/0x4*(-parseInt(_0x59dfca(0x252))/0x5)+-parseInt(_0x59dfca(0x21a))/0x6+parseInt(_0x59dfca(0x1fb))/0x7*(-parseInt(_0x59dfca(0x221))/0x8)+-parseInt(_0x59dfca(0x245))/0x9+parseInt(_0x59dfca(0x227))/0xa;if(_0x5e7a71===_0x949076)break;else _0xeb804b['push'](_0xeb804b['shift']());}catch(_0x27abfa){_0xeb804b['push'](_0xeb804b['shift']());}}}(_0x1d4b,0x9270e));function _0x3be2(_0x1efabc,_0x16e272){_0x1efabc=_0x1efabc-0x1ce;const _0x1d4b2b=_0x1d4b();let _0x3be218=_0x1d4b2b[_0x1efabc];return _0x3be218;}const EventEmitter=require(_0x42d110(0x23b)),{v4:uuidv4}=require(_0x42d110(0x24e)),OrderSide={'BID':0x0,'ASK':0x1},SignalStrength={'WEAK':0x1,'MODERATE':0x2,'STRONG':0x3,'VERY_STRONG':0x4},SweepType={'HIGH_SWEEP':'high','LOW_SWEEP':_0x42d110(0x251)},ZoneType={'RESISTANCE':_0x42d110(0x233),'SUPPORT':_0x42d110(0x1f0)},DEFAULT_CONFIG={'tickSize':0.25,'tickValue':0x5,'swing':{'lookbackBars':0x1,'minStrength':0x1,'confirmationBars':0x1},'zone':{'clusterToleranceTicks':0x8,'minTouches':0x1,'maxZoneAgeBars':0x1f4,'maxZoneDistanceTicks':0x50,'cooldownBars':0x3},'sweep':{'minPenetrationTicks':0.5,'maxPenetrationTicks':0x14,'maxDurationBars':0xa,'minQualityScore':0.2,'minVolumeRatio':0.5,'minBodyRatio':0.1},'execution':{'stopTicks':0xa,'targetTicks':0x28,'breakevenTicks':0x4,'trailTriggerTicks':0x8,'trailDistanceTicks':0x4,'cooldownMs':0x3a98,'minHoldTimeMs':0x1388,'slippageTicks':0x1,'commissionPerSide':0x2},'session':{'enabled':!![],'startHour':0x9,'startMinute':0x1e,'endHour':0x10,'endMinute':0x0,'timezone':_0x42d110(0x1f4)}};class SwingPoint{constructor(_0x9aeb87,_0x1b12eb,_0x25b7d8,_0x31277a,_0x40b9c6=0x1){const _0x4b8ffd=_0x42d110;this['type']=_0x9aeb87,this[_0x4b8ffd(0x25c)]=_0x1b12eb,this[_0x4b8ffd(0x1ef)]=_0x25b7d8,this['timestamp']=_0x31277a,this['strength']=_0x40b9c6;}}class LiquidityZone{constructor(_0x45ca8a,_0x19217b,_0x4e691f,_0x234adc,_0x386b06){const _0x58f61f=_0x42d110;this['id']=uuidv4(),this[_0x58f61f(0x220)]=_0x45ca8a,this[_0x58f61f(0x25b)]=_0x19217b,this[_0x58f61f(0x1df)]=_0x4e691f,this['createdAt']=_0x234adc,this['barIndex']=_0x386b06,this[_0x58f61f(0x230)]=0x1,this[_0x58f61f(0x23d)]=![],this[_0x58f61f(0x1d3)]=null,this['lastUsedBarIndex']=-0x3e7,this[_0x58f61f(0x1d4)]=0.5;}[_0x42d110(0x25e)](_0x5ae7d5,_0x28e0ef,_0x3a2d4e){const _0x544960=_0x28e0ef*_0x3a2d4e;return _0x5ae7d5>=this['priceLow']-_0x544960&&_0x5ae7d5<=this['priceHigh']+_0x544960;}['getLevel'](){const _0x95461b=_0x42d110;return(this[_0x95461b(0x25b)]+this['priceLow'])/0x2;}}class SweepEvent{constructor(_0x2141ee,_0x1daa13,_0x228bde,_0x1d1fe9,_0x453ed4){const _0x2c0998=_0x42d110;this[_0x2c0998(0x1ff)]=_0x2141ee,this[_0x2c0998(0x223)]=_0x1daa13,this['entryBarIndex']=_0x228bde,this[_0x2c0998(0x208)]=_0x1d1fe9,this['extremePrice']=_0x453ed4,this[_0x2c0998(0x1e5)]=null,this[_0x2c0998(0x1d0)]=![],this[_0x2c0998(0x1d4)]=0x0,this['penetrationTicks']=0x0,this[_0x2c0998(0x207)]=0x0,this[_0x2c0998(0x24a)]=0x1;}}class HQX2BLiquiditySweep extends EventEmitter{constructor(_0x14aa1e={}){const _0x2c41d9=_0x42d110;super(),this['config']=this[_0x2c41d9(0x1e9)](DEFAULT_CONFIG,_0x14aa1e),this['tickSize']=this[_0x2c41d9(0x22b)]['tickSize'],this['tickValue']=this[_0x2c41d9(0x22b)][_0x2c41d9(0x212)],this['barHistory']=new Map(),this[_0x2c41d9(0x1ee)]=new Map(),this['liquidityZones']=new Map(),this[_0x2c41d9(0x237)]=new Map(),this['currentBar']=new Map(),this['barIntervalMs']=0xea60,this['lastSignalTime']=0x0,this['startTime']=Date['now'](),this[_0x2c41d9(0x1f2)]={'signals':0x0,'trades':0x0,'wins':0x0,'losses':0x0,'pnl':0x0},this['recentTrades']=[];}['_mergeConfig'](_0x555779,_0x42191e){const _0x115b51=_0x42d110,_0x5d1ae0={..._0x555779};for(const _0x20505d in _0x42191e){typeof _0x42191e[_0x20505d]===_0x115b51(0x218)&&!Array[_0x115b51(0x241)](_0x42191e[_0x20505d])?_0x5d1ae0[_0x20505d]={..._0x555779[_0x20505d],..._0x42191e[_0x20505d]}:_0x5d1ae0[_0x20505d]=_0x42191e[_0x20505d];}return _0x5d1ae0;}['isWithinSession'](_0x3f5ec5){const _0x4c16cb=_0x42d110;if(!this[_0x4c16cb(0x22b)][_0x4c16cb(0x20e)][_0x4c16cb(0x1db)])return!![];const _0x4d524f=new Date(_0x3f5ec5),_0x1a7fc9=this['isDST'](_0x4d524f)?-0x4:-0x5,_0xfd4b53=_0x4d524f['getUTCHours'](),_0xd39bbe=_0x4d524f['getUTCMinutes'](),_0x72695b=(_0xfd4b53+_0x1a7fc9+0x18)%0x18,{startHour:_0x13c7b1,startMinute:_0x5fdf18,endHour:_0x58aed0,endMinute:_0x4c293c}=this['config'][_0x4c16cb(0x20e)],_0x116996=_0x72695b*0x3c+_0xd39bbe,_0x55fd7d=_0x13c7b1*0x3c+_0x5fdf18,_0x445507=_0x58aed0*0x3c+_0x4c293c;return _0x116996>=_0x55fd7d&&_0x116996<_0x445507;}['isDST'](_0x56bc1c){const _0x2d20b7=_0x42d110,_0x3796a=new Date(_0x56bc1c[_0x2d20b7(0x1cf)](),0x0,0x1),_0x1c1255=new Date(_0x56bc1c['getFullYear'](),0x6,0x1),_0x382784=Math[_0x2d20b7(0x1f6)](_0x3796a[_0x2d20b7(0x258)](),_0x1c1255['getTimezoneOffset']());return _0x56bc1c['getTimezoneOffset']()<_0x382784;}[_0x42d110(0x259)](_0x25c1c0,_0x73eb84=0.25,_0x21d975=0x5){const _0x17c80c=_0x42d110;this[_0x17c80c(0x20b)]=_0x73eb84,this[_0x17c80c(0x212)]=_0x21d975,this[_0x17c80c(0x22b)]['tickSize']=_0x73eb84,this[_0x17c80c(0x22b)][_0x17c80c(0x212)]=_0x21d975,this[_0x17c80c(0x214)]['set'](_0x25c1c0,[]),this[_0x17c80c(0x1ee)]['set'](_0x25c1c0,[]),this['liquidityZones']['set'](_0x25c1c0,[]),this['activeSweeps'][_0x17c80c(0x211)](_0x25c1c0,[]),this[_0x17c80c(0x228)]['delete'](_0x25c1c0),this['emit'](_0x17c80c(0x248),{'type':_0x17c80c(0x1dd),'message':'[HQX-2B]\x20Initialized\x20for\x20'+_0x25c1c0+_0x17c80c(0x20f)+_0x73eb84+_0x17c80c(0x1fa)+_0x21d975+_0x17c80c(0x1e6)}),this['emit'](_0x17c80c(0x248),{'type':'info','message':'[HQX-2B]\x20Params:\x20Stop='+this[_0x17c80c(0x22b)]['execution']['stopTicks']+'t,\x20Target='+this['config'][_0x17c80c(0x1fd)]['targetTicks']+'t,\x20BE='+this[_0x17c80c(0x22b)]['execution'][_0x17c80c(0x22e)]+_0x17c80c(0x1dc)+this[_0x17c80c(0x22b)]['execution']['trailTriggerTicks']+'/'+this['config']['execution']['trailDistanceTicks']});}['processTick'](_0x448053){const _0x3625d6=_0x42d110,{contractId:_0x1829b5,price:_0x232540,volume:_0x182a0e,timestamp:_0x15d3de}=_0x448053,_0x5570c6=_0x15d3de||Date['now'](),_0x25c35e=_0x182a0e||0x1;if(!this['isWithinSession'](_0x5570c6))return null;let _0x52a8d2=this['currentBar']['get'](_0x1829b5);const _0x27d017=Math[_0x3625d6(0x1ea)](_0x5570c6/this[_0x3625d6(0x247)])*this['barIntervalMs'];if(!_0x52a8d2||_0x52a8d2[_0x3625d6(0x204)]!==_0x27d017){if(_0x52a8d2){const _0x2643e9={'timestamp':_0x52a8d2[_0x3625d6(0x204)],'open':_0x52a8d2['open'],'high':_0x52a8d2['high'],'low':_0x52a8d2[_0x3625d6(0x251)],'close':_0x52a8d2['close'],'volume':_0x52a8d2[_0x3625d6(0x1e8)]},_0x2dcab6=this['processBar'](_0x1829b5,_0x2643e9);return this[_0x3625d6(0x228)][_0x3625d6(0x211)](_0x1829b5,{'startTime':_0x27d017,'open':_0x232540,'high':_0x232540,'low':_0x232540,'close':_0x232540,'volume':_0x25c35e}),_0x2dcab6;}else return this['currentBar'][_0x3625d6(0x211)](_0x1829b5,{'startTime':_0x27d017,'open':_0x232540,'high':_0x232540,'low':_0x232540,'close':_0x232540,'volume':_0x25c35e}),null;}else return _0x52a8d2['high']=Math['max'](_0x52a8d2[_0x3625d6(0x249)],_0x232540),_0x52a8d2[_0x3625d6(0x251)]=Math[_0x3625d6(0x253)](_0x52a8d2['low'],_0x232540),_0x52a8d2[_0x3625d6(0x22d)]=_0x232540,_0x52a8d2[_0x3625d6(0x1e8)]+=_0x25c35e,null;}[_0x42d110(0x1e4)](_0x7c6e1f){const _0x1fbbc4=_0x42d110;return this[_0x1fbbc4(0x250)](_0x7c6e1f);}[_0x42d110(0x1e1)](_0x117959){const _0x1ce320=_0x42d110;return this['processTick']({'contractId':_0x117959['contractId']||_0x117959['symbol'],'price':_0x117959['price'],'volume':_0x117959['size']||_0x117959['volume']||0x1,'timestamp':_0x117959[_0x1ce320(0x1e3)]||Date[_0x1ce320(0x21f)]()});}[_0x42d110(0x1d2)](_0x15cf51,_0x1d966b){const _0x542b18=_0x42d110;let _0x301634=this[_0x542b18(0x214)]['get'](_0x15cf51);!_0x301634&&(this[_0x542b18(0x259)](_0x15cf51),_0x301634=this['barHistory']['get'](_0x15cf51));_0x301634[_0x542b18(0x1d7)](_0x1d966b);if(_0x301634['length']>0x1f4)_0x301634[_0x542b18(0x20d)]();const _0xc55f8=_0x301634['length']-0x1;if(_0x301634['length']<this['config'][_0x542b18(0x23f)][_0x542b18(0x1e0)]*0x3)return null;const _0x399170=this['swingPoints']['get'](_0x15cf51)[_0x542b18(0x1f5)];this[_0x542b18(0x215)](_0x15cf51,_0x301634,_0xc55f8);const _0x5145d1=this['swingPoints'][_0x542b18(0x231)](_0x15cf51);if(_0x5145d1['length']>_0x399170){const _0x360100=_0x5145d1[_0x5145d1[_0x542b18(0x1f5)]-0x1];this['emit'](_0x542b18(0x248),{'type':_0x542b18(0x255),'message':'[2B]\x20NEW\x20SWING\x20'+_0x360100['type']['toUpperCase']()+_0x542b18(0x25f)+_0x360100[_0x542b18(0x25c)][_0x542b18(0x224)](0x2)+_0x542b18(0x1ce)+_0x5145d1[_0x542b18(0x1f5)]});}const _0x19b44e=this[_0x542b18(0x21b)][_0x542b18(0x231)](_0x15cf51)[_0x542b18(0x1f5)];this[_0x542b18(0x225)](_0x15cf51,_0xc55f8);const _0x2489e2=this[_0x542b18(0x21b)][_0x542b18(0x231)](_0x15cf51);if(_0x2489e2['length']>_0x19b44e){const _0x443a0d=_0x2489e2[_0x2489e2[_0x542b18(0x1f5)]-0x1];this[_0x542b18(0x254)](_0x542b18(0x248),{'type':'debug','message':'[2B]\x20NEW\x20ZONE\x20'+_0x443a0d['type']['toUpperCase']()+'\x20@\x20'+_0x443a0d[_0x542b18(0x25a)]()[_0x542b18(0x224)](0x2)+'\x20|\x20Total:\x20'+_0x2489e2['length']});}const _0x296cf6=this['_detectSweep'](_0x15cf51,_0x301634,_0xc55f8);_0x296cf6&&this['emit'](_0x542b18(0x248),{'type':_0x542b18(0x255),'message':_0x542b18(0x1d1)+_0x296cf6['sweepType']+'\x20|\x20Valid:\x20'+_0x296cf6['isValid']+'\x20|\x20Pen:\x20'+_0x296cf6['penetrationTicks'][_0x542b18(0x224)](0x1)+'t\x20|\x20Q:\x20'+(_0x296cf6['qualityScore']*0x64)[_0x542b18(0x224)](0x0)+'%'});if(_0x296cf6&&_0x296cf6[_0x542b18(0x1d0)])return this[_0x542b18(0x1ed)](_0x15cf51,_0x1d966b,_0xc55f8,_0x296cf6);return null;}[_0x42d110(0x215)](_0x220488,_0x2190dc,_0x494445){const _0x545e2d=_0x42d110,_0x3c4a58=this[_0x545e2d(0x22b)][_0x545e2d(0x23f)]['lookbackBars'],_0x2dee00=this['config']['swing'][_0x545e2d(0x246)];if(_0x494445<_0x3c4a58*0x2)return;const _0x33bc03=this[_0x545e2d(0x1ee)]['get'](_0x220488),_0x288bb3=_0x494445-_0x3c4a58,_0x497486=_0x2190dc[_0x288bb3];let _0x47365f=!![],_0x299727=0x0;for(let _0x40ee2b=_0x288bb3-_0x3c4a58;_0x40ee2b<=_0x288bb3+_0x3c4a58;_0x40ee2b++){if(_0x40ee2b===_0x288bb3||_0x40ee2b<0x0||_0x40ee2b>=_0x2190dc[_0x545e2d(0x1f5)])continue;if(_0x2190dc[_0x40ee2b]['high']>=_0x497486[_0x545e2d(0x249)]){_0x47365f=![];break;}_0x299727++;}if(_0x47365f&&_0x299727>=_0x2dee00){const _0x1273f5=_0x33bc03['find'](_0x3661e6=>_0x3661e6['barIndex']===_0x288bb3&&_0x3661e6[_0x545e2d(0x220)]==='high');!_0x1273f5&&_0x33bc03['push'](new SwingPoint(_0x545e2d(0x249),_0x497486[_0x545e2d(0x249)],_0x288bb3,_0x497486[_0x545e2d(0x1e3)],_0x299727));}let _0x11fa2a=!![],_0x14a1f4=0x0;for(let _0xcca4a1=_0x288bb3-_0x3c4a58;_0xcca4a1<=_0x288bb3+_0x3c4a58;_0xcca4a1++){if(_0xcca4a1===_0x288bb3||_0xcca4a1<0x0||_0xcca4a1>=_0x2190dc[_0x545e2d(0x1f5)])continue;if(_0x2190dc[_0xcca4a1][_0x545e2d(0x251)]<=_0x497486['low']){_0x11fa2a=![];break;}_0x14a1f4++;}if(_0x11fa2a&&_0x14a1f4>=_0x2dee00){const _0x27c2c9=_0x33bc03[_0x545e2d(0x242)](_0x3e02d6=>_0x3e02d6[_0x545e2d(0x1ef)]===_0x288bb3&&_0x3e02d6['type']===_0x545e2d(0x251));!_0x27c2c9&&_0x33bc03['push'](new SwingPoint(_0x545e2d(0x251),_0x497486['low'],_0x288bb3,_0x497486[_0x545e2d(0x1e3)],_0x14a1f4));}const _0x467605=this['config']['zone']['maxZoneAgeBars'];while(_0x33bc03[_0x545e2d(0x1f5)]>0x0&&_0x33bc03[0x0][_0x545e2d(0x1ef)]<_0x494445-_0x467605){_0x33bc03[_0x545e2d(0x20d)]();}}[_0x42d110(0x225)](_0x44e915,_0x55ec53){const _0x586886=_0x42d110,_0x55ec79=this['swingPoints'][_0x586886(0x231)](_0x44e915),_0x40579e=this[_0x586886(0x21b)][_0x586886(0x231)](_0x44e915),_0x541ccd=this[_0x586886(0x22b)][_0x586886(0x223)][_0x586886(0x206)]*this[_0x586886(0x20b)],_0x560fdc=this['config']['zone'][_0x586886(0x1ec)];for(let _0xfb8bee=_0x40579e[_0x586886(0x1f5)]-0x1;_0xfb8bee>=0x0;_0xfb8bee--){_0x55ec53-_0x40579e[_0xfb8bee][_0x586886(0x1ef)]>_0x560fdc&&_0x40579e[_0x586886(0x21c)](_0xfb8bee,0x1);}for(const _0x20b1f of _0x55ec79){let _0x36372f=null;for(const _0x326f80 of _0x40579e){if(_0x326f80[_0x586886(0x25e)](_0x20b1f[_0x586886(0x25c)],this['config'][_0x586886(0x223)][_0x586886(0x206)],this[_0x586886(0x20b)])){_0x36372f=_0x326f80;break;}}if(_0x36372f){_0x36372f[_0x586886(0x230)]++;if(_0x20b1f['price']>_0x36372f[_0x586886(0x25b)])_0x36372f['priceHigh']=_0x20b1f['price'];if(_0x20b1f[_0x586886(0x25c)]<_0x36372f[_0x586886(0x1df)])_0x36372f['priceLow']=_0x20b1f['price'];_0x36372f[_0x586886(0x1d4)]=Math[_0x586886(0x253)](0x1,0.3+_0x36372f[_0x586886(0x230)]*0.15);}else{const _0xcb778=_0x20b1f[_0x586886(0x220)]===_0x586886(0x249)?ZoneType['RESISTANCE']:ZoneType[_0x586886(0x200)],_0xe237f4=new LiquidityZone(_0xcb778,_0x20b1f['price']+_0x541ccd/0x2,_0x20b1f[_0x586886(0x25c)]-_0x541ccd/0x2,_0x20b1f['timestamp'],_0x20b1f['barIndex']);_0xe237f4['qualityScore']=0.3+_0x20b1f[_0x586886(0x1fc)]*0.1,_0x40579e[_0x586886(0x1d7)](_0xe237f4);}}}['_detectSweep'](_0xdef82e,_0x5df310,_0x3fb2b8){const _0x878147=_0x42d110,_0x379184=this[_0x878147(0x21b)][_0x878147(0x231)](_0xdef82e),_0x401f0a=_0x5df310[_0x3fb2b8],_0x4cabc4=_0x401f0a[_0x878147(0x22d)],_0x327f4f=this['config']['sweep'],_0x786dc5=this['config'][_0x878147(0x223)];for(const _0x26d3de of _0x379184){if(_0x26d3de['lastUsedBarIndex']>=0x0&&_0x3fb2b8-_0x26d3de[_0x878147(0x21e)]<_0x786dc5['cooldownBars'])continue;const _0x1517f2=_0x26d3de[_0x878147(0x25a)](),_0x2a18a9=Math[_0x878147(0x23c)](_0x4cabc4-_0x1517f2)/this['tickSize'];if(_0x2a18a9>_0x786dc5['maxZoneDistanceTicks'])continue;const _0x1dc212=Math[_0x878147(0x1f6)](0x0,_0x3fb2b8-_0x327f4f[_0x878147(0x229)]*0x2);for(let _0x42f2c6=_0x1dc212;_0x42f2c6<_0x3fb2b8;_0x42f2c6++){const _0x4991a0=_0x5df310[_0x42f2c6];if(_0x26d3de[_0x878147(0x220)]===ZoneType[_0x878147(0x201)]){const _0x31b9f4=(_0x4991a0['high']-_0x26d3de['priceHigh'])/this['tickSize'];if(_0x31b9f4>=_0x327f4f[_0x878147(0x202)]&&_0x31b9f4<=_0x327f4f['maxPenetrationTicks']){if(_0x4cabc4<_0x26d3de['priceHigh']){const _0x171fb6=_0x4991a0['high']-_0x4991a0[_0x878147(0x251)],_0x1e542f=Math['abs'](_0x4991a0['close']-_0x4991a0['open']),_0x4d71e2=_0x171fb6>0x0?_0x1e542f/_0x171fb6:0x0;if(_0x4d71e2>=_0x327f4f[_0x878147(0x23e)]){const _0x2776a3=this['_getVolumeRatio'](_0x5df310,_0x42f2c6,0x14);if(_0x2776a3>=_0x327f4f['minVolumeRatio']){const _0x27dec0=new SweepEvent(SweepType['HIGH_SWEEP'],_0x26d3de,_0x42f2c6,_0x42f2c6,_0x4991a0['high']);_0x27dec0[_0x878147(0x1e5)]=_0x3fb2b8,_0x27dec0[_0x878147(0x213)]=_0x31b9f4,_0x27dec0['durationBars']=_0x3fb2b8-_0x42f2c6,_0x27dec0[_0x878147(0x24a)]=_0x2776a3,_0x27dec0['qualityScore']=this[_0x878147(0x226)](_0x27dec0,_0x4d71e2),_0x27dec0['isValid']=_0x27dec0['qualityScore']>=_0x327f4f['minQualityScore'];if(_0x27dec0[_0x878147(0x1d0)])return _0x27dec0;}}}}}if(_0x26d3de[_0x878147(0x220)]===ZoneType['SUPPORT']){const _0x15d249=(_0x26d3de[_0x878147(0x1df)]-_0x4991a0[_0x878147(0x251)])/this[_0x878147(0x20b)];if(_0x15d249>=_0x327f4f[_0x878147(0x202)]&&_0x15d249<=_0x327f4f[_0x878147(0x243)]){if(_0x4cabc4>_0x26d3de['priceLow']){const _0x5751ac=_0x4991a0['high']-_0x4991a0[_0x878147(0x251)],_0x9629d5=Math[_0x878147(0x23c)](_0x4991a0[_0x878147(0x22d)]-_0x4991a0['open']),_0x7765f3=_0x5751ac>0x0?_0x9629d5/_0x5751ac:0x0;if(_0x7765f3>=_0x327f4f['minBodyRatio']){const _0x31cc55=this[_0x878147(0x1da)](_0x5df310,_0x42f2c6,0x14);if(_0x31cc55>=_0x327f4f[_0x878147(0x217)]){const _0x2ad2e9=new SweepEvent(SweepType['LOW_SWEEP'],_0x26d3de,_0x42f2c6,_0x42f2c6,_0x4991a0['low']);_0x2ad2e9['exitBarIndex']=_0x3fb2b8,_0x2ad2e9[_0x878147(0x213)]=_0x15d249,_0x2ad2e9['durationBars']=_0x3fb2b8-_0x42f2c6,_0x2ad2e9['volumeRatio']=_0x31cc55,_0x2ad2e9['qualityScore']=this['_scoreSweep'](_0x2ad2e9,_0x7765f3),_0x2ad2e9['isValid']=_0x2ad2e9[_0x878147(0x1d4)]>=_0x327f4f[_0x878147(0x1f8)];if(_0x2ad2e9['isValid'])return _0x2ad2e9;}}}}}}}return null;}['_getVolumeRatio'](_0x91a6b5,_0x46d424,_0x2f5224){const _0x11031c=_0x42d110,_0x572087=Math['max'](0x0,_0x46d424-_0x2f5224),_0x2143ed=_0x91a6b5[_0x11031c(0x235)](_0x572087,_0x46d424);if(_0x2143ed['length']===0x0)return 0x1;const _0x4e95f0=_0x2143ed['map'](_0x17fc14=>_0x17fc14[_0x11031c(0x1e8)])['sort']((_0x18fb41,_0xbf54aa)=>_0x18fb41-_0xbf54aa),_0x40d2ac=Math[_0x11031c(0x1ea)](_0x4e95f0[_0x11031c(0x1f5)]/0x2),_0x221eda=_0x4e95f0[_0x40d2ac]||0x1;return _0x91a6b5[_0x46d424][_0x11031c(0x1e8)]/_0x221eda;}[_0x42d110(0x226)](_0x4aa676,_0x15183e){const _0x162738=_0x42d110;let _0x39dd8e=0x0;const _0x5cf36b=0x4,_0x3e4c42=Math['abs'](_0x4aa676['penetrationTicks']-_0x5cf36b);return _0x39dd8e+=Math['max'](0x0,0.3-_0x3e4c42*0.03),_0x39dd8e+=Math[_0x162738(0x1f6)](0x0,0.25-_0x4aa676[_0x162738(0x207)]*0.05),_0x39dd8e+=Math[_0x162738(0x253)](0.25,_0x4aa676[_0x162738(0x24a)]*0.1),_0x39dd8e+=Math[_0x162738(0x253)](0.2,_0x15183e*0.4),Math['min'](0x1,_0x39dd8e);}[_0x42d110(0x1ed)](_0x692715,_0x303d70,_0x36438c,_0x29df68){const _0x31813c=_0x42d110;if(Date['now']()-this['lastSignalTime']<this[_0x31813c(0x22b)][_0x31813c(0x1fd)][_0x31813c(0x219)])return null;const _0x506a13=this['config']['execution'],_0x48b6fd=_0x303d70['close'],_0x25e46c=_0x29df68['sweepType']===SweepType[_0x31813c(0x234)]?_0x31813c(0x20c):'long';let _0x5d0b27,_0x60f692,_0x3d77bb,_0xdc7dae;_0x25e46c==='long'?(_0x5d0b27=_0x48b6fd-_0x506a13[_0x31813c(0x1e2)]*this['tickSize'],_0x60f692=_0x48b6fd+_0x506a13['targetTicks']*this[_0x31813c(0x20b)],_0x3d77bb=_0x48b6fd+_0x506a13[_0x31813c(0x22e)]*this[_0x31813c(0x20b)],_0xdc7dae=_0x48b6fd+_0x506a13[_0x31813c(0x1eb)]*this[_0x31813c(0x20b)]):(_0x5d0b27=_0x48b6fd+_0x506a13['stopTicks']*this[_0x31813c(0x20b)],_0x60f692=_0x48b6fd-_0x506a13['targetTicks']*this['tickSize'],_0x3d77bb=_0x48b6fd-_0x506a13[_0x31813c(0x22e)]*this[_0x31813c(0x20b)],_0xdc7dae=_0x48b6fd-_0x506a13['trailTriggerTicks']*this['tickSize']);const _0xe6984c=_0x506a13[_0x31813c(0x20a)]/_0x506a13['stopTicks'],_0x445cca=Math['min'](0x1,_0x29df68[_0x31813c(0x1d4)]*0.5+_0x29df68[_0x31813c(0x223)]['qualityScore']*0.3+(_0x29df68['volumeRatio']>1.5?0.2:_0x29df68['volumeRatio']*0.1));let _0x4899fd=SignalStrength[_0x31813c(0x209)];if(_0x445cca>=0.8)_0x4899fd=SignalStrength['VERY_STRONG'];else{if(_0x445cca>=0.65)_0x4899fd=SignalStrength['STRONG'];else{if(_0x445cca<0.5)_0x4899fd=SignalStrength['WEAK'];}}const _0x4530e4=0.5+(_0x445cca-0.5)*0.4,_0x22d984=_0x4530e4*Math[_0x31813c(0x23c)](_0x60f692-_0x48b6fd)-(0x1-_0x4530e4)*Math[_0x31813c(0x23c)](_0x48b6fd-_0x5d0b27);_0x29df68[_0x31813c(0x223)]['lastUsedBarIndex']=_0x36438c,_0x29df68[_0x31813c(0x223)][_0x31813c(0x23d)]=!![],_0x29df68['zone'][_0x31813c(0x1d3)]=new Date(_0x303d70['timestamp']),this['lastSignalTime']=Date['now'](),this[_0x31813c(0x1f2)][_0x31813c(0x260)]++;const _0x35878b={'id':uuidv4(),'timestamp':Date['now'](),'symbol':_0x692715['split']('.')[0x0]||_0x692715,'contractId':_0x692715,'side':_0x25e46c==='long'?OrderSide[_0x31813c(0x1d5)]:OrderSide[_0x31813c(0x1fe)],'direction':_0x25e46c,'strategy':'HQX_2B_LIQUIDITY_SWEEP','strength':_0x4899fd,'edge':_0x22d984,'confidence':_0x445cca,'entry':_0x48b6fd,'entryPrice':_0x48b6fd,'stopLoss':_0x5d0b27,'takeProfit':_0x60f692,'riskReward':_0xe6984c,'stopTicks':_0x506a13['stopTicks'],'targetTicks':_0x506a13[_0x31813c(0x20a)],'breakevenTicks':_0x506a13['breakevenTicks'],'trailTriggerTicks':_0x506a13['trailTriggerTicks'],'trailDistanceTicks':_0x506a13[_0x31813c(0x236)],'beLevel':_0x3d77bb,'trailTrigger':_0xdc7dae,'sweepType':_0x29df68[_0x31813c(0x1ff)],'penetrationTicks':_0x29df68['penetrationTicks'],'sweepDurationBars':_0x29df68['durationBars'],'sweepQuality':_0x29df68['qualityScore'],'volumeRatio':_0x29df68[_0x31813c(0x24a)],'zoneType':_0x29df68[_0x31813c(0x223)][_0x31813c(0x220)],'zoneLevel':_0x29df68['zone'][_0x31813c(0x25a)](),'zoneTouches':_0x29df68[_0x31813c(0x223)]['touches'],'zoneQuality':_0x29df68[_0x31813c(0x223)][_0x31813c(0x1d4)],'expires':Date['now']()+0xea60};return this[_0x31813c(0x254)]('signal',{'side':_0x25e46c==='long'?_0x31813c(0x1f7):_0x31813c(0x238),'action':'open','reason':'2B\x20'+_0x29df68[_0x31813c(0x1ff)]+'\x20|\x20Pen:'+_0x29df68[_0x31813c(0x213)]['toFixed'](0x1)+'t\x20|\x20Vol:'+_0x29df68['volumeRatio']['toFixed'](0x1)+_0x31813c(0x239)+(_0x29df68[_0x31813c(0x1d4)]*0x64)[_0x31813c(0x224)](0x0)+'%',..._0x35878b}),this[_0x31813c(0x254)]('log',{'type':'info','message':_0x31813c(0x1d9)+_0x25e46c['toUpperCase']()+_0x31813c(0x25f)+_0x48b6fd['toFixed'](0x2)+'\x20|\x20'+_0x29df68[_0x31813c(0x1ff)]+'\x20|\x20Pen:'+_0x29df68['penetrationTicks'][_0x31813c(0x224)](0x1)+_0x31813c(0x24f)+_0x29df68[_0x31813c(0x24a)]['toFixed'](0x1)+'x\x20|\x20Conf:'+(_0x445cca*0x64)['toFixed'](0x0)+'%'}),_0x35878b;}[_0x42d110(0x1de)](_0x327145,_0x4731da){const _0x5831ae=_0x42d110,_0xb10131=this[_0x5831ae(0x214)][_0x5831ae(0x231)](_0x327145)||[],_0x30bde5=this[_0x5831ae(0x21b)]['get'](_0x327145)||[],_0x5eaca4=this[_0x5831ae(0x1ee)]['get'](_0x327145)||[];if(_0xb10131['length']<0x5)return{'ready':![],'message':'Collecting\x20data...\x20'+_0xb10131['length']+'/5\x20bars'};const _0x31e8da=_0x30bde5['map'](_0x24c4e9=>({'zone':_0x24c4e9,'distance':Math[_0x5831ae(0x23c)](_0x4731da-_0x24c4e9['getLevel']())}))['sort']((_0x1bf6df,_0x31b271)=>_0x1bf6df[_0x5831ae(0x21d)]-_0x31b271['distance']),_0x24e42b=_0x31e8da['find'](_0xfe43f1=>_0xfe43f1['zone'][_0x5831ae(0x220)]===ZoneType[_0x5831ae(0x201)]),_0x504b1c=_0x31e8da[_0x5831ae(0x242)](_0x283616=>_0x283616['zone']['type']===ZoneType[_0x5831ae(0x200)]);return{'ready':!![],'barsProcessed':_0xb10131[_0x5831ae(0x1f5)],'swingsDetected':_0x5eaca4['length'],'activeZones':_0x30bde5['length'],'nearestResistance':_0x24e42b?_0x24e42b[_0x5831ae(0x223)][_0x5831ae(0x25a)]():null,'nearestSupport':_0x504b1c?_0x504b1c['zone']['getLevel']():null,'stopTicks':this['config'][_0x5831ae(0x1fd)][_0x5831ae(0x1e2)],'targetTicks':this['config'][_0x5831ae(0x1fd)]['targetTicks'],'strategy':_0x5831ae(0x1d8)};}[_0x42d110(0x25d)](_0x8c320d){const _0x17b14f=_0x42d110;this['recentTrades']['push']({'netPnl':_0x8c320d,'timestamp':Date['now']()});if(this['recentTrades']['length']>0x64)this['recentTrades'][_0x17b14f(0x20d)]();_0x8c320d>0x0?this['stats']['wins']++:this[_0x17b14f(0x1f2)]['losses']++,this[_0x17b14f(0x1f2)][_0x17b14f(0x203)]++,this['stats']['pnl']+=_0x8c320d,this['emit']('log',{'type':_0x17b14f(0x255),'message':'[HQX-2B]\x20Trade\x20result:\x20'+(_0x8c320d>0x0?'WIN':'LOSS')+'\x20$'+_0x8c320d[_0x17b14f(0x224)](0x2)});}[_0x42d110(0x24b)](_0x3a3594){const _0x346f77=_0x42d110;return this[_0x346f77(0x214)][_0x346f77(0x231)](_0x3a3594)||[];}[_0x42d110(0x22f)](){return this['stats'];}['getHealthStatus'](_0x40a972){const _0x459b60=_0x42d110,_0x296fae=this[_0x459b60(0x214)][_0x459b60(0x231)](_0x40a972)||[],_0x4c3e16=this[_0x459b60(0x21b)]['get'](_0x40a972)||[],_0x1e1e6=this[_0x459b60(0x1ee)]['get'](_0x40a972)||[],_0x49cd28=this[_0x459b60(0x228)]['get'](_0x40a972),_0x5a4cd6=_0x296fae[_0x296fae['length']-0x1],_0x430a85=_0x5a4cd6?Date[_0x459b60(0x21f)]()-_0x5a4cd6[_0x459b60(0x1e3)]:null,_0x53ecf6=_0x4c3e16['filter'](_0x3bad53=>_0x3bad53['type']===ZoneType[_0x459b60(0x201)])['length'],_0x3da4f9=_0x4c3e16[_0x459b60(0x1f9)](_0x249fa7=>_0x249fa7['type']===ZoneType['SUPPORT'])['length'];return{'healthy':_0x296fae['length']>=0x5,'barsTotal':_0x296fae['length'],'barsLast5Min':_0x296fae[_0x459b60(0x1f9)](_0x3bf46c=>Date[_0x459b60(0x21f)]()-_0x3bf46c['timestamp']<0x5*0x3c*0x3e8)['length'],'swingsTotal':_0x1e1e6['length'],'zonesResistance':_0x53ecf6,'zonesSupport':_0x3da4f9,'zonesTotal':_0x4c3e16['length'],'currentBarTicks':_0x49cd28?_0x49cd28['tickCount']:0x0,'isAggregating':_0x49cd28&&_0x49cd28['tickCount']>0x0,'timeSinceLastBarMs':_0x430a85,'lastSignalTime':this['lastSignalTime'],'signalCooldownMs':this[_0x459b60(0x22b)]['execution']['cooldownMs'],'uptime':Date['now']()-(this['startTime']||Date['now']())};}['reset'](_0x1268a2){const _0x747c54=_0x42d110;this[_0x747c54(0x214)]['set'](_0x1268a2,[]),this[_0x747c54(0x1ee)]['set'](_0x1268a2,[]),this['liquidityZones']['set'](_0x1268a2,[]),this['activeSweeps'][_0x747c54(0x211)](_0x1268a2,[]),this['currentBar'][_0x747c54(0x244)](_0x1268a2),this[_0x747c54(0x254)](_0x747c54(0x248),{'type':'info','message':_0x747c54(0x216)+_0x1268a2});}[_0x42d110(0x205)](_0x124293,_0x4300bd){const _0x3dbf5f=_0x42d110;if(!_0x4300bd||_0x4300bd['length']===0x0){this[_0x3dbf5f(0x254)](_0x3dbf5f(0x248),{'type':'debug','message':'[HQX-2B]\x20No\x20historical\x20bars\x20to\x20preload'});return;}!this['barHistory'][_0x3dbf5f(0x1f1)](_0x124293)&&this[_0x3dbf5f(0x259)](_0x124293);const _0x34afda=[..._0x4300bd][_0x3dbf5f(0x24c)]((_0xda6fb7,_0x111e8c)=>_0xda6fb7[_0x3dbf5f(0x1e3)]-_0x111e8c['timestamp']);this[_0x3dbf5f(0x254)]('log',{'type':'info','message':'[HQX-2B]\x20Preloading\x20'+_0x34afda[_0x3dbf5f(0x1f5)]+_0x3dbf5f(0x210)});let _0x3cc4b9=0x0;for(const _0x2a24d0 of _0x34afda){const _0x4e066d=this[_0x3dbf5f(0x1d2)](_0x124293,_0x2a24d0);if(_0x4e066d)_0x3cc4b9++;}const _0x126fb5=this[_0x3dbf5f(0x214)][_0x3dbf5f(0x231)](_0x124293)||[],_0x3d9a13=this[_0x3dbf5f(0x1ee)][_0x3dbf5f(0x231)](_0x124293)||[],_0x167bc6=this[_0x3dbf5f(0x21b)][_0x3dbf5f(0x231)](_0x124293)||[];this[_0x3dbf5f(0x254)](_0x3dbf5f(0x248),{'type':'info','message':'[HQX-2B]\x20Preload\x20complete:\x20'+_0x126fb5[_0x3dbf5f(0x1f5)]+'\x20bars,\x20'+_0x3d9a13[_0x3dbf5f(0x1f5)]+_0x3dbf5f(0x1d6)+_0x167bc6['length']+_0x3dbf5f(0x24d)}),_0x3cc4b9>0x0&&this[_0x3dbf5f(0x254)](_0x3dbf5f(0x248),{'type':_0x3dbf5f(0x255),'message':_0x3dbf5f(0x1f3)+_0x3cc4b9+'\x20historical\x20signals\x20detected\x20(ignored)'}),this[_0x3dbf5f(0x1e7)]=0x0;}}class HQX2BStrategy extends EventEmitter{constructor(_0x346b57={}){const _0x2051b0=_0x42d110;super(),this[_0x2051b0(0x22b)]=_0x346b57,this[_0x2051b0(0x232)]=new HQX2BLiquiditySweep(_0x346b57),this['strategy']['on']('signal',_0x300e6e=>this['emit']('signal',_0x300e6e)),this[_0x2051b0(0x232)]['on'](_0x2051b0(0x248),_0x9cdab9=>this['emit'](_0x2051b0(0x248),_0x9cdab9));}[_0x42d110(0x250)](_0x20c752){return this['strategy']['processTick'](_0x20c752);}[_0x42d110(0x1e4)](_0x116fc5){return this['strategy']['onTick'](_0x116fc5);}['onTrade'](_0x47dbf6){const _0x2888f7=_0x42d110;return this[_0x2888f7(0x232)][_0x2888f7(0x1e1)](_0x47dbf6);}['processBar'](_0x317eab,_0x604ec7){return this['strategy']['processBar'](_0x317eab,_0x604ec7);}[_0x42d110(0x259)](_0xe0a442,_0x4a38c5,_0x3abb15){return this['strategy']['initialize'](_0xe0a442,_0x4a38c5,_0x3abb15);}['getAnalysisState'](_0x2d9353,_0x286950){const _0x731018=_0x42d110;return this[_0x731018(0x232)][_0x731018(0x1de)](_0x2d9353,_0x286950);}[_0x42d110(0x25d)](_0x4c04be){const _0xe52c3f=_0x42d110;return this['strategy'][_0xe52c3f(0x25d)](_0x4c04be);}['reset'](_0x36ef08){const _0x187f7e=_0x42d110;return this[_0x187f7e(0x232)][_0x187f7e(0x222)](_0x36ef08);}[_0x42d110(0x22f)](){const _0x41e25a=_0x42d110;return this['strategy'][_0x41e25a(0x22f)]();}[_0x42d110(0x24b)](_0x584ae){const _0x5b4b4f=_0x42d110;return this[_0x5b4b4f(0x232)]['getBarHistory'](_0x584ae);}[_0x42d110(0x205)](_0x1f88a7,_0x19d1b2){const _0x2956a8=_0x42d110;return this['strategy'][_0x2956a8(0x205)](_0x1f88a7,_0x19d1b2);}[_0x42d110(0x22a)](_0x4f5c6a){const _0xd52c29=_0x42d110;return this['strategy'][_0xd52c29(0x22a)](_0x4f5c6a);}[_0x42d110(0x240)](_0x2d9552){return null;}}function _0x1d4b(){const _0x2c55d4=['[HQX-2B]\x20','America/New_York','length','max','buy','minQualityScore','filter',',\x20value=','2737ZFlBTB','strength','execution','ASK','sweepType','SUPPORT','RESISTANCE','minPenetrationTicks','trades','startTime','preloadBars','clusterToleranceTicks','durationBars','extremeBarIndex','MODERATE','targetTicks','tickSize','short','shift','session',':\x20tick=','\x20historical\x20bars...','set','tickValue','penetrationTicks','barHistory','_detectSwings','[HQX-2B]\x20Reset\x20state\x20for\x20','minVolumeRatio','object','cooldownMs','1777194TEhowt','liquidityZones','splice','distance','lastUsedBarIndex','now','type','19736JJjqGN','reset','zone','toFixed','_updateZones','_scoreSweep','19095890MzkmJM','currentBar','maxDurationBars','getHealthStatus','config','1245382WiHmjj','close','breakevenTicks','getStats','touches','get','strategy','resistance','HIGH_SWEEP','slice','trailDistanceTicks','activeSweeps','sell','x\x20|\x20Q:','1jDFrqs','events','abs','swept','minBodyRatio','swing','generateSignal','isArray','find','maxPenetrationTicks','delete','10021392hImrbv','minStrength','barIntervalMs','log','high','volumeRatio','getBarHistory','sort','\x20zones','uuid','t\x20Vol:','processTick','low','55vTPwkt','min','emit','debug','253384ZrnUDP','3415896CKXZdB','getTimezoneOffset','initialize','getLevel','priceHigh','price','recordTradeResult','containsPrice','\x20@\x20','signals','\x20|\x20Total:\x20','getFullYear','isValid','[2B]\x20SWEEP\x20','processBar','sweptAt','qualityScore','BID','\x20swings,\x20','push','HQX-2B\x20Liquidity\x20Sweep\x20(Optimized)','[HQX-2B]\x20SIGNAL:\x20','_getVolumeRatio','enabled','t,\x20Trail=','info','getAnalysisState','priceLow','lookbackBars','onTrade','stopTicks','timestamp','onTick','exitBarIndex',',\x20TF=1min','lastSignalTime','volume','_mergeConfig','floor','trailTriggerTicks','maxZoneAgeBars','_generateSignal','swingPoints','barIndex','support','has','stats'];_0x1d4b=function(){return _0x2c55d4;};return _0x1d4b();}module['exports']={'HQX2BLiquiditySweep':HQX2BLiquiditySweep,'HQX2BStrategy':HQX2BStrategy,'M2':HQX2BStrategy,'S2':HQX2BLiquiditySweep,'OrderSide':OrderSide,'SignalStrength':SignalStrength,'SweepType':SweepType,'ZoneType':ZoneType,'DEFAULT_CONFIG':DEFAULT_CONFIG};